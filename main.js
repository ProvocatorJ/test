!function(e,t,a,r,n,i,o,l,s,u,d,c,m,g,p,h,f,v,y,b,k,w,_,C,x,T,I,S,A){let O,q,E,P,B,R,D,F,N,M,L,G,U,H,K,Q,X,J,W,V,Y,j,z,Z,ee,te,ae;var re,ne=()=>gts_controlBuilder.createLabel(null,"gts-icon icon_gold"),ie=null,oe=null,le=(e,t)=>"true"==R(e,t||!1),se=(e,t)=>D(e,JSON.stringify(t)),ue=(e,t)=>D(e,(new Date).getTime()+1e3*t),de=(e,t,a)=>{y(e).toggleClass(t,a)},ce=e=>n[a(p(o(e)))],me=[],ge=[],pe=1;let he,fe,ve,ye,be,ke,we,_e,Ce,xe,Te,Ie,Se,Ae,Oe,qe,Ee,Pe,Be,Re,De,Fe,Ne,Me,Le,Ge,Ue,He,Ke;var Qe={buildExpeditionContent:function(e){var t=this;this.removeChildren(e);let a=gts_controlBuilder.createLink("Check this video".gts_translate().gts_translate(),"https://www.youtube.com/watch?v=lMt06dY5j18","video-link margin-l-5");var r="Configuration for automating Expedition".gts_translate();e.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode(r),a]));let n=gts_controlBuilder.createDropdown(J.countryLocation,fe,me,"name","id",e=>{O.storage.clearOption(J.opponent),Qe.initSettings(),o(e)});e.appendChild(this.createRow("Location".gts_translate(),[n]));var i=this.createElement("select");e.appendChild(this.createRow("Opponent".gts_translate(),[i])),y(i).on("change",function(){var e=t.getSelectedValue(this);null!=e&&D(J.opponent,e)});var o=function(e){t.removeChildren(i);for(var a=me.filter(t=>t.id==e).pop(),r=R(J.opponent,1),n=0;n<a.opponents.length;n++){var o=a.opponents[n],l=t.createElement("option",null,null,n+1+". "+o+(3==n?` [${langData[U].bossText}]`:""));l.value=n+1,l.selected=t.isEqual(n+1,r),i.appendChild(l)}};o(ve);var l=gts_controlBuilder.createToggle(J.attackEarly2Level);e.appendChild(this.createRow("Allow expedition early 2 levels".gts_translate(),[l]));var s=gts_controlBuilder.createToggle(J.autoCollectAllBonuses);e.appendChild(this.createRow("Auto collect all bonuses".gts_translate(),[s]));let u=t=>{let a=t==relativeCountryValues.dungeon;y(m).toggle(a),y(g).toggle(a),y(e).toggleClass("auto-travelling-on",!!t)},d=R(J.travelCountryWhenZeroPoints),c=gts_controlBuilder.createDropdown(J.travelCountryWhenZeroPoints,"",countries.filter(e=>e.value!=relativeCountryValues.expedition),"name","value",e=>{u(e),e||(D(J.travelAtRestoredPointsForNonUwWearing,pointPercents[0].value),D(J.travelAtRestoredPointsForUwWearing,pointPercents[0].value),D(J.atExpCountryWhenUWCD,-1),y(h).val(-1),y(k).val(-1),y(x).val(-1))}),m=gts_controlBuilder.createLabel("Requires Dungeon points is restored".gts_translate(),"margin-r-5"),g=gts_controlBuilder.createDropdown(J.minDungeonPointsToTravel,50,pointPercents.filter(e=>e.value>0),"name","value");e.appendChild(this.createRow("When the expedition point is 0 then travel to".gts_translate(),[c,m,g])),u(d);let p=y('<div class="margin-t-5 margin-r-5 margin-b-5">'),h=gts_controlBuilder.createDropdown(J.travelAtRestoredPointsForNonUwWearing,30,pointPercents,"name","value"),f=gts_controlBuilder.createLabel("when wearing normal costume".gts_translate());p.append(h).append(f);let v=y('<div class="margin-t-5 margin-r-5 margin-b-5">'),k=gts_controlBuilder.createDropdown(J.travelAtRestoredPointsForUwWearing,20,pointPercents,"name","value"),w=gts_controlBuilder.createLabel("when wearing underworld costume".gts_translate());v.append(k).append(w),e.appendChild(this.createRow("Travel to Expedition country when the point is restored x%".gts_translate(),[p[0],v[0]],null,null,"auto-travelling hide"));let _=gts_controlBuilder.createToggle(J.useClotheToTravel,"Use Working Clothe to reduce time when travel to Expedition country".gts_translate());e.appendChild(this.createRow("Reduce travel time".gts_translate(),[..._],null,null,"auto-travelling hide"));let C=[...Array(8).keys()].map(e=>e+1).map(e=>({name:1==e?"1 hour".gts_translate():"{numberOfHours} hours".gts_translate({numberOfHours:e}),value:e}));C.splice(0,0,{name:`---${"No actions".gts_translate()}---`,value:-1});let x=gts_controlBuilder.createDropdown(J.atExpCountryWhenUWCD,-1,C,"name","value");e.appendChild(this.createRow("Stay at Expedition country if underworld costume cooldown less than".gts_translate(),[x],null,null,"auto-travelling hide"))},wait:function(){setTimeout(()=>{if(ce("slootekaf_stg")&&ce("repleHiUemag_stg")&&ce("ofnIlrU_stg")){O=ce("slootekaf_stg"),E=ce("repleHiUemag_stg"),B=ce("ofnIlrU_stg"),G=ce("rotaulavEelur_stg"),P=ce("ipAemag_stg"),U=n.gts_gameLang,translate_method=ce("dohtem"),randomId=ce("dImodnar");var e=O.storage;R=e.getOption.bind(e),D=e.setOption.bind(e),F=e.getJsonOption.bind(e),N=e.getArrayOption.bind(e),L=e.getArrayNumberOption.bind(e),M=e.getNumberOption.bind(e),q=O.utility,K=settingKeys.premium,Q=settingKeys.circusTuma,X=settingKeys.arena,J=settingKeys.expedition,W=settingKeys.dungeon,V=settingKeys.underworld,Y=settingKeys.health,j=settingKeys.event,z=settingKeys.general,Z=settingKeys.auction,ee=settingKeys.smeltery,te=settingKeys.quest,ae=settingKeys.general.key,Qe.start()}else Qe.wait()},100)},startStop:function(e){if(e!=q.isRunning())return n.isRunning=e,q.startAutoCurrentTab(n.isRunning),D(z.paused,!n.isRunning),!0},validServerFilter:function(e){return e.filter(function(e){return v(e)>0})},buildPremiumContent:async function(e){var t=this;this.removeChildren(e);let a=gts_controlBuilder.createLink("Check this video".gts_translate(),"https://www.youtube.com/watch?v=lMt06dY5j18","video-link margin-l-5");e.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode("All features are listed in this section is Premium Feature.".gts_translate()),a]));var r=this.createInput(null,"checkbox"),n=le(settingKeys.auction.packGoldEnabled,!0);r.checked=n,y(r).on("change",function(){D(settingKeys.auction.packGoldEnabled,this.checked),D(settingKeys.auction.enabledPackGoldTime,-1),o=0});var i=[r],o=M(settingKeys.auction.enabledPackGoldTime,"0"),l=(new Date).getTime();if(o>l){var s=this.createElement("label",null,null,"");i.push(s);let e=Math.round((o-l)/1e3);var u=setInterval(()=>{if(--e<=0||o<=0)return clearInterval(u),void y(s).text("");let t="Note: Currently auto hide gold is turned off temporary and will be turned on automatically after {numberOfSeconds} seconds. You can stop the progress by manually turn on/off the checkbox.".gts_translate({numberOfSeconds:e});y(s).text(t)},1e3)}e.appendChild(this.createRow("Auto hide gold".gts_translate(),i));var d=t=>{var a=[packGoldLocation.auctionHouse,packGoldLocation.guildMarket,packGoldLocation.guildBank,packGoldLocation.training,packGoldLocation.publicMarket,packGoldLocation.shop];for(var r of a)y(e).toggleClass(r+"-selected",!1);y(e).toggleClass(t+"-selected",!0)},c=this.createElement("ul",null,"food"),m=R(settingKeys.auction.packGoldLocation,packGoldLocation.auctionHouse);d(m);var g=b.createElement("li"),p=b.createElement("input");g.appendChild(p),p.type="radio",p.checked=m==packGoldLocation.auctionHouse,p.name="locationToPackGold",p.id="rdoAutionHouse",y(p).on("click",function(){d(packGoldLocation.auctionHouse),this.checked&&D(settingKeys.auction.packGoldLocation,packGoldLocation.auctionHouse)});var h=b.createElement("label");h.htmlFor=p.id,h.textContent="Auction house".gts_translate(),g.appendChild(h),c.appendChild(g);var f=b.createElement("li"),k=b.createElement("input");f.appendChild(k),k.type="radio",k.checked=m==packGoldLocation.guildMarket,k.name="locationToPackGold",k.id="rdoGuildMarket",y(k).on("click",function(){d(packGoldLocation.guildMarket),this.checked&&D(settingKeys.auction.packGoldLocation,packGoldLocation.guildMarket)});var w=b.createElement("label");w.htmlFor=k.id,w.textContent="Guild market".gts_translate(),f.appendChild(w),c.appendChild(f);var _=b.createElement("li"),C=b.createElement("input");_.appendChild(C),C.type="radio",C.checked=m==packGoldLocation.guildBank,C.name="locationToPackGold",C.id="rdoGuildBank",y(C).on("click",function(){d(packGoldLocation.guildBank),this.checked&&D(settingKeys.auction.packGoldLocation,packGoldLocation.guildBank)});var x=b.createElement("label");x.htmlFor=C.id,x.textContent="Guild bank".gts_translate(),_.appendChild(x),c.appendChild(_);var T=b.createElement("li"),I=b.createElement("input");T.appendChild(I),I.type="radio",I.checked=m==packGoldLocation.training,I.name="locationToPackGold",I.id="rdoTraining",y(I).on("click",function(){d(packGoldLocation.training),this.checked&&D(settingKeys.auction.packGoldLocation,packGoldLocation.training)});var S=b.createElement("label");S.htmlFor=I.id,S.textContent="Training".gts_translate(),T.appendChild(S),c.appendChild(T);var A=b.createElement("li"),E=b.createElement("input");A.appendChild(E),E.type="radio",E.checked=m==packGoldLocation.publicMarket,E.name="locationToPackGold",E.id="rdoPublicMarket",y(E).on("click",function(){d(packGoldLocation.publicMarket),this.checked&&D(settingKeys.auction.packGoldLocation,packGoldLocation.publicMarket)});var B=b.createElement("label");B.htmlFor=E.id,B.textContent="Public market".gts_translate(),A.appendChild(B),c.appendChild(A);var N=b.createElement("li"),L=b.createElement("input");N.appendChild(L),L.type="radio",L.checked=m==packGoldLocation.shop,L.name="locationToPackGold",L.id="rdoShop",y(L).on("click",function(){d(packGoldLocation.shop),this.checked&&D(settingKeys.auction.packGoldLocation,packGoldLocation.shop)});var G=b.createElement("label");G.htmlFor=L.id,G.textContent="Shop".gts_translate(),N.appendChild(G),c.appendChild(N),e.appendChild(this.createRow("Hide gold in".gts_translate(),[c]));var U=this.createInput(null,"textbox");U.className="input-gold",U.value=R(settingKeys.auction.packGoldAmount,"30000"),y(U).on("change",function(){D(settingKeys.auction.packGoldAmount,this.value)}),e.appendChild(this.createRow("Hide gold once over".gts_translate(),[U,ne()],null,null,"packing-gold-threshold"));var H=this.createElement("select"),Q=R(K.statToTrain,0);for(var X of characterStats){(Ze=t.createElement("option",null,null,X.name)).value=X.value,Ze.selected=t.isEqual(X.value,Q),H.appendChild(Ze)}y(H).on("change",function(){var e=t.getSelectedValue(this);null!=e&&(D(K.minGoldToTrain,0),D(K.statToTrain,e))}),e.appendChild(this.createRow("Training attribute".gts_translate(),[H],null,null,"hide training-config"));var J=gts_controlBuilder.createNumberInput(K.keepAmountOfGoldOnHand,1e4);e.appendChild(this.createRow("Keep amount of gold on hand".gts_translate(),[J,ne()],null,null,"hide guild-bank-config"));var W,V=this.createInput(null,"textbox");V.placeholder="Copy & Paste seller profile's url here and press Enter".gts_translate();var Y=(e,t)=>{var a=this.createElement("li",e.sellerId,"seller-item",e.sellerName),r=this.createElement("i",null,"remove");r.onclick=(()=>{D(K.publicMarketSellers,"[]"),W.remove()}),a.appendChild(r),W.appendChild(a)},j=()=>{var e=V.value;if(e){var t=F(K.publicMarketSellers);y.get(e,e=>{W=this.createElement("ul",null,"public-market-sellers"),y(V).parent().prepend(W);var a=preventJQueryLoadResource(e).find(".player_name_bg > div")[0].innerText.trim(),r={sellerId:V.value.match(/\&p=(\d+)/)[1],sellerName:a};t.push(r),D(K.publicMarketSellers,JSON.stringify(t)),Y(r),V.value=""})}};let $=y(V);$.on("blur",j),$.on("keypress",e=>{V.value;13==e.keyCode&&j()});var te=F(K.publicMarketSellers);te.length&&(W=this.createElement("ul",null,"public-market-sellers"),te.forEach(Y)),e.appendChild(this.createRow("Only buy from player".gts_translate(),[W,V],null,null,"hide public-market-config"));var ae=gts_controlBuilder.createLabel("min "),re=gts_controlBuilder.createInput(K.minGoldPackCanBuy,"textbox","30000","input-gold"),ie=gts_controlBuilder.createLabel("max "),oe=gts_controlBuilder.createHtmlLabel(" , "),de=gts_controlBuilder.createInput(K.maxGoldPackCanBuy,"textbox","9000000","input-gold"),ce=this.createRow("Gold packing range".gts_translate(),[ae,re,ne(),oe,ie,de,,ne()],null,null,"hide guild-market-config shop-config","Bot will buy any items which has amount of gold in the configuration range".gts_translate());e.appendChild(ce);let me=gts_controlBuilder.createDropdown(K.guildPackSorting,guildPackSorting[2].value,guildPackSorting,"name","value");e.appendChild(this.createRow("Guild package sorting".gts_translate(),[me],null,null,"hide guild-market-config"));var ge=this.createInput(null,"checkbox");ge.checked=le(K.autoPutGoldPackBackToGM,!0),y(ge).on("change",function(){D(K.autoPutGoldPackBackToGM,this.checked)});var pe=this.createElement("select"),he=R(K.packDuration,marketDuration.twoHours),fe={1:2,2:8,3:24};for(var ve in fe){var ye=fe[ve];(Ze=t.createElement("option",null,null,"{numberOfHours} hours".gts_translate({numberOfHours:ye}))).value=ve,Ze.selected=t.isEqual(ve,he),pe.appendChild(Ze)}y(pe).on("change",function(){var e=t.getSelectedValue(this);null!=e&&D(K.packDuration,e)});var be=this.createElement("ul",null,"gold-packs"),ke=F(K.boughtGoldPacks);for(ve=0;ve<ke.length;ve++)(e=>{var t=this.createElement("li");let a={itemName:e.itemName,playerName:e.seller};var r="Bot bought {itemName} from {playerName}".gts_translate(a),n=this.createElement("span",null,"failed","Failed".gts_translate());q.showTooltip(n,[{text:e.errorMessage,color:"#ff0000"}]);var i=this.createElement("span",null,null,r),o=this.createElement("span",null,"gold-amount",e.packAmount),l=this.createElement("i",null,"icon_gold"),s=this.createElement("a",null,"remove","remove");s.onclick=(()=>{t.remove();var a=F(K.boughtGoldPacks);a=a.filter(function(t){return t&&t.id!=e.id}),D(K.boughtGoldPacks,JSON.stringify(a))}),o.appendChild(l),e.isError&&t.appendChild(n),t.appendChild(o),t.appendChild(i),t.appendChild(s),be.appendChild(t)})(ke[ve]);if(0==ke.length){var we=this.createElement("li",null,"no-bought-pack");we.textContent="There is no pack need to put back in Guild Market".gts_translate(),be.appendChild(we)}var _e=this.createRow("Packs bought from Guild Market".gts_translate(),[ge,b.createTextNode("Enable this option for auto put all gold packs in queue below to Guild Market with selected duration".gts_translate()),pe,be],null,null,"hide guild-market-config");e.appendChild(_e);var Ce=this.createInput(null,"checkbox");Ce.checked="true"===R(K.autoRepackExpiringItem,"true"),y(e).toggleClass("repack-enabled",Ce.checked),y(Ce).on("change",function(){D(K.autoRepackExpiringItem,this.checked),D(K.timeToTriggerAutoRepack,"0"),y(e).toggleClass("repack-enabled",this.checked)});var xe=this.createElement("select"),Te=R(K.dayLeftShouldRepack,4);for(var Ie of[1,2,3,4]){(Ze=t.createElement("option",null,null,1==Ie?"1 day".gts_translate():"{numberOfDay} days".gts_translate({numberOfDay:Ie}))).value=Ie,Ze.selected=t.isEqual(Ie,Te),xe.appendChild(Ze)}y(xe).on("change",function(){var e=t.getSelectedValue(this);null!=e&&D(K.dayLeftShouldRepack,e),D(K.timeToTriggerAutoRepack,"0")}),e.appendChild(this.createRow("Auto reset timer of expiring items".gts_translate(),[Ce,b.createTextNode("By enable this option, the Bot will sell upcoming expired items from Packages to Guild Market with 2 gold and cancel to reset expiration time. It requires player must in a Guild and the items cooldown less than".gts_translate()),xe]));var Se=q.unique(R(K.selectedItemTypeForRepack,defaultSelectedItemTypeForRepack).split(",").filter(e=>e)),Ae=this.createElement("ul",null,"repack-item-types");for(var Oe of itemTypes)if(Oe.value!=goldItemType){var qe=b.createElement("li"),Ee=b.createElement("input");qe.appendChild(Ee),Ee.type="checkbox",Ee.checked=Se.indexOf(Oe.value)>-1,Ee.id="chkRepack"+Oe.name.replace(" ",""),function(e){y(Ee).on("click",function(){var t=q.unique(R(K.selectedItemTypeForRepack,defaultSelectedItemTypeForRepack).split(",").filter(e=>e).map(e=>v(e)));this.checked?t.push(e):t.splice(t.indexOf(e),1),D(K.selectedItemTypeForRepack,t),D(K.timeToTriggerAutoRepack,"0")})}(v(Oe.value));var Pe=b.createElement("label");Pe.htmlFor=Ee.id,Pe.textContent=Oe.name,qe.appendChild(Pe),Ae.appendChild(qe)}var Be=R(K.selectedItemQualityForRepack,defaultSelectedItemQualityForRepack).split(",").filter(e=>e),Re=this.createElement("ul",null,"repack-item-types");for(let e of itemQualities)if(!(e.value<2)){var De=b.createElement("li"),Ne=b.createElement("input");De.appendChild(Ne),Ne.type="checkbox",Ne.checked=Be.indexOf(e.value)>-1,Ne.id="chkRepack_Quality_"+e.name.replace(" ",""),function(e){y(Ne).on("click",function(){var t=R(K.selectedItemQualityForRepack,defaultSelectedItemQualityForRepack).split(",").filter(function(e){return e}).map(function(e){return v(e)});this.checked?t.push(e):t=t.filter(t=>t!=e),D(K.selectedItemQualityForRepack,t),D(K.timeToTriggerAutoRepack,"0")})}(e.value);var Me=b.createElement("label");Me.htmlFor=Ne.id,Me.textContent=e.name,De.appendChild(Me),Re.appendChild(De)}var Le="true"==R(K.shouldRepackUnderworldItems,"true"),Ge=b.createElement("li"),Ue=b.createElement("input");Ge.appendChild(Ue),Ue.type="checkbox",Ue.checked=Le,Ue.id="chkRepack_UnderworldItems",y(Ue).on("click",function(){D(K.shouldRepackUnderworldItems,this.checked),D(K.timeToTriggerAutoRepack,"0")});var He=b.createElement("label");He.htmlFor=Ue.id,He.textContent="Underworld Items".gts_translate(),Ge.appendChild(He),Re.appendChild(Ge);var Ke=b.createElement("li");let Xe=gts_controlBuilder.createToggle(K.shouldRepackItemHasUnknownScroll,"Has unknown scroll".gts_translate(),!1,()=>D(K.timeToTriggerAutoRepack,"0"));Ke.appendChild(Xe[0]),Ke.appendChild(Xe[1]),Re.appendChild(Ke),e.appendChild(this.createRow("Item types should repack".gts_translate(),[Ae,Re],null,null,"hide repack-item-types-row"));var Je=gts_controlBuilder.createToggle(K.enableHighlightUnderworldItem,"",!0);e.appendChild(this.createRow("Highlight underworld items".gts_translate(),[Je]));var We=gts_controlBuilder.createToggle(K.autoThrowDice,"",!0);if(e.appendChild(this.createRow("Auto throw free dice".gts_translate(),[We])),q.getPlayerLevel()>4){var Ve=t=>{y(e).toggleClass("auto-repair-on",t)},Ye=R(K.autoRepairItem,"");"true"!=Ye&&"false"!=Ye||(Ye="true"==Ye?"1,2":"",D(K.autoRepairItem,Ye));var je=gts_controlBuilder.createCheckboxList("chkAutoRepairItem",dolls,"name","value",null,K.autoRepairItem,()=>{Ve(R(K.autoRepairItem,"").length>0)});Ve(Ye.length>0),e.appendChild(this.createRow("Auto repair item".gts_translate(),[je]));var $e=this.createElement("select");e.appendChild(this.createRow("Repair when conditioning below x%".gts_translate(),[$e],null,null,"hide auto-repair-config"));var ze=R(K.repairConditioningThrehold,"10");"0"==ze&&(ze="1",D(K.repairConditioningThrehold,ze));for(ve=0;ve<=50;ve+=10){let e=0==ve?ve+1:ve;var Ze;(Ze=this.createElement("option",null,null,e+"%")).value=e,Ze.selected=this.isEqual(e,ze),$e.appendChild(Ze)}y($e).on("change",function(){null!=(ze=Qe.getSelectedValue(this))&&D(K.repairConditioningThrehold,ze)});var et,tt=F(z.materialNames),at=[],rt=F(K.ignoreMaterials,JSON.parse(defaultIgnoreUWMaterials));for(var nt in tt)at.push({text:tt[nt],value:nt,icon:!0}),!et&&rt.indexOf(v(nt))<0&&(et=nt);var it=q.buildDropDown(at,et,e=>{et=e.value}),ot=this.createElement("ul",null,"ignore-materials"),lt=O.dom.createButton("Add to ignore list".gts_translate(),()=>{var e=F(K.ignoreMaterials,JSON.parse(defaultIgnoreUWMaterials));e.push(v(et)),e.sort((e,t)=>e-t),D(K.ignoreMaterials,JSON.stringify(O.array.unique(e))),st(ot)});lt.className+=" ml-5";var st=e=>{t.removeChildren(e);var a=F(K.ignoreMaterials,JSON.parse(defaultIgnoreUWMaterials));for(var r of a){var n=tt[r];n&&function(a,r){var n=t.buildPlayerItem(a,function(e){y(n).prev().focus(),n.remove(),y(".dropdown-item .item-i-18-"+r).parent().show();var t=F(K.ignoreMaterials);(t=t.filter(function(e){return e!=r&&e})).sort(),D(K.ignoreMaterials,JSON.stringify(O.array.unique(t))),e.stopPropagation()});e.appendChild(n)}(n,r)}setTimeout(()=>{for(var e of(y(".dropdown-item").show(),a))y(".dropdown-item .item-i-18-"+e).parent().hide()},100)};st(ot),e.appendChild(this.createRow("Repair item without using listed materials".gts_translate(),[it,lt,ot],null,null,""));var ut=itemFilterTypes.strength,dt=q.buildDropDown(auctionHouseFilterConditions,ut,e=>{ut=e.value,y(ct).toggle(e.value!=itemFilterTypes.hasUnknownScroll)},"mr-5"),ct=this.createInput("","textbox","mr-5"),mt=this.createElement("ul",null,"auction-item-filters"),gt=this.createElement("label","","color-red"),pt=()=>{D(K.nextTimeCheckAuctionHouse,0),D(K.nextTimeCheckAuctionHouse2,0)},ht=O.dom.createButton("Add Filter".gts_translate(),()=>{var e=auctionHouseFilterConditions.filter(e=>e.value==ut)[0];if(ut!=itemFilterTypes.hasUnknownScroll){var t=function(e,t){return mercenaryFilterTypes.indexOf(e.value)>-1?Number.isInteger(v(t))?"":"Filter value should be a number".gts_translate():""}(e,ct.value);if(gt.textContent=t,t)return}var a=F(K.auctionHouseItemFilters),r=a.find(t=>t.condition.value==e.value);r&&(mercenaryFilterTypes.indexOf(e.value)>-1||e.value==itemFilterTypes.damage)?r.value=ct.value:r&&r.condition.value==itemFilterTypes.hasUnknownScroll||a.push({condition:e,value:ct.value.toLowerCase(),id:q.randomId()}),D(K.auctionHouseItemFilters,JSON.stringify(O.array.unique(a))),ft(mt,K.auctionHouseItemFilters,pt),pt()}),ft=(e,a,r)=>{t.removeChildren(e);var n=F(a);for(var i of n)!function(n){var i=[itemFilterTypes.itemName,itemFilterTypes.itemNameWord].indexOf(n.condition.value)<0?n.value:`"${n.value}"`;let o=auctionHouseFilterConditions.find(e=>e.value==n.condition.value);var l=`${o&&o.text||n.condition.text} <b style="color: red;">${i}</b>`,s=t.buildPlayerItem(l,e=>{y(s).prev().focus(),s.remove();var t=F(a);t=t.filter(e=>e.id!=n.id&&e),D(a,JSON.stringify(t)),e.stopPropagation(),r&&r(n.id,t.length)});e.appendChild(s)}(i)};ft(mt,K.auctionHouseItemFilters,pt);var vt=this.createInput("chkAutoBidMatchedItem","checkbox");vt.checked="true"===R(K.autoBidMatchedItem,"true"),y(vt).on("change",function(){D(K.autoBidMatchedItem,this.checked),!this.checked&&D(settingKeys.auction.isOutbidingInVeryShort,!1)});var yt=this.createElement("label",null,null,"Auto bid matched items".gts_translate());yt.htmlFor=vt.id,R(K.itemTypesForAHFiltering,"1,2,3,4,5,6,8,9,15");var bt=gts_controlBuilder.createCheckboxList("chkItemTypeForAHFiltering",itemTypesForAuctionHouseFiltering,"name","value",null,K.itemTypesForAHFiltering,pt);e.appendChild(this.createRow("Auction house item filters".gts_translate(),[dt,ct,ht,gt,vt,yt,mt,bt],null,null));let a=gts_controlBuilder.createToggle(Z.onlyOutbidOthersInVeryShort,"Only outbid other players in very short".gts_translate());var kt=gts_controlBuilder.createDropdown(Z.outbidDuration,auctionState.short,auctionStateOptions,"text","value");e.appendChild(this.createRow("Auction bidding duration".gts_translate(),[kt,...a]));var wt=gts_controlBuilder.createInput(Z.maxOutbidItemPrice,"textbox",5e4,"input-gold");e.appendChild(this.createRow("Max bidding item price".gts_translate(),[wt,ne()],null,null,""));let r=y('<ul class="smelting-rules">'),n=F(K.smeltingRules,[]),i=itemTypeWithIcons.filter(e=>itemTypesForSmelting.indexOf(e.value)>=0).reduce((e,t)=>(e[t.value]=!0,e),{}),o=qualityFilterConditions.filter(e=>e.value<itemQuality.orange).reduce((e,t)=>(e[t.value]=!0,e),{}),l={mainFilterProp:itemFilterTypes.itemName,mainFilterValue:"",qualities:o,isActive:!0,hasUnknownScroll:void 0,selectedItemTypes:i},s=(e,t,a)=>{let r=y('<li class="smelting-rule">'),n=y('<div class="main-smelting-rule-row">'),i=y('<div class="item-types-smelting-rule-row">'),o=gts_controlBuilder.createRawToggle("",e.isActive,"",a=>{e.isActive=a,t(e)});q.showTooltip(o,[{text:"Turn on to active this rule",color:"#00ff00"}]);let l=q.buildDropDown(autoSmeltingFilterConditions,e.mainFilterProp,a=>{e.mainFilterProp=a.value;let r=gts_BoolOperators.indexOf(e.mainFilterProp)>-1;r&&(e.mainFilterValue=""),y(s)[r?"hide":"show"](),t(e)}),s=gts_controlBuilder._createInput(null,"textbox","main-filter-value",e.mainFilterValue,a=>{e.mainFilterValue=a,t(e)});y(s)[gts_BoolOperators.indexOf(e.mainFilterProp)>-1?"hide":"show"]();var u=q.buildDropDown(hasUnknownScrollFilters,e.hasUnknownScroll,a=>{e.hasUnknownScroll=a.value,t(e)});let d=gts_controlBuilder.createLabel("Level <="),c=gts_controlBuilder._createInput(null,"number","input-gold",e.level,a=>{e.level=a,t(e)});c.min=1;var m=gts_controlBuilder._createElement("span",null,"btn-delete","x");q.showTooltip(m,[{text:"Remove this rule",color:"#00ff00"}]),y(m).on("click",()=>{r.remove(),a(e)}),n.append(o).append(l).append(s).append(u).append(d).append(c).append(m),itemTypeWithIcons.filter(e=>itemTypesForSmelting.indexOf(e.value)>=0).map(a=>{let r=y(`<span class="item-type"><i class="item-type-icon ${a.icon}"></i></span>`);e.selectedItemTypes=e.selectedItemTypes||{},r.toggleClass("active",!!e.selectedItemTypes[a.value]),q.showTooltip(r[0],[{text:a.tooltip,color:"#00ff00"}]),((a,r)=>r.on("click",()=>{let n=e.selectedItemTypes||{},i=!n[a.value],o=1==itemTypeWithIcons.filter(e=>n[e.value]).length;!i&&o||(n[a.value]=i,e.selectedItemTypes=n,r.toggleClass("active",i),t(e))}))(a,r),i.append(r)});let g=y('<span class="item-type separator"></span>');return i.append(g),qualityFilterConditions.map(a=>{let r=y(`<span class="item-type with-quality"><span class="quality" style="background-color: ${a.color}"></span></span>`);e.qualities=e.qualities||{},r.toggleClass("active",!!e.qualities[a.value]),((a,r)=>r.on("click",()=>{let n=e.qualities||{},i=!n[a.value],o=1==qualityFilterConditions.filter(e=>n[e.value]).length;!i&&o||(n[a.value]=i,e.qualities=n,r.toggleClass("active",i),t(e))}))(a,r),i.append(r)}),i.append(g.clone()),hammerQualities.map(a=>{let r=y(`<span class="item-type"><i class="item-type-icon ${a.icon}"></i></span>`);e.selectedHammerTypes=e.selectedHammerTypes||{},r.toggleClass("active",!!e.selectedHammerTypes[a.value]),q.showTooltip(r[0],[{text:a.tooltip,color:"#00ff00"}]),((a,r)=>r.on("click",()=>{let n=e.selectedHammerTypes||{},i=!n[a.value],o=1==itemTypeWithIcons.filter(e=>n[e.value]).length;!i&&o||(n[a.value]=i,e.selectedHammerTypes=n,r.toggleClass("active",i),t(e))}))(a,r),i.append(r)}),r.append(n).append(i),r},u=()=>{let e=y('<li class="smelting-rule emtpy">');return e.text("Please add at least one active rule for auto smelting.".gts_translate()),e},d=(e,t)=>{r.empty(),0==e.length?r.append(u()):e.map(a=>{r.append(s(a,t,a=>{var r=e.findIndex(e=>e.id==a.id||null==e.id);r>-1&&e.splice(r,1),t(a)}))})},c=e=>{d(e,(t,a)=>{if(t&&!a){let e=F(settingKeys.smeltery.itemsForSmelt);se(settingKeys.smeltery.itemsForSmelt,e.filter(e=>e.ruleId!=t.id))}se(K.smeltingRules,e.sort((e,t)=>e.isActive&&!t.isActive?-1:!e.isActive&&t.isActive?1:0)),t.isActive&&!a&&q.resetAutoSmeltingState(),0==e.length&&(r.empty(),r.append(u()))})};c(n);let m=gts_controlBuilder.createButton("New Rule".gts_translate(),()=>{let e=y.extend(!0,{id:q.randomId()},l);n.push(e),se(K.smeltingRules,n),D(K.nextTimeCheckItemForSmelting,0),c(n),r[0].scrollTop=r[0].scrollHeight});e.appendChild(this.createRow("Auto smelting item filters".gts_translate(),[r[0],m]));let g=gts_controlBuilder.createCheckboxList("chkSmeltingInventory",bagData,"name","value","",K.inventoriesForAutoSmelting,()=>{D(ee.nextTryForSmelt,0)});e.appendChild(this.createRow("Auto smelting inventory".gts_translate(),[g]));var _t=[{type:"minerva",imageUrl:"../cdn/img//ui/gods/minerva_s16.png",tooltip:"Charisma Oil".gts_translate()},{type:"diana",imageUrl:"../cdn/img//ui/gods/diana_s16.png",tooltip:"Dexterity Oil".gts_translate()},{type:"mars",imageUrl:"../cdn/img//ui/gods/mars_s16.png",tooltip:"Agility Oil".gts_translate()},{type:"merkur",imageUrl:"../cdn/img//ui/gods/merkur_s16.png",tooltip:"Intelligence Oil".gts_translate()},{type:"apollo",imageUrl:"../cdn/img//ui/gods/apollo_s16.png",tooltip:"Damage Oil".gts_translate()},{type:"vulcanus",imageUrl:"../cdn/img//ui/gods/vulcanus_s16.png",tooltip:"Armour Oil".gts_translate()}],Ct=gts_controlBuilder.createCheckboxList("chkGodOil",_t,null,"type","god-oils",K.autoCollectGodOils);let p=gts_controlBuilder.createDropdown(K.godPointPercent,80,pointPercents.filter(e=>e.value>0),"name","value",()=>{D(K.nextTimeCheckGodOils,0)}),h=gts_controlBuilder.createLabel("If points >".gts_translate(),"margin-r-5");e.appendChild(this.createRow("Auto collect god oils".gts_translate(),[Ct,h,p]))}var xt=gts_controlBuilder.createToggle(K.repairBeforeSmelt,"");e.appendChild(this.createRow("Repair before smelt item".gts_translate(),[xt]));var Tt=gts_controlBuilder.createToggle(K.storeResourcesAfterSmelted,"",!0);e.appendChild(this.createRow("Store smelted resources".gts_translate(),[Tt]));var It=gts_controlBuilder.createToggle(K.storeResourcesEveryHour,"",!1,()=>ue(K.storeResourcesTime,0));e.appendChild(this.createRow("Store resources every hour".gts_translate(),[It]));var St=gts_controlBuilder.createToggle(K.autoStartStopEnabled,"Enabled".gts_translate(),!1,()=>{let e=Fe(Qe,132);e&&e()}),At=gts_controlBuilder.createToggle(K.donateGuildBankBeforeStop,"Donate guild bank before stop".gts_translate(),!1);let Ot=()=>{let e={},t=[];y("ul.start-stop-settings input").each((a,r)=>{a%2==0?(e={start:r.value},t.push(e)):e.stop=r.value}),D(K.autoStartStopSettings,JSON.stringify(t));let a=Fe(Qe,132);a&&a()},qt=e=>{let t=y("<li>"),a=gts_controlBuilder.createLabel("Start at".gts_translate()),r=gts_controlBuilder.createLabel("Stop at".gts_translate()),n=gts_controlBuilder.createButton("x");(e=>{y(n).on("click",()=>{e.remove(),Ot()})})(t);let i=y('<input type="time">');i.val(e.start),i.on("change",Ot);let o=y('<input type="time">');return o.val(e.stop),o.on("change",Ot),t.append(a),t.append(i),t.append(r),t.append(o),t.append(n),t},Et=[{start:"08:00",stop:"12:00"}],Pt=gts_controlBuilder.createButton("+"),Bt=(()=>{let e=F(K.autoStartStopSettings,Et),t=y('<ul class="start-stop-settings">');for(let a of e){let e=qt(a);t.append(e)}return t})();y(Pt).on("click",()=>{let e=qt(Et[0]);Bt.append(e),Ot()}),e.appendChild(this.createRow("Schedule start/stop".gts_translate(),[...St,...At,Bt[0],Pt]));let Rt=gts_controlBuilder.createCheckboxList("chkAutoUseBoostType",boostItemTypes,"text","value",null,K.autoUseBoostItems,e=>{(e=e.map(e=>v(e))).includes(boostItemTypeValues.damage)&&D(K.smallGrindstoneExpiredTime,0),e.includes(boostItemTypeValues.healPoint)&&se(K.healPointBoostExpiredTime,defaultHealPointBoostExpiredTime)});e.appendChild(this.createRow("Auto using boosts".gts_translate(),[Rt]));let Dt=gts_controlBuilder.createDropdown(K.jewelleryOilBoost,0,jewelleryBoostOilOptions,"text","value",()=>{se(K.jewelleryOilBoostExpiredTime,defaultJewelleryBoostExpiredTime)}),Ft=gts_controlBuilder.createCheckboxList(void 0,bagData,"name","value","",K.jewelleryOilLookupBag,()=>{se(K.jewelleryOilBoostExpiredTime,defaultJewelleryBoostExpiredTime)}),Nt=gts_controlBuilder.createLabel("Bot will try to lookup and use the suitable God oils in the selected inventory below".gts_translate(),"new-line");e.appendChild(this.createRow("Boost God oils on jewellery".gts_translate(),[Dt,Nt,Ft],null,null,null));var Mt=[{type:"minerva",imageUrl:"../cdn/img//ui/gods/minerva_s16.png",tooltip:"Blessing Intelligence".gts_translate()},{type:"diana",imageUrl:"../cdn/img//ui/gods/diana_s16.png",tooltip:"Blessing Armour".gts_translate()},{type:"mars",imageUrl:"../cdn/img//ui/gods/mars_s16.png",tooltip:"Blessing Damage".gts_translate()},{type:"merkur",imageUrl:"../cdn/img//ui/gods/merkur_s16.png",tooltip:"Blessing Charisma".gts_translate()},{type:"apollo",imageUrl:"../cdn/img//ui/gods/apollo_s16.png",tooltip:"Blessing Agility".gts_translate()},{type:"vulcanus",imageUrl:"../cdn/img//ui/gods/vulcanus_s16.png",tooltip:"Blessing Dexterity".gts_translate()}],Lt=gts_controlBuilder.createCheckboxList(void 0,Mt,null,"type","god-oils",K.godBlessingLevel1);let Gt=gts_controlBuilder.createDropdown(K.godBlessingLevel1Until,60,pointPercents.filter(e=>e.value>0),"name","value",()=>{ue(K.godBlessingLevel1Cooldown,0)}),Ut=gts_controlBuilder.createLabel("If points >".gts_translate(),"margin-r-5");e.appendChild(this.createRow("God blessing level 1".gts_translate(),[Lt,Ut,Gt]));let Ht=gts_controlBuilder.createCheckboxList(q.makeUid,usingBoostConditions,"text","value",null,K.selectedUsingBoostConditions);e.appendChild(this.createRow("Using boosts when".gts_translate(),[Ht]));let Kt=!1,Qt=0,Xt=!1,Jt=()=>!Kt,Wt="Used <b>{usedClothes}/{maxClothes}</b> clothes | <b>{remainingClothes}</b> remaining clothes".gts_translate(),Vt=gts_controlBuilder.createLabel(""),Yt=y(gts_controlBuilder._createElement("span",null,"loading hide"));var jt=y("#shopItemsSection .gts-items-section-content")[0];let $t=y('<div class="search-result-message">')[0],zt=Fe(q,133),Zt=gts_controlBuilder.createButton("Search".gts_translate(),()=>{if(Kt=!Kt){$t.textContent="";let e=(e,t,a)=>{Qt=t;let r=M(K.maxUsedClothesForSearchingShop);Vt.innerHTML=Wt.replace("{usedClothes}",Qt).replace("{maxClothes}",r).replace("{remainingClothes}",e),(0==e||a)&&(Kt=!1,Zt.disabled=!0,Zt.textContent="Search Completed"),se(K.shopHighQualityItems,[]),Qe.buildHighQualityItemsInShop(jt,[])},t=(e,t)=>{Xt=e.length>0,se(K.shopHighQualityItems,e),Qe.buildHighQualityItemsInShop(jt,e),Kt=!1,t||(Zt.disabled=!1,Zt.textContent="Continue"),Yt.toggleClass("hide",!0),$t.textContent=`${e.length} item(s) found. Check the "Shop items" box to see the result.`};Zt.textContent="Stop",zt&&zt(Xt,t,e,Jt,Qt),Yt.toggleClass("hide",!1)}else Xt=!1,Zt.textContent="Stopping",Zt.disabled=!0}),ea=itemTypeWithIcons.filter(e=>itemTypesForSearchingShop.indexOf(e.value)>=0).reduce((e,t)=>(e[t.value]=!0,e),{}),ta={mainFilterProp:itemFilterTypes.itemName,mainFilterValue:"",level:1,quality:-1,isActive:!0,noRuby:!1,selectedItemTypes:ea},aa=()=>{Kt=!1,Qt=0,Xt=!1,Zt.disabled=!1,Zt.textContent="Search".gts_translate(),Vt.innerHTML="",O.storage.setOption(settingKeys.premium.nextTimeCheckShopHighQualityItems,0)},ra=gts_controlBuilder.createButton("New Rule".gts_translate(),()=>{let e=F(K.rulesForSearchingShop),t=y.extend(!0,{id:q.randomId()},ta);e.push(t),se(K.rulesForSearchingShop,e),ga(e),aa()}),na=y('<div class="search-in-shop-actions">');na.append(ra).append(Zt).append(Yt).append(Vt);let ia=y('<div class="search-in-shop-settings">'),oa=gts_controlBuilder.createLabel("Number of clothes to use".gts_translate()+": "),la=gts_controlBuilder.createNumberInput(K.maxUsedClothesForSearchingShop,0);ia.append(oa).append(la);let sa=(e,t,a)=>{let r=y('<li class="search-in-shop-rule">'),n=y('<div class="main-shop-filter-row">'),i=y('<div class="item-types-shop-filter-row">'),o=gts_controlBuilder.createRawToggle("",e.isActive,"",a=>{e.isActive=a,t(e)});q.showTooltip(o,[{text:"Turn on to active this rule".gts_translate(),color:"#00ff00"}]);var l=q.buildDropDown(shopFilterConditions,e.mainFilterProp,a=>{if(e.mainFilterProp=a.value,mercenaryFilterTypes.indexOf(e.mainFilterProp)>-1){let t={};t[itemTypeValues.mercenary]=!0,e.selectedItemTypes=t;var r=i.find(".item-type");r.removeClass("active"),y(r[r.length-1]).addClass("active")}t(e)});let s=gts_controlBuilder._createInput(null,"textbox","main-filter-value",e.mainFilterValue,a=>{e.mainFilterValue=a,t(e)}),u=gts_controlBuilder.createLabel("Level >=".gts_translate()),d=gts_controlBuilder._createInput(null,"number","input-gold",e.level,a=>{e.level=a,t(e)});d.min=1;let c=gts_controlBuilder.createLabel("Quality >=".gts_translate());var m=q.buildDropDown(qualityFilterConditions,e.quality,a=>{e.quality=a.value,t(e)},"dropdown-color"),g=gts_controlBuilder.createRawToggle("No rubies".gts_translate(),e.noRuby,"",a=>{e.noRuby=a,t(e)}),p=gts_controlBuilder._createElement("span",null,"btn-delete","x");q.showTooltip(p,[{text:"Remove this rule".gts_translate(),color:"#00ff00"}]),y(p).on("click",()=>{r.remove(),a(e)}),n.append(o).append(l).append(s).append(u).append(d).append(c).append(m).append(g).append(p);y('<span class="item-type separator"></span>');return itemTypeWithIcons.filter(e=>itemTypesForSearchingShop.indexOf(e.value)>=0).map(a=>{let r=y(`<span class="item-type"><i class="item-type-icon ${a.icon}"></i></span>`);e.selectedItemTypes=e.selectedItemTypes||{},r.toggleClass("active",!!e.selectedItemTypes[a.value]),q.showTooltip(r[0],[{text:a.tooltip,color:"#00ff00"}]),((a,r)=>r.on("click",()=>{let n=e.selectedItemTypes||{},i=!n[a.value],o=1==itemTypeWithIcons.filter(e=>n[e.value]).length;!i&&o||(n[a.value]=i,e.selectedItemTypes=n,r.toggleClass("active",i),t(e))}))(a,r),i.append(r)}),r.append(n).append(i),r},ua=()=>{let e=y('<li class="search-in-shop-rule emtpy">');return e.text("Add at least one rule to search item in shop."),e},da=y.extend(!0,{id:q.randomId()},ta,{quality:2}),ca=F(K.rulesForSearchingShop,[da]);Zt.disabled=!ca.some(e=>e.isActive);let ma=y('<ul class="search-in-shop-rules">'),ga=e=>{((e,t)=>{if(ma.empty(),0==e.length)ma.append(ua());else for(let a of e){let r=sa(a,t,a=>{var r=e.findIndex(e=>e.id==a.id||null==e.id);r>-1&&e.splice(r,1),t()});ma.append(r)}})(e,()=>{se(K.rulesForSearchingShop,e),aa(),Zt.disabled=!e.some(e=>e.isActive),0==e.length&&(ma.empty(),ma.append(ua()))})};ga(ca),e.appendChild(this.createRow("Search item in shop".gts_translate(),[ia[0],ma[0],na[0],$t]));var pa=Fe(P.guild,138),ha=pa&&await pa();ha||(ha={data:[]}),ha.data.splice(0,0,{name:`---${"Select guild to war".gts_translate()}---`,value:""});let fa=R(K.warGuild),va=gts_controlBuilder.createDropdown(K.warGuild,null,ha.data,"name","value",()=>{!fa&&ue(K.warGuildTime,0)});va.disabled=!ha.hasPermission,!ha.hasPermission&&q.showTooltip(va,[{text:"You do not have permission to perform war guild".gts_translate(),color:"#00ff00",width:290}]),e.appendChild(this.createRow("Auto war guild".gts_translate(),[va]));let ya=[...Array(13).keys()].map(e=>({name:0==e?"No delay".gts_translate():"from 1 to {numOfMinutes} minutes".gts_translate({numOfMinutes:5*e}),value:5*e})),ba=gts_controlBuilder.createDropdown(K.warGuildDelay,0,ya,"name","value",e=>{let t=v(e),a=t>0?6e4*q.random(1,t):0;D(K.warGuildExtendTime,a)});e.appendChild(this.createRow("War guild random delay".gts_translate(),[ba]));let ka=M(K.autoWorkPlace,-1),wa=gts_controlBuilder.createDropdown(K.autoWorkPlace,-1,gts_workPlaces,"name","id",e=>{let t=_a(e),a=gts_workPlaces.find(t=>t.id==e);D(K.workDuration,a.min),gts_controlBuilder.createDropdownItems(Ca,1,t,"name","value")}),_a=e=>{let t=gts_workPlaces.find(t=>t.id==e),a=t.min,r=t.max;return[...Array(r-a+1).keys()].map(e=>e+a).map(e=>({name:1==e?"1 hour".gts_translate():"{numberOfHours} hours".gts_translate({numberOfHours:e}),value:e}))},Ca=gts_controlBuilder.createDropdown(K.workDuration,1,_a(ka),"name","value"),xa=gts_controlBuilder.createLabel("with duration".gts_translate(),"margin-r-5"),Ta=gts_controlBuilder.createToggle(K.donateBankBeforeWork,"Donate guild bank before go to work".gts_translate());e.appendChild(this.createRow("Auto work after run out of all points".gts_translate(),[wa,xa,Ca,...Ta]));let Ia=gts_controlBuilder.createDropdown(K.extraLoot,2,extraLootOptions,"text","value");e.appendChild(this.createRow("Extra loot action".gts_translate(),[Ia]))},buildHealthContent:function(t){this.removeChildren(t);let a=gts_controlBuilder.createLink("Check this video".gts_translate(),"https://www.youtube.com/watch?v=lMt06dY5j18","video-link margin-l-5");t.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode("Configuration for automating heal life point and some other features".gts_translate()),a]));let r=[];for(var n=5;n<=95;n+=5)r.push({value:n,name:`${n}%`});let i=gts_controlBuilder.createDropdown(Y.percent,20,r,"name","value"),o=gts_controlBuilder.createLabel("when attack Arena/Expedition".gts_translate()),g=y('<div class="margin-t-5 margin-r-5 margin-b-5">').append(i).append(o),p=gts_controlBuilder.createDropdown(Y.percentInUnderworld,40,r,"name","value"),h=gts_controlBuilder.createLabel("when in Underworld".gts_translate()),f=y('<div class="margin-t-5 margin-r-5 margin-b-5">').append(p).append(h);t.appendChild(this.createRow("Heal once % life below".gts_translate(),[g[0],f[0]]));var k=[],w=v((playerId+"").substr(0,6));(function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),i=I*w*(2<<S);n!=d(t[2],r)-i||i+T*(3<<S)!=d(a,r)||(4==t.length&&d(t[3],r)==i&&k.push((w*Qe.server).toString(19)),new Date(n))})(R(s(l(u(e("dIPOu7fkPOYRC3UdXjgHXldNx"),13))),"").trim()),x(),R(Y.bagOfFood,[512]);var _=gts_controlBuilder.createRadioList("rdoBagOfFood",bagData,"name","value",null,Y.bagOfFood);t.appendChild(this.createRow("Bag of foods".gts_translate(),[_])),R(Y.underworldHealFunc,underworldHealFunctionValue.guildMedic);var C=gts_controlBuilder.createCheckboxList("chkUnderworldHealControl",underworldHealOptions,"name","value",null,Y.underworldHealFunc);t.appendChild(this.createRow("Underworld healing".gts_translate(),[C]));var A=k.indexOf((w*Qe.server).toString(19))>-1,O=this.createInput(null,"checkbox");O.checked="true"===R(K.autoGetFoodFromPackages,"true"),y(O).on("change",function(){D(K.autoGetFoodFromPackages,this.checked)}),O.disabled=!A;var q=this.createElement("span",null,"red-text","Available only for Premium License".gts_translate());let E=[O];if(A||E.push(q),t.appendChild(this.createRow("Auto get food from packages".gts_translate(),E)),v(b.getElementById("header_values_level").textContent)>4){var P=this.createInput(null,"checkbox");P.disabled=!A,P.checked="true"===R(Y.autoBuyFood,"false"),y(P).on("change",function(){D(Y.autoBuyFood,this.checked),D(Y.checkingAvailableFoodTimer,0)});var B=this.createElement("span",null,"red-text","Available only for Premium License".gts_translate()),F=[P];if(A){var N=this.createElement("span",null,null,"Buy any food which has ratio of life points per gold greater than".gts_translate()),M=this.createInput(null,"textbox");M.className="gts-input-small",M.value=R(Y.goldPerLifePointRatio,"4"),y(M).on("change",function(){D(Y.goldPerLifePointRatio,this.value)});let e=y("<div>").append(gts_controlBuilder.createToggle(settingKeys.health.ignoreLargeFood,"Only buy small size food".gts_translate(),!0));F.push(N),F.push(M),F.push(e[0])}else F.push(B);var L=this.createRow("Auto buying food in Auction House".gts_translate(),F);t.appendChild(L)}var G=this.createInput(null,"checkbox");G.checked="true"===R(Y.stopAllIfHealingFail,"false"),y(G).on("change",function(){D(Y.stopAllIfHealingFail,this.checked)}),t.appendChild(this.createRow("Stop Bot if cant heal".gts_translate(),[G]));let U=gts_controlBuilder.createToggle(Y.allowBotEatCervisia,"");t.appendChild(this.createRow("Allow Bot eats Cervisia".gts_translate(),[U]));var H=e=>{de(t,"buy-food-from-shop-enabled",e)};let Q=gts_controlBuilder.createToggle(Y.buyFoodFromShop,"From shop".gts_translate(),"true",()=>{H(le(Y.buyFoodFromShop))}),X=e=>{de(t,"buy-food-from-market-enabled",e)},J=()=>ue(Y.buyFoodFromMarketNextTime,0),W=gts_controlBuilder.createToggle(Y.buyFoodFromMarket,"From public market".gts_translate(),"false",()=>{X(le(Y.buyFoodFromMarket)),J()});X(le(Y.buyFoodFromMarket)),t.appendChild(this.createRow("Auto buying food".gts_translate(),[...Q,...W])),H(le(Y.buyFoodFromShop));let V=gts_controlBuilder.createDropdown(Y.renewShopForFood,renewShopOptions[0].value,renewShopOptions,"name");t.appendChild(this.createRow("Renew shop for food".gts_translate(),[V],null,null,"renew-shop-options"));let j=gts_controlBuilder.createNumberInput(Y.maxGoldPerFood,1500,J);t.appendChild(this.createRow("Max gold for one food item".gts_translate(),[j,ne()],null,null,"buy-food-from-market"));let $=gts_controlBuilder.createNumberInput(Y.maxPageOfFoodInPackage,5,J);t.appendChild(this.createRow("Buy until get {x} pages of food in the packages".gts_translate(),[$],null,null,"max-page-of-food"));let z=gts_controlBuilder.createToggle(Y.onlyBuyFoodIfNeed,"","true");t.appendChild(this.createRow("Only buy once run out of food".gts_translate(),[z],null,null,"buy-food-if-need"))},buildEventContent:function(e){var t=this,a=[],r=v((playerId+"").substr(0,6));(function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var n=m(t[0],2),i=v(m(t[0],0,2)),o=d(t[1],i),l=I*r*(2<<S);o!=d(t[2],i)-l||l+T*(3<<S)!=d(n,i)||(4==t.length&&d(t[3],i)==l&&a.push((r*Qe.server).toString(19)),new Date(o))})(R(_(p(C(g("xdIPOu7fkPOYRC3UdXjgHXldN"),14))),"").trim()),x();var n=a.indexOf((r*Qe.server).toString(19))>-1;this.removeChildren(e);let i=gts_controlBuilder.createLink("Check this video".gts_translate(),"https://www.youtube.com/watch?v=lMt06dY5j18","video-link margin-l-5");e.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode("Configuration for automating attack Event mobs".gts_translate()),i]));var o=this.createInput(null,"checkbox");o.checked="true"===R(j.attackEventBoss,"false"),y(o).on("change",function(){D(j.attackEventBoss,this.checked)});var l=this.createInput(null,"checkbox");l.disabled=!n,l.checked="true"===R(j.resetEventPoint,"false"),y(l).on("change",function(){D(j.resetEventPoint,this.checked)});var s=this.createElement("span",null,"red-text","Available only for Premium License".gts_translate()),u=[l];!n&&u.push(s);var h=this.createRow("Auto reset event points".gts_translate(),u);e.appendChild(h);for(var f=[],k=1;k<5;k++)!function(e){var a=t.createElement("label",null,null,"Wave {round}".gts_translate({round:e})+":"),r=t.createInput(null,"textbox");r.className="gts-input-small",r.disabled=!n;var i=j["stopPointWave"+e];r.value=R(i,""),y(r).on("change",function(){D(i,this.value)}),f.push(a),f.push(r)}(k);!n&&f.push(s.cloneNode(!0));var w=this.createRow("Event points stop at".gts_translate(),f);e.appendChild(w);var A=this.createInput(null,"checkbox");A.disabled=!n,A.checked="true"===R(j.shouldFollowLeaderScore,"false"),y(A).on("change",function(){D(j.shouldFollowLeaderScore,this.checked)});s=this.createElement("span",null,"red-text","Available only for Premium License".gts_translate());var O=[A];!n&&O.push(s);var q=this.createRow("Follow leader score".gts_translate(),O);e.appendChild(q);var E=gts_controlBuilder.createDropdown(j.eventMob,3,[{name:"Opponent #1",value:1},{name:"Opponent #2",value:2},{name:"Opponent #3",value:3},{name:"Boss",value:4}],"name","value");e.appendChild(this.createRow("Opponent".gts_translate(),[E]))},buildMenu:function(e){var t=b.createElement("ul");t.className="tabs";var r=gts_controlBuilder._createElement("li",null,"center no-hover"),i=b.createElement("span");r.appendChild(i);var o=b.createElement("h4");o.textContent=`GTS ${gtsVersion}`,o.className="collapsed",r.appendChild(o),t.appendChild(r);var s=gts_controlBuilder._createElement("li",null,"center no-hover"),u=gts_controlBuilder._createElement("span",null,"gts-pause");s.appendChild(u),t.appendChild(s),q.isRunning()&&(u.className+=" pause");var g=void 0;y(u).on("click",()=>{if(!1===u.isPremium)return void(g&&g.click());let e=q.isRunning();n.isRunning=!e,q.startAutoCurrentTab(n.isRunning),D(z.paused,!n.isRunning),$(u).toggleClass("pause",n.isRunning)});var p=this.createElement("span",null,"button");u.appendChild(p);for(var h,w,_,C=v((playerId+"").substr(0,6)),A=[],O=(h=R(a(l(f(k("fkPOYRC3UdXjgHXldNxdIPOu7"),7))),"").trim().toLowerCase(),w=function(e){if(A=[],!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),i=I*C*(2<<S);return n!=d(t[2],r)-i||i+T*(3<<S)!=d(a,r)?null:(4==t.length&&d(t[3],r)==i&&A.push((C*Qe.server).toString(19)),new Date(n))}(h),_=x(),w&&w>_&&[].indexOf(h)<0),E=A.indexOf((C*Qe.server).toString(19))>=0,P=function(t){if(!O||t&&!E){var a=B.createElement("div");a.className="invalid-license",a.textContent=O&&t?"Invalid Premium License".gts_translate():"Invalid License".gts_translate(),e.appendChild(a)}},B=this,F=[{id:J.enabled,name:"Expedition".gts_translate(),onclick:function(){B.buildExpeditionContent(e),P()}},{id:V.enabled,name:"Underworld".gts_translate(),onclick:function(){B.buildUnderworldContent(e),P()}},{id:j.enabled,name:"Event".gts_translate(),onclick:function(){B.buildEventContent(e),P()}},{id:W.enabled,name:"Dungeon".gts_translate(),onclick:function(){B.buildDungeonContent(e),P()}},{id:X.enabled,name:"Arena".gts_translate(),onclick:function(){B.buildArenaContent(e,E),P()}},{id:Q.enabled,name:"Circus".gts_translate(),onclick:function(){B.buildCircusTumaContent(e,E),P()}},{id:Y.enabled,name:"Heal".gts_translate(),onclick:function(){B.buildHealthContent(e),P()}},{id:settingKeys.quest.enabled,name:"Pantheon".gts_translate(),onclick:function(){B.buildQuestProContent(e,E),P()}},{name:"Premium".gts_translate(),onclick:function(){B.buildPremiumContent(e),P(!0)}},{name:"General".gts_translate(),onclick:function(){B.buildGeneralSettings(e)}}],N=0;N<F.length;N++){var M=F[N];if(!(this.level<10&&M.name=="Dungeon".gts_translate())){var L=this.createMenuItem(M.id,M.name,M.onclick,e);!M.id&&(L.className="center"),N==F.length-1&&(g=L),t.appendChild(L)}}return t},buildMultipleSelectionControl:function(e,t,a){var r=this,n=this.createElement("div");n.setAttribute("contenteditable","");var i=this.createElement("ul");i.className="arena",t.appendChild(i);var o=this.createElement("li");i.appendChild(o),o.appendChild(n),i.onclick=function(){n.focus()},y(n).on("keypress",function(t){var o=function(e){var t=[],a="",r=!1;for(var n of e)if('"'!=n)","!=n||r?a+=n:a&&(t.push(a),a="");else{if(r){t.push(a),a="",r=!1;continue}r=!0}return a&&t.push(a),t}(n.innerText.trim()).map(e=>e.trim()).filter(e=>e);if(a&&(o=a(o)),13==t.keyCode&&o){var l=F(e);o=o.filter(function(e){return-1==l.indexOf(e)}),l=(l=l.concat(o)).filter(function(e,t){return e&&l.indexOf(e)==t}),se(e,l.filter(e=>e)),setTimeout(()=>{r.removeChildren(n)}),r.buildPlayerList(e,o,i)}}),y(n).on("keydown",function(e){var t=n.innerText.trim();8!=e.keyCode||t||y(n).parent().prev().focus()}),O.storage.migrateOldDataArrayToJson(e);var l=F(e);this.buildPlayerList(e,l,i)},buildArenaContent:function(e,t){this.removeChildren(e);let a=gts_controlBuilder.createLink("Check this video".gts_translate(),"https://www.youtube.com/watch?v=lMt06dY5j18","video-link margin-l-5");e.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode("Configuration for automating Provinciarum Arena".gts_translate()),a]));var r=this.createElement("div");this.buildMultipleSelectionControl(X.players,r);var n=this.createElement("span",null,"icon-copy","â");n.title="Copy to clipboard".gts_translate(),y(n).on("click",()=>{O.storage.copyOptionToClipboard(X.players)}),e.appendChild(this.createRow("Attack players cross server".gts_translate(),[r],"label-for-list",[n]));let i=gts_controlBuilder.createToggle(X.attackSameServerEnabled,"Enable attacking same server".gts_translate());var o=this.createElement("div");this.buildMultipleSelectionControl(X.sameServerPlayers,o);var l=this.createElement("span",null,"icon-copy","â");l.title="Copy to clipboard".gts_translate(),y(l).on("click",()=>{O.storage.copyOptionToClipboard(X.sameServerPlayers)}),e.appendChild(this.createRow("Same server attack list".gts_translate(),[...i,o],"label-for-list",[l]));var s=this.createInput(null,"textbox");s.className="input-gold";var u=v(b.getElementById("header_values_level").textContent);s.value=R(X.goldRaided,500*u),y(s).on("change",function(){D(X.goldRaided,this.value)});var d=this.createRow("Attack if raid over".gts_translate(),[s,ne()]);d.className+=" gold-raided",e.appendChild(d);var c=this.createInput(null,"checkbox");c.checked="true"===R(X.autoIgnorePlayer,"false"),y(c).on("change",function(){D(X.autoIgnorePlayer,this.checked)}),e.appendChild(this.createRow("Auto ignore player if lose".gts_translate(),[c]));var m=this.createInput(null,"checkbox");m.checked="true"===R(X.attackFiveTimesEnabled,"true"),y(m).on("change",function(){D(X.attackFiveTimesEnabled,this.checked)}),e.appendChild(this.createRow("Limit 5 attacks per day".gts_translate(),[m])),t||(m.disabled=!0,D(X.attackFiveTimesEnabled,!1),y(m).after(y("<span>").addClass("red-text").html("Available only for Premium License".gts_translate())));var g=this.createInput(null,"checkbox");g.checked="true"===R(X.doNotRunIfNoQuest,"false"),y(g).on("change",function(){D(X.doNotRunIfNoQuest,this.checked)}),e.appendChild(this.createRow("Pause if no suiable quest".gts_translate(),[g])),t||(g.disabled=!0,D(X.doNotRunIfNoQuest,!1),y(g).after(y("<span>").addClass("red-text").html("Available only for Premium License".gts_translate())));var p=this.createElement("div");this.buildMultipleSelectionControl(X.ignorePlayers,p);var h=this.createElement("span",null,"icon-copy","â");h.title="Copy to clipboard".gts_translate(),y(h).on("click",()=>{O.storage.copyOptionToClipboard(X.ignorePlayers)}),e.appendChild(this.createRow("Ignore players".gts_translate(),[p],"label-for-list",[h]));var f=this.createElement("div");this.buildMultipleSelectionControl(X.servers,f,this.validServerFilter),e.appendChild(this.createRow("Attack servers".gts_translate(),[f],"label-for-list"));var k=this.createElement("div");this.buildMultipleSelectionControl(X.ignoreServers,k,this.validServerFilter),e.appendChild(this.createRow("Ignore servers".gts_translate(),[k],"label-for-list"))},validateAutoSettings:function(){},start:function(){var t=v((playerId+"").substr(0,6));if(this.gameModeResolve(),this.initSettings(),this.countryData=autoSettingsData[re],this.isLoggedIn){var a,r,n=b.getElementById("icon_expeditionpoints"),i=b.getElementById("icon_dungeonpoints"),o=b.getElementById("icon_arena"),l=b.getElementById("icon_grouparena"),g=Te&&le(V.enabled),h=Te&&le(X.enabled),f=Te&&le(Q.enabled);this.init(),Te&&(U(),D(K.isInventoryUsing,"false"),setTimeout(()=>{let e="true"==R(K.isInventoryUsing,"false");if(Qe.isFixingItem||Qe.isSelling||this.isRepackExpiringItems)return;let t=q.cpstps;!e&&!Qe.isFixingItem&&!Qe.isSelling&&!this.isRepackExpiringItems&&t&&t()},4e3)),!Ie&&!Se&&this.validateAutoSettings();var y=this,k=!1,w=[],_=F(z.mapData),C=R(z.currentVersion,"");if(_&&_.length&&C==gtsVersion){if(P=R(s(p(u(e("kPOYRC3UdXjgHXldNxdIPOu7f"),6))),"").trim(),B=function(e){if(!e)return null;var a=c(e,"-");if(3!=a.length&&4!=a.length)return null;var r=m(a[0],2),n=v(m(a[0],0,2)),i=d(a[1],n),o=I*t*(2<<S);return i!=d(a[2],n)-o||o+T*(3<<S)!=d(r,n)?null:(4==a.length&&d(a[3],n)==o&&w.push((t*Qe.server).toString(19)),new Date(i))}(P),N=x(),B&&B>N&&[].indexOf(P)<0)Qe.isP=w.indexOf((t*Qe.server).toString(19))>-1,D(z.invalidKeyCount,0);else{var A=M(z.invalidKeyCount,"0");A>2?(D(z.paused,!0),q.startAutoCurrentTab(!1)):D(z.invalidKeyCount,++A);var E=b.querySelector(".gts-pause");E.className+=" disabled",E.isPremium=!1,q.showTooltip(E,[{text:"Buy Premium",color:"#ff0000"}])}var P,B,N,L=0,G=function(){k=!0,L<(new Date).getTime()&&(q.keepAlive(),L=(new Date).getTime()+5e3),clearTimeout(r),r=setTimeout(function(){k=!1,D(Y.disableHealUntil,0);let e=q.isRunning();!Ie&&!Ae&&e&&y.workflow.init(y.countryData)},2e3)};b.onmousemove=G,b.onkeypress=G,setTimeout(function(){let e=q.isRunning();!Ie&&!Ae&&!k&&e&&y.workflow.init(y.countryData)},10)}else y.workflow.checkToken(!1,()=>{D(z.paused,!0),O.utility.reload()})}function U(){a=Date.now(),H(0),requestAnimationFrame(J)}function H(e){(he||g)&&(n.style.transform="scale("+e+")"),be&&(i.style.transform="scale("+e+")"),h&&(o.style.transform="scale("+e+")"),f&&(l.style.transform="scale("+e+")")}function J(){let e=(Date.now()-a)/3e3;H(e),e>0&&e<1?requestAnimationFrame(J):setTimeout(U,300)}},getSelectedValue:function(e){var t=void 0===e.selectedIndex?n.event.srcElement:e;return t.value||t.options[t.selectedIndex].value},workflow:{d144:function(){var e=F(K.itemsNeedRepair);if(e.length>0){var t=e[0];if(n.location.href.indexOf("mod=overview&doll="+t.doll)>0){var a=Fe(q,105);if(e=a&&a(t.doll,y("#content")),D(K.itemsNeedRepair,JSON.stringify(e)),0==e.length)return!1;var r=Fe(Ne,102);if(r&&r(t.doll),2==t.doll){var i=B.link({mod:"overview",doll:1});y.get(i)}}else n.location.href=B.link({mod:"overview",doll:t.doll,isRepairing:!0});return!0}},q159:function(e){Qe.isExecuting=!0;var a=B.link({mod:"overview",doll:1}),r=["f68if"],i=v((playerId+"").substr(0,6)),o=function(){var e=R(s(t(C(g("YRC3UdXjgHXldNxdIPOu7fkPO"),28))),"").trim(),a=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),n=v(m(t[0],0,2)),o=d(t[1],n),l=I*i*(2<<S);return o!=d(t[2],n)-l||l+T*(3<<S)!=d(a,n)?null:(4==t.length&&d(t[3],n)==l&&r.push((i*Qe.server).toString(19)),new Date(o))}(e),n=x();return a&&a>n&&[].indexOf(e)<0},l=function(){if("true"==R(Y.stopAllIfHealingFail,"false"))q.startAutoCurrentTab(!1),D(z.paused,!0);else{var e=(new Date).getTime()+3e4;D(Y.disableHealUntil,e)}n.location.href=a};if(o()){var u=Ne,p=Fe(Ne,18);if(p&&p(e))if(u.isAutoHeal){var h=(new Date).getTime();if(Se){var f=R(Y.underworldHealFunc,underworldHealFunctionValue.guildMedic),y=f.indexOf(underworldHealFunctionValue.guildMedic+"")>-1,k=f.indexOf(underworldHealFunctionValue.healingPotion+"")>-1;var w=E.getCurrentRubies()>5&&f.indexOf(underworldHealFunctionValue.payPrayer+"")>-1,_=M(Y.guildMedicAvailableTime),A=B.link({mod:"premium",submod:"inventory"});let e=async()=>{await P.underworld.payPrayer(),q.reload()};if(y&&h>_){var F=B.link({mod:"guild_medic"});if(n.location.href.indexOf("mod=guild_medic")>-1){var N=Array.from(b.querySelector("#guild_medicus_heal").querySelectorAll("a")).filter(e=>e.href.indexOf("mod=guild_medic")>-1);if(N.length>0)N[0].click();else _=Array.from(b.querySelector("#guild_medicus_heal").querySelectorAll("span[data-ticker-time-left]")).map(function(e){return v(e.getAttribute("data-ticker-time-left"))}).sort()[0],D(Y.guildMedicAvailableTime,h+_),k?n.location.href=A:w?e():l()}else n.location.href=F}else if(k)if(n.location.href.indexOf("mod=premium&submod=inventory")>-1){var L=Array.from(b.querySelectorAll(".premium_activate_button")).filter(e=>!e.disabled&&e.getAttribute("onclick").match(/\&feature=18\&/)).pop();L?L.click():w?e():l()}else n.location.href=A;else w?e():l()}else if(n.location.href.indexOf("mod=overview&doll=1")>-1){var G,U=R(Y.bagOfFood,[512]).split(",").filter(function(e){return e}),H=0,Q=U[H++],X=b.getElementById("inventory_nav").querySelector(".awesome-tabs.current").getAttribute("data-bag-number"),J=!1,W=(i=v((playerId+"").substr(0,6)),-1),V=async function(){G!=X&&function(e){var t,a=b.getElementById("inv"),r=[5,8],n=O.item._move.getGridItems(a),i=O.item._move.getGridMap(r[0],r[1],n),o=0;do{(t=O.item._move.findGridSpot(2,2,i))&&(o++,n.push({x:t.x,y:t.y,h:2,w:2}))}while(t);W<o&&(G=e,W=o)}(X);for(var t=b.getElementById("inv"),a=Fe(Ne,18),n=0;n<t.children.length;n++){if("spinner-img"==(C=t.children[n]).getAttribute("class"))return J=!0,void setTimeout(function(){V()},3e3);let r=C.getAttribute("data-basis").split("-");var s=r[0],u=r[1],d=C.getAttribute("data-soulbound-to");let i="true"==R(Y.allowBotEatCervisia,"false");if("7"==s&&(i||cervisiaItemSubTypes.indexOf(u)<0)&&(!d||v(d)==playerId)&&a&&a(e)){let e=E.getItemData(C);return o()&&P.overview.heal(X,e.positionX,e.positionY),setTimeout(()=>{location.reload(!0)},2e3),J=!0,!0}}if(!J)if(H<U.length)Q=U[H++],X=Q,b.querySelector('a[data-bag-number="'+Q+'"]').click();else if(a&&a(e)){var c=le(K.autoGetFoodFromPackages,!0),m=r.indexOf((i*Qe.server).toString(19))>-1,g=le(Y.buyFoodFromShop,!0),p=le(Y.buyFoodFromMarket),f=M(Y.buyFoodFromMarketNextTime,0);if(!c&&!g&&!p||!m)return void l();if(G!=X)return X=Q=G,void b.querySelector('a[data-bag-number="'+G+'"]').click();if(c){let e=q.cpsfrei;await e();var y=1;let t=le(Y.allowBotEatCervisia);for(;;){var k=await P.getPackagePage(null,y++,{f:itemTypeValues.usable,fq:itemQualities[0].value}),w=preventJQueryLoadResource(k).find(".packageItem"),_=[];for(n=0;n<w.length;n++){var C,x=(C=w[n]).querySelector("[data-content-type]").getAttribute("data-basis").split("-")[1];(t||cervisiaItemSubTypes.indexOf(x)<0)&&_.push(C)}if(0==_.length){if(15==w.length&&y<10)continue;break}q.setStatusMessage("Bot is picking food from packages".gts_translate());var T=Fe(Ne,130);return void(T&&T(_,Q,l))}}var I=!1;if(p&&f<h){let e=Fe(Ne,136);e&&(I=await e(g?null:l,!1))}if(!I&&g){var S=Fe(Ne,129);S&&S(Q,l)}}};O.inventory.onLoaded(function(){X!=Q?(X=Q,b.querySelector('a[data-bag-number="'+Q+'"]').click()):V()})}else n.location.href=a}else l()}},q117:async function(e){var t=le(V.enabled),a=le(X.enabled),r=le(Q.enabled),n=le(V.pauseArena),i=[questType.any,questType.combat];(he||t||be)&&i.push(questType.item),(he||t)&&i.push(questType.expedition),be&&i.push(questType.dungeon),a&&(!n||!Se)&&i.push(questType.arena),r&&i.push(questType.groupArena);var o=F(settingKeys.quest.pickingRules);o=o.filter(e=>e);var l=Array.from(e.find(".contentboard_slot_active")).map(e=>{var t=q.getQuestIconName(e.querySelector(".quest_slot_icon").getAttribute("style"));return t.indexOf("icon_grouparena")>-1?questType.groupArena:t.indexOf("icon_arena")>-1?questType.arena:null}),s=l.indexOf(questType.arena)>-1,u=l.indexOf(questType.groupArena)>-1;D(settingKeys.quest.hasArenaQuest,s),D(settingKeys.quest.hasTumaQuest,u);var d=B.link({}),c=d.substring(0,d.indexOf("index")),m=Array.from(e.find(".contentboard_slot_inactive")).map(e=>{var t=e.querySelector(".quest_slot_button");if(!t)return null;var a=q.getQuestIconName(e.querySelector(".quest_slot_icon").getAttribute("style")),r=e.querySelector(".quest_slot_title").textContent.toLowerCase(),n=e.querySelector(".quest_slot_reward_item > img"),i=null,l=!1;if(n)try{var s=JSON.parse(y(n).attr("data-tooltip"))[0];i=s[0][0];l=250==s[s.length-1][2]}catch{}var u=r.match(/(\d+)/),d=a.indexOf("icon_grouparena")>-1?questType.groupArena:a.indexOf("icon_arena")>-1?questType.arena:a.indexOf("icon_items")>-1?questType.item:a.indexOf("icon_combat")>-1?questType.combat:a.indexOf("icon_expedition")>-1?questType.expedition:a.indexOf("icon_dungeon")>-1?questType.dungeon:questType.work,m=u?v(u[1]):0,g=null==e.querySelector(".quest_slot_time"),p=null!=e.querySelector(".quest_slot_reward_xp"),h=e.querySelectorAll(".quest_slot_reward_god"),f={};for(var b of h){var k=b.querySelector("[src]").getAttribute("src"),w=v(b.querySelector("[data-tooltip]").getAttribute("data-tooltip").match(/\d+/)[0]),_=godImageMaps[k.match(/\/(\w+)\.png/)[1]];f[_]=w}for(var C=o.filter(e=>e.type==d||e.type==questType.any),x=!1,T=999,I=null,S=0;S<C.length&&!x;S++){var A=C[S];(x=!A.conditions.length||A.conditions.every(e=>{if(e.operator==filterOperators.contains){var t=new RegExp(e.value.trim(),"gi");return!!r.match(t)}if(e.operator==filterOperators.notContains){t=new RegExp(e.value.trim(),"gi");return!r.match(t)}if(e.operator==filterOperators.numberAttackLessThan)return m<e.value;if(e.operator==filterOperators.hasNoTimer)return g;if(e.operator==filterOperators.itemContains&&i&&!l){t=new RegExp(e.value.trim(),"gi");return!!i.match(t)}if(e.operator==filterOperators.itemNotContains&&i&&!l){t=new RegExp(e.value.trim(),"gi");return!i.match(t)}return e.operator==filterOperators.rewardIsFood?l:e.operator==filterOperators.hasExperience?p:e.operator==filterOperators.hasApollo?f.apollo>0:e.operator==filterOperators.hasVulcan?f.vulcan>0:e.operator==filterOperators.hasMars?f.mars>0:e.operator==filterOperators.hasMercury?f.mercury>0:e.operator==filterOperators.hasDiana?f.diana>0:e.operator==filterOperators.hasMinerva&&f.minerva>0}))&&(I=A.type),T=o.indexOf(A)}return{url:c+t.getAttribute("href"),questType:I,count:m,title:r,validToPick:x,order:T}}).filter(e=>e&&i.indexOf(e.questType)>-1&&e.validToPick).sort((e,t)=>t.order>e.order?1:t.order<e.order?-1:t.count>e.count?-1:t.count<e.count?1:0).pop();if(m){D(settingKeys.quest.renewQuestCount,0);let e=await y.get(m.url);return preventJQueryLoadResource(e)}{let t=e.find("#quest_footer_reroll [type=button]").length>0;var g=e.find(".quest_slot_button_cancel").length;if(t&&g<5){let e=await P.resetPantheon();return preventJQueryLoadResource(e)}}},i47:async function(){if(Ie||Se||xe)return!1;if(Ge)return!0;let e=E.getCurrentGold(),t=E.getExpeditionPoints(),a=E.getMaxExpeditionPoints(),r=E.getDungeonPoints(),n=E.getMaxDungeonPoints(),i=R(J.travelCountryWhenZeroPoints),o=M(J.minDungeonPointsToTravel,50),l=R(W.travelCountryWhenZeroPoints),s=M(J.minExpeditionPointsToTravel,50),u=me.find(e=>e.id==ve).country,d=pe>10?ge.find(e=>e.id==we).country:void 0;if(i==relativeCountryValues.dungeon?i=d:o=0,l==relativeCountryValues.expedition?l=u:s=0,i&&i!=re&&re==u&&r/n*100>=o&&!Re){if(travelCosts[`${re}-${i}`]>e)return;return Ge=!0,await P.travelToCountry(i,d==i&&Ee),q.reload(),!0}if(l&&l!=re&&re==d&&t/a*100>=s&&!De){if(travelCosts[`${re}-${l}`]>e)return;return Ge=!0,await P.travelToCountry(l,u==l&&qe),q.reload(),!0}},e103:function(e,t,a,r){var i=n.location.href,o=Fe(Ne,4),l=Fe(Ne,5),s=Fe(Ne,6),u=Fe(Ne,7),d=Fe(Ne,9);let c=E.getEventUrl();var m=Fe(Ne,18),g=m&&m();let p=le(te.checkMissionBeforeAttack,!0);var h=Fe(Ne,146);let f=async e=>{p&&h&&await h(!0),e&&e()};if(he&&!Se&&i.indexOf("mod=location&loc=")>-1&&y("#cooldown_bar_expedition > .cooldown_bar_fill_ready").length>0)return!g&&(f(o),!0);if(e&&Se&&i.indexOf("mod=location&loc=")>-1&&y("#cooldown_bar_expedition > .cooldown_bar_fill_ready").length>0)return!g&&(f(l),!0);if(be&&!Se&&i.indexOf("mod=dungeon&loc=")>-1&&y("#cooldown_bar_dungeon > .cooldown_bar_fill_ready").length>0)return f(s),!0;if(t&&i.indexOf("mod=arena&submod=serverArena&aType=2")>-1&&y("#cooldown_bar_arena > .cooldown_bar_fill_ready").length>0)return!g&&(f(u),!0);if(a&&i.indexOf("mod=arena&submod=serverArena&aType=3")>-1&&y("#cooldown_bar_ct > .cooldown_bar_fill_ready").length>0)return f(d),!0;if(r&&i.indexOf(c)>0&&0==(y("#content").find("[data-ticker-time-left]").data("ticker-time-left")||0)&&!Qe.isEventRunning){let e=Fe(Ne,24);return e&&e(g)}},q99:async function(e){if(!le(settingKeys.quest.enabled)||Qe.isQuestChecked)return;Qe.isQuestChecked=!0,e&&q.setStatusMessage("Checking and filling up mission".gts_translate());let t=await P.getPantheonPage(),a=preventJQueryLoadResource(t),r=Fe(Ne,147),n=Fe(Ne,148),i=Fe(Ne,149),o=Fe(Ne,150);a=r&&await r(a);var l=F(settingKeys.quest.pickingRules).length;let s=0;do{let e=E.getPantheonCooldown(a);n&&n();let t=he&&!Se&&0==E.getExpeditionCooldown(a),r=be&&!Se&&0==E.getDungeonCooldown(a),u=this.isAutoPerformUnderworld&&Se&&0==E.getExpeditionCooldown(a),d=this.isAutoPerformArena&&0==E.getArenaCooldown(a),c=this.isAutoPerformCt&&0==E.getCircusCooldown(a),m=t||r||u||d||c;if(e){q.reload(e/1e3);break}{let e=M(te.minFillupQuestCount,3),t=a.find("#quest_header_accepted").text().match(/(\d)\s\/\s(\d)/),r=t?v(t[1]):0,n=t?v(t[2]):0;if(e>n&&(D(te.minFillupQuestCount,n),e=n),r==n)break;if(!(0==s||r<e)&&m)break;{let e="Checking and filling up mission (reset count {resetCount})".gts_translate({resetCount:s});s>0&&q.setStatusMessage(e),a=l?i&&await i(a):o&&await o(a),s++}}}while(a);q.setStatusMessage("")},z27:async function(){if(Ke)return;Ke=!0;let e=le(settingKeys.package.autoSell),t=M(settingKeys.package.autoSellTime),a=(new Date).getTime();if(e&&!(a<t)&&!E.redirectToIfNeed({mod:"packages"})){for(;!n.gts_packages;)await q.wait(.5);ue(settingKeys.package.autoSellTime,600);var r=Fe(n.gts_packages,51);return r&&r(!0),!0}},a69:function(){if(n.isHidingGold||Ne.isPutingPack)return;n.isHidingGold=!0;var e={mod:"guildMarket",fl:0,fq:-1,f:0,qry:"",seller:"",s:R(K.guildPackSorting,guildPackSorting[2].value),p:1},t=B.link(e);if(n.location.href.indexOf("mod=guildMarket")>-1){var a=1;setInterval(()=>{let e=".".repeat(a%3+1);q.setStatusMessage(e+"Hiding gold in Guild Market".gts_translate()+e),a++,D(K.isInventoryUsing,"true")},1e3),async function(){var t=b.getElementById("market_table"),a=Fe(Ne,25);if(!t)return void(a&&a());var r=q.getCurrentGold(),i=Array.from(t.querySelectorAll("input[name=buyid]")),o=Array.from(t.querySelectorAll("input[name=qry]")),l=Array.from(t.querySelectorAll("input[name=seller]")),s=Array.from(t.querySelectorAll("input[name=f]")),u=Array.from(t.querySelectorAll("input[name=fl]")),d=Array.from(t.querySelectorAll("input[name=fq]")),c=Array.from(t.querySelectorAll("input[name=s]")),m=Array.from(t.querySelectorAll("input[name=p]")),g=Array.from(t.querySelectorAll("tr")),p=!0,h=M(K.minGoldPackCanBuy,"30000"),f=M(K.maxGoldPackCanBuy,"9000000"),k=M(K.packDuration,marketDuration.twoHours),w=M(Z.packGoldAmount,"30000");let _=1,C=!1,x=e=>{var t=F(K.boughtGoldPacks);(t=t.filter(t=>t.id!=e.id&&(1==t.version||!t.isError))).push(e),se(K.boughtGoldPacks,t)},T=e=>{var t=F(K.boughtGoldPacks);t=t.filter(t=>t.id!=e),se(K.boughtGoldPacks,t)};do{var I=g[_].children,S=q.parseGold(I[2].innerText.trim()),A=g[_].querySelector("input[name=buy]");if(!A||A.disabled||r<S||S<h||S>f){_++;continue}var O=I[1].innerText.trim(),R=I[0].querySelector("[data-content-type]"),D=E.getItemData(R);delete D.tooltip,y.extend(!0,D,{id:q.randomId(),seller:O,packAmount:S,time:q.getServerDateString(),triedCount:0,version:1});let e={buyid:i[_-1].getAttribute("value"),qry:o[_-1].getAttribute("value"),seller:l[_-1].getAttribute("value"),f:s[_-1].getAttribute("value"),fl:u[_-1].getAttribute("value"),fq:d[_-1].getAttribute("value"),s:c[_-1].getAttribute("value"),p:m[_-1].getAttribute("value"),buy:"Buy"},t=await P.market.buyItem(e);if(t<r-S+.01*r){if(p=!1,x(D),r=t,!C){let e=q.cpsfpi;await e(!0),C=!0}var N=q.t_ficnip,L=0;do{D.containerNumber=await N(D),L++,0==D.containerNumber&&await P.delay(1e3)}while(L<3&&0==D.containerNumber);if(0==D.containerNumber&&(D.containerNumber=await N(D,!0)),x(D),0!=D.containerNumber&&Ne.isAutoPutPackBackEnabled&&r>=S*(k+1)/100){var G=Fe(q,43);let e=E.canSellItemToGM();if(ue(settingKeys.guildMarket.guildMarketFullTime,e?0:30),!e)continue;let t=await G(D.measurementX,D.measurementY);if(!t)continue;let a=await P.moveItemFromPackageToInventory(D.containerNumber,t.bagId,t.spot.x+1,t.spot.y+1,D.amount);if(a){let e=S*(k+1)/100;if((r=q.getCurrentGold())>=e){let t=await P.market.sellItem(a.itemId,D.packAmount,k),n=preventJQueryLoadResource(t),i=E.getCurrentGold(n);i<r-e/2+.05*e&&T(D.id),r=i}}}}else r=t;_++}while(_<g.length);if(p&&r>w){var U=n.location.href.match(/\&p=(\d)/),H=U?v(U[1]):1,Q=y("#market_table").next(),X=1;Q&&(X=Q.find("a").length),H<X?(e.p=H+1,n.location.href=B.link(e)):a&&a()}else q.reload()}()}else n.location.href=t},i121:function(e){var t=j.cooldown,a=j.points;if(!("true"==R(j.enabled,"false"))||Qe.isEventRunning)return;if(Qe.isEventRunning=!0,M(j.nextCheckingTime,"0")>(new Date).getTime())return;let r=E.getEventUrl();var i=r.match(/\&loc=([a-z_]+)\&/);if(!(r.indexOf("serverQuestHighscore")>-1||!i||v(i[1])>=0)){if(n.location.href.indexOf(r)>-1){var o=Array.from(y("img[align=absmiddle]")).filter(e=>{var t=y(e).attr("src")||"";return t.indexOf("add5f2cc36b27f4719bf2f2772b33d")>0||t.indexOf("expedition_points2.png")>0});if(!o.length)return void D(j.enabled,"false");var l=v(o[0].parentElement.textContent.trim().match(/\:\s(\d+)/i)[1]);D(a,Math.max(l,0));var s=y("#content").find("[data-ticker-time-left]").data("ticker-time-left")||0;D(t,(new Date).getTime()+s)}var u=R(t,"0"),d=new Date(v(u))-new Date;d>0&&(s=d);var c=Fe(Ne,17);if(s)setTimeout(function(){Qe.isFixingItem||Qe.isSelling||n.isHidingGold||Ne.isPutingPack||(e?n.location=n.location.href:c&&c(r))},s);else{if(e)return;var m=R(j.lastExecutedDate,"");if(!m)return c&&c(r),!0;var g=M(j.points,16),p=b.getElementById("server-time").getAttribute("data-start-time"),h=JSON.parse(p),f=JSON.parse("["+m+"]"),k="true"==R(j.resetEventPoint,"false");if(4!=f.length||g>0||k||h[2]!=f[2]||h[3]!=f[3])return c&&c(r),!0}}},u134:async function(){var e,a,r,i=v((playerId+"").substr(0,6)),o=[];if(e=R(_(t(C(g("fkPOYRC3UdXjgHXldNxdIPOu7"),32))),"").trim(),a=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),l=I*i*(2<<S);return n!=d(t[2],r)-l||l+T*(3<<S)!=d(a,r)?null:(4==t.length&&d(t[3],r)==l&&o.push((i*Qe.server).toString(19)),new Date(n))}(e),r=x(),!(a&&a>r&&[].indexOf(e)<0))return;if(o.indexOf((i*Qe.server).toString(19))<0)return;if(Qe.isFixingItem)return;Qe.isFixingItem=!0,q.setStatusMessage("Checking smelter state".gts_translate());var l=Fe(Ne,20);if(!l)return;let s=await P.smeltery.getStatus();for(var u=JSON.parse(s.match(/slotsData\s*=\s*(.*);/)[1]),p=[],h=[],f=0;f<6;f++){var y=u[f],b=y["forge_slots.state"],k=b.indexOf("finished")>-1,w="closed"==b;"crafting"==b&&h.push(y["forge_slots.finishedIn"]),(k||w)&&p.push({isFinished:k,isEmpty:w,index:f})}if(0==p.length){var A=h.sort((e,t)=>e-t)[0],O=(new Date).getTime()+1e3*A;return D(ee.nextTryForSmelt,O),D(ee.minGoldToSmelt,0),void setTimeout(()=>{n.location.reload(!0)},10)}var E="true"==R(K.storeResourcesAfterSmelted,"true");for(let e of p)e.isFinished&&(E?await P.smeltery.storeResources(e.index):await P.smeltery.freeSlot(e.index));return await l(p.map(e=>e.index))},racs:function(){var e=B.link({mod:"arena",submod:"serverArena",aType:"2"});if(n.location.href.indexOf("mod=arena&submod=serverArena&aType=2")>-1){var t=M(z.delayInSeconds,15),a=1e3*q.random(0,t);q.showTimer("Provinciarum Arena".gts_translate(),a),Qe.isExecuting=!0,setTimeout(()=>{var e=b.getElementById("own2").children[0].children[0].children,t=Fe(Ne,8)(e,X,!0);t>-1?q.startProvinciarumFightConfirmed(b.querySelectorAll("div.attack")[t]):b.getElementsByName("actionButton")[0].click()},a)}else n.location.href=e},checkingRequestedPacks:function(){var e=M(K.nextCheckingTime,"0"),t=M(K.messageFolder,"-1");if(!(t<1)){var a=B.link({mod:"messages",submod:"messageShow",folder:t}),r=(new Date).getTime(),i=Math.max(e-r,0);if(i>0)setTimeout(function(){n.location.reload(!0)},i);else{if(n.location.href.indexOf("mod=messages&submod=messageShow&folder=1")>-1)return setTimeout(()=>{for(var e=Array.from(b.querySelectorAll(".message_box")),t=F(K.processedPacks),a=[],r=B.ajaxLink({}),i=0;i<e.length;i++){var o=e[i].querySelector(".message_text").innerText,l=e[i].id.match(/message(\d+)/)[1];if(!(o.indexOf("#pack#")<0||t.indexOf(l)>-1)){var s=v(o.match(/#pack#(\d+)#/)[1]);a.push({messageId:l,packAmount:s})}}D(K.nextCheckingTime,(new Date).getTime()+12e4),D(K.requestingPacks,JSON.stringify(a));var u=function(e){if(e>a.length-1)n.location.href=B.link({mod:"guildMarket"});else{var t=a[e++];y.post(r,{mod:"messages",submod:"deleteMessage",messageId:t.messageId,a:(new Date).getTime()},function(){setTimeout(function(){u(e)},200)})}};a.length>0?u(0):n.location.reload(!0)}),!0;n.location.href=a}}},v0:async function(){var e=N(K.godBlessingLevel1);if(0==e.length)return;var t=M(K.godBlessingLevel1Cooldown,0);if((new Date).getTime()<t)return;Qe.isExecuting=!0;let a=M(K.godBlessingLevel1Until,80);if(!(n.location.href.indexOf("mod=gods")>-1&&e.length>0))return n.location.href=B.link({mod:"gods"}),!0;for(var r,i=0;i<e.length;i++){var o=e[i],l=y("#"+o);let t=l.find(".god_points").text().match(/(\d+)\s\/\s(\d+)/);if(t&&!(t.length<3)&&100*t[1]/t[2]>a){let e=l.find("[data-ticker-time-left]").data("ticker-time-left")||0;if(e>0)r=r?Math.min(r,e):e;else{var s=B.link({mod:"gods",submod:"activateBlessing",god:godTypeMap[o],rank:1});await y.get(s),e=648e5/Oe,r=r?Math.min(r,e):e}}}D(K.godBlessingLevel1Cooldown,(new Date).getTime()+(r||18e5))},m32:async function(){var e=R(V.farmingMode,underworldFarmingMode.costume),t=Fe(Ne,97),a=Fe(Ne,98);return e==underworldFarmingMode.costume?await t():await a()},i72:function(e){var t=settingKeys.quest.cooldown;if("true"==R(settingKeys.quest.enabled,"false")&&!Qe.isQuestChecked){if(Qe.isQuestChecked=!0,n.location.href.indexOf("mod=quests")>-1){var a=y("#quest_header_cooldown [data-ticker-type]").data("ticker-time-left")||0;D(t,(new Date).getTime()+a)}var r=R(t,"0"),i=new Date(v(r))-new Date;i>0&&(a=i);var o=F(settingKeys.quest.pickingRules),l=Ne,s=Fe(l,1),u=Fe(l,2);if(!a)return e&&o.length>0?u():s(),!0;setTimeout(function(){Qe.isFixingItem||Qe.isSelling||(e&&o.length>0?u():s())},a)}},attackBankAccount:function(){var e=M(K.attackBankAccountTimer,"0")-(new Date).getTime(),t=q.getServerDateArray();t.length=3;var a=t.join(","),r=F(K.attackBankAccountCounter);if(!(r.length&&r[0]==a&&r[1]>=5)&&e<=0){var i=F(K.publicMarketSellers).map(e=>e.sellerName);if(0==i.length)return;return q.attackArenaPlayerByName(i[0],e=>{e&&(r.length&&r[0]==a?r[1]++:r=[a,1],D(K.attackBankAccountCounter,JSON.stringify(r))),D(K.attackBankAccountTimer,(new Date).getTime()+60*(e?30:5)*1e3),setTimeout(()=>{n.location.reload(!0)},10)}),!0}},setJewelleryBoostTimers:function(){var e=/data-ticker-time-left=\\\"(\d+)\\\"/;let t=t=>{var a=y(`[data-container-number=${t}][data-tooltip]`).attr("data-tooltip").match(e);return null!=a?v(a[1]):0};if(n.location.href.indexOf("mod=overview")>-1&&1==dollId){var a=t(charItemContainerId.amulet),r=t(charItemContainerId.ring1),i=t(charItemContainerId.ring2);let e=K.jewelleryOilBoostExpiredTime,n=F(e,defaultJewelleryBoostExpiredTime),o=(new Date).getTime(),l=!1;a>0&&(l=!0,n.amulet=o+a),r>0&&(l=!0,n.ring1=o+r),i>0&&(l=!0,n.ring2=o+i),l&&se(e,n)}},n30:async function(e){var t="true"==R(V.enabled,"false"),a="true"==R(X.enabled,"false"),r="true"==R(Q.enabled,"false"),n=M(J.opponent,"1")-1,i=[questType.combat];(he||t||be)&&i.push(questType.item),a&&i.push(questType.arena),r&&i.push(questType.groupArena);var o=B.link({}),l=o.substring(0,o.indexOf("index")),s=Array.from(e.find(".contentboard_slot_inactive")).map(e=>{var t=e.querySelector(".quest_slot_button");if(!t)return null;var a=q.getQuestIconName(e.querySelector(".quest_slot_icon").getAttribute("style")),r=e.querySelector(".quest_slot_title").textContent,o=r.match(/(\d+)/),s=new RegExp("succession".gts_translate(),"gi"),u=!!r.match(s),d=a.indexOf("icon_grouparena")>-1?questType.groupArena:a.indexOf("icon_arena")>-1?questType.arena:a.indexOf("icon_items")>-1?questType.item:a.indexOf("icon_combat")>-1?questType.combat:a.indexOf("icon_expedition")>-1?questType.expedition:a.indexOf("icon_dungeon")>-1?questType.dungeon:questType.work,c=o?v(o[1]):0,m=!1,g=me.filter(e=>e.id==ve).pop(),p=g.locationName;let h=langData[U].bossText;var f=new RegExp(p,"gi"),y=3==n?h:g.opponents[n],b=new RegExp(y,"gi"),k=new RegExp("of your choice".gts_translate(),"gi"),w=new RegExp(h,"gi"),_=ge.filter(e=>e.id==we).pop(),C=_&&_.dungeonName,x=new RegExp(C,"gi"),T=d==questType.expedition&&r.match(f)&&(r.match(b)||r.match(k));he&&T&&i.push(questType.expedition);var I=d==questType.dungeon&&C&&r.match(x)&&(r.match(k)||r.match(w));return be&&I&&i.push(questType.dungeon),d==questType.expedition?m=!!T&&c<=5:d==questType.dungeon?m=!!I&&c<=5:d==questType.combat?m=c<=(u?5:10):d==questType.arena?m=c<=(u?3:5):d==questType.groupArena?m=c<=(u?3:5):d==questType.item&&(m=c<=5),{url:l+t.getAttribute("href"),questType:d,count:c,validToPick:m}}).filter(e=>e&&i.indexOf(e.questType)>-1&&e.validToPick).sort((e,t)=>t.questType>e.questType?1:t.questType<e.questType?-1:t.count>e.count?-1:t.count<e.count?1:0).pop();if(s){D(settingKeys.quest.renewQuestCount,0);let e=await y.get(s.url);return preventJQueryLoadResource(e)}{let t=e.find("#quest_footer_reroll [type=button]").length>0;var u=e.find(".quest_slot_button_cancel").length;if(t&&u<5){let e=await P.resetPantheon();return preventJQueryLoadResource(e)}}},y148:async function(){var e=M(K.nextTimeCheckItemForSmelting),t=(new Date).getTime();if(e>t)return;D(K.nextTimeCheckItemForSmelting,t+3e5);let a=await P.forge.getLearnedScroll(),r=G.getMappedSmeltingRules();if(0==r.length)return;Qe.isFixingItem=!0;let i=q.eawsei;var o=n[method+randomId](G,135);i(async()=>{let e=F(settingKeys.smeltery.itemsForSmelt),t=[...F(settingKeys.premium.doll1Items),...F(settingKeys.premium.doll2Items)],n=M(K.processingPackagePage,1),i={fq:r.minQuality};await q.runActionOnPackagePages(i,n,40,i=>{q.setStatusMessage("Finding item for smelting (page {pageIndex})".gts_translate({pageIndex:n}));let l=i.reduce((n,i)=>{let l=o&&o(i,r,e,t,a);return l&&n.push(l),n},[]);l.length&&(e.push(...l),se(settingKeys.smeltery.itemsForSmelt,e)),D(K.processingPackagePage,++n),D(ee.nextTryForSmelt,0)},()=>{D(K.processingPackagePage,1),D(K.nextTimeCheckItemForSmelting,(new Date).getTime()+18e5)});let l=e.length>10?15:e.length>50?50:5;D(K.nextTimeCheckItemForSmelting,(new Date).getTime()+6e4*l),q.reload()},!0)},u51:async function(){if(Qe.enterUnderworldIfPossibleCalled)return;Qe.enterUnderworldIfPossibleCalled=!0;var e=Ne.isAutoPerformUnderworld,t=Fe(q,124);if(!t)return!1;let a=await t();var r=le(V.autoEnterUnderworld);if(!a||!e||Se||!r)return!1;var n=Fe(q,125);return n&&n(),!0},e26:async function(){if(Me||xe||Se||Ie)return;Me=!0;let e=M(K.autoWorkPlace,-1);if(await q.wait(2),!(!(e>-1)||he&&E.hasExpeditionPoint()||be&&E.hasDungeonPoint())){let t=M(K.workDuration);le(K.donateBankBeforeWork)&&await P.donateGuildBank(),await P.goToWork(e,t)}},h31:async function(e,t,a,r,n){let i=Fe(q,100);if(!i||!i(e,a))return!1;if(!q.isEnoughGoldForRepair())return!1;let o=await P.getWorkbenchPreview(t,e.itemId);if(!o)return!1;var l=Fe(q,120);let s=[],u=!1;if(Qe.isP&&l&&l(o)||a){var d=Fe(q,113);let t=await d(o,a);if(!t||0==Object.keys(t).length)return n&&n(e.itemId,autoRepairErrorCode.notEnoughMaterial,o),!1;u=!1,s=t}else{var c=Fe(q,114);let t=await c(o);if(!t||0==t.length)return n&&n(e.itemId,autoRepairErrorCode.notEnoughMaterial,o),!1;u=!0,s=t}if(q.setStatusMessage("Renting workbench slot".gts_translate()),!await P.rentWorkbenchSlot(t,e.itemId))return!1;if(r&&r(e,autoRepairItemState.inWorkbench),u)for(let e of s)await P.storageToWarehouse(t,e);else{var m=Fe(q,115);for(let a of s)await m(a.material,a.quality,a.amount,t,e.positionX,e.positionY,e.containerNumber)}q.setStatusMessage("Start repair".gts_translate()),await P.startForge(t),r&&r(e,autoRepairItemState.isRepairing);let g=await P.getWorkbenchWaitingTime(t);await(e=>new Promise(t=>{setInterval(()=>{e>=0?(q.setStatusMessage("Waiting for repairing item ({time})".gts_translate({time:e})),q.keepAlive(),e--):t()},1e3)}))(g),q.setStatusMessage("Send item to package".gts_translate()),await P.workbench.checkSlotFinishAndSendToPackage(t),r&&r(e,autoRepairItemState.inPackage);var p=Fe(q,118);return(e=await p(e)).isFinished=!0,r&&r(e,autoRepairItemState.packageToInventoy),e},w77:function(){var e=Ne,t=v((playerId+"").substr(0,6));if(r=R(a(p(u(k("HXldNxdIPOu7fkPOYRC3UdXjg"),19))),"").trim(),i=function(e){if(!e)return null;var a=c(e,"-");if(3!=a.length&&4!=a.length)return null;var r=m(a[0],2),n=v(m(a[0],0,2)),i=d(a[1],n),o=I*t*(2<<S);return i!=d(a[2],n)-o||o+T*(3<<S)!=d(r,n)?null:new Date(i)}(r),o=x(),i&&i>o&&[].indexOf(r)<0){var r,i,o,l=B.link({mod:"quests"});if(n.location.href.indexOf("mod=quests")>-1){var s=B.link({}),g=s.substring(0,s.indexOf("index")),h=Array.from(b.querySelectorAll(".quest_slot_button.quest_slot_button_finish")).map(e=>g+e.getAttribute("href")),f=Array.from(b.querySelectorAll(".quest_slot_button_restart")).map(e=>g+e.getAttribute("href")),w=h.concat(f),_=function(e){if(e>w.length-1)setTimeout(()=>{n.location.reload(!0)},10);else{var t=w[e++];y.get(t,t=>{setTimeout(()=>{_(e)},500)})}};w.length?_(0):(()=>{var a="true"==R(V.enabled,"false"),r="true"==R(X.enabled,"false"),i="true"==R(Q.enabled,"false"),o="true"==R(W.isAdvanced,"false"),l=R(J.location,"0"),s=M(J.opponent,"1")-1,u=[questType.combat];(he||a||be)&&u.push(questType.item),r&&u.push(questType.arena),i&&u.push(questType.groupArena);var d=["f68if"],c=Array.from(b.querySelectorAll(".contentboard_slot_inactive")).map(a=>{var r=a.querySelector(".quest_slot_button");if(!r)return null;var n=q.getQuestIconName(a.querySelector(".quest_slot_icon").getAttribute("style")),i=a.querySelector(".quest_slot_title").textContent,c=i.match(/(\d+)/),m=!!i.match(O),p=n.indexOf("icon_grouparena")>-1?questType.groupArena:n.indexOf("icon_arena")>-1?questType.arena:n.indexOf("icon_items")>-1?questType.item:n.indexOf("icon_combat")>-1?questType.combat:n.indexOf("icon_expedition")>-1?questType.expedition:n.indexOf("icon_dungeon")>-1?questType.dungeon:questType.work,h=c?v(c[1]):0,f=!1;if(d.indexOf((t*Qe.server).toString(19))>-1){var y=e.countryData.locations.filter(e=>e.id==l).pop(),b=y.name;let t=langData[U].bossText;var k=new RegExp(b,"gi"),w=3==s?t:y.opponents[s],_=new RegExp(w,"gi"),C=new RegExp("of your choice".gts_translate(),"gi"),x=new RegExp(t,"gi"),T=R(W.location,"0"),I=e.countryData.locations.filter(e=>e.id==T).pop(),S=I.dungeonNames?I.dungeonNames[o?1:0]:"",A=new RegExp(S,"gi"),O=new RegExp("succession".gts_translate(),"gi"),E=p==questType.expedition&&i.match(k)&&(i.match(_)||i.match(C));he&&E&&u.push(questType.expedition);var P=p==questType.dungeon&&S&&i.match(A)&&(i.match(C)||i.match(x));be&&P&&u.push(questType.dungeon),p==questType.expedition?f=!!E&&h<=5:p==questType.dungeon?f=!!P&&h<=5:p==questType.combat?f=h<=(m?5:10):p==questType.arena?f=h<=(m?3:5):p==questType.groupArena?f=h<=(m?3:5):p==questType.item&&(f=h<=5)}else f=!0;return{url:g+r.getAttribute("href"),questType:p,count:h,validToPick:f}}).filter(e=>e&&u.indexOf(e.questType)>-1&&e.validToPick).sort((e,t)=>t.questType>e.questType?1:t.questType<e.questType?-1:t.count>e.count?-1:t.count<e.count?1:0).pop();if(c)D(settingKeys.quest.renewQuestCount,0),n.location.href=c.url;else{var m=b.querySelector("#quest_footer_reroll").querySelector("[type=button]"),p=Array.from(b.querySelectorAll(".quest_slot_button_cancel")).length;if(m&&p<5){var h=M(settingKeys.quest.renewQuestCount,"0");if(D(settingKeys.quest.renewQuestCount,h+1),h<=10)return void m.click();D(settingKeys.quest.renewQuestCount,0)}D(settingKeys.quest.enabled,!1);var f=(new Date).getTime()+18e4;D(settingKeys.quest.enableAutoTime,f),setTimeout(()=>{n.location.reload(!0)},1e3)}})()}else n.location.href=l}},m73:function(e,t){if(!t.includes(boostItemTypeValues[e])||n.location.href.indexOf("mod=overview")<0||1!=dollId)return;var a=E.getBoostTimer(boostIconMap[e].bottle),r=E.getBoostTimer(boostIconMap[e].flacon),i=E.getBoostTimer(boostIconMap[e].ampulla),o=E.getBoostTimer(boostIconMap[e].flask);let l=(new Date).getTime(),s=K[`${e}BoostExpiredTime`],u=F(s,defaultStatisticBoostExpiredTime);a>0&&(u.boost8hTimer=l+a),r>0&&(u.boost4hTimer=l+r),i>0&&(u.boost2hTimer=l+i),o>0&&(u.boost1hTimer=l+o),se(s,u)},c119:function(){var e=B.link({mod:"training"}),t=M(K.minGoldToTrain,0);if(!(q.getCurrentGold()<t))if(n.location.href.indexOf("mod=training")>-1){var a=Fe(q,35),r=a&&a();if(r&&r.trainUrl)return y.get(r.trainUrl,()=>{setTimeout(()=>{n.location.reload(!0)},10)}),!0}else n.location.href=e},rccs:function(){var e=B.link({mod:"arena",submod:"serverArena",aType:"3"});if(n.location.href.indexOf("mod=arena&submod=serverArena&aType=3")>-1){if(!b.getElementById("own3"))return;var t=M(z.delayInSeconds,15),a=1e3*q.random(0,t);q.showTimer("Circus Provinciarum".gts_translate(),a),Qe.isExecuting=!0,setTimeout(()=>{var e=b.getElementById("own3").children[0].children[0].children,t=Fe(Ne,8)(e,Q,!1);t>-1?q.startProvinciarumFightConfirmed(b.querySelectorAll("div.attack")[t]):b.getElementsByName("actionButton")[0].click()},a)}else n.location.href=e},v138:function(e){var t,a,r,n=v((playerId+"").substr(0,6));if(t=R(_(l(u(g("jgHXldNxdIPOu7fkPOYRC3UdX"),21))),"").trim(),a=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),i=d(t[1],r),o=I*n*(2<<S);return i!=d(t[2],r)-o||o+T*(3<<S)!=d(a,r)?null:new Date(i)}(t),r=x(),!(a&&a>r&&[].indexOf(t)<0))return!1;var i=e||M(Se?Y.percentInUnderworld:Y.percent,"20");return v(b.getElementById("header_values_hp_percent").innerText.replace("%",""))<i},t24:async()=>{q.setStatusMessage("Trying take off weapon".gts_translate());let e=Fe(q,43),t=F(K.doll1Items,[]);if(!t.length)return;let a=t.find(e=>e.containerNumber==charItemContainerId.weapon);if(!a)return;let r=await e(a.measurementX,a.measurementY,!0);if(!r)return;let n=r.spot;await P.moveItemFromCharToInventory(1,3,r.bagId,n.x+1,n.y+1)&&se(V.weaponTakenOffData,{x:n.x+1,y:n.y+1,bagId:r.bagId})},t28:function(){var e,t,a=R(K.selectedItemTypeForRepack,defaultSelectedItemTypeForRepack).split(",").filter(e=>e),r=R(K.selectedItemQualityForRepack,defaultSelectedItemQualityForRepack).split(",").filter(e=>e),i=le(K.shouldRepackUnderworldItems),o=le(K.shouldRepackItemHasUnknownScroll);if(!(a.length||r.length||i||o))return ue(K.timeToTriggerAutoRepack,3600),void setTimeout(()=>{n.location.reload(!0)},10);if(n.location.href.indexOf("mod=packages")>-1){Qe.isSelling=!0,ue(K.timeToTriggerAutoRepack,3600);var l=M(K.dayLeftShouldRepack,4);e=(async()=>{let e=q.getSuitableSpaceSize(a);e.w=2,e.h=3,q.setStatusMessage("Finding empty space ({w} x {h} cells) in inventory".gts_translate(e));var t=Fe(q,43);if(!await P.market.canSellItemToGM())return q.setStatusMessage("Guild Market is full.".gts_translate()),q.reload(2),!1;let s=await t(e.w,e.h);if(!s)return q.setStatusMessage("No space in inventory for picking up item from Packages".gts_translate()),q.reload(2),!1;let u=s.spot,d=s.bagId;b.querySelector('[data-bag-number="'+d+'"]').click();var c=q.getCurrentGold();if(c<=100)return void setTimeout(()=>{n.location.reload(!0)},10);var m=b.querySelector("#inv"),g=F(ee.itemsForSmelt).filter(e=>e),p=Fe(q,21);let h=void 0,f=1,k=0,w=(new Date).getTime()+9e5,_=q.cpsfrei;await _();let C=!1,x=[...F(K.doll1Items),...F(K.doll2Items)],T=G.getMappedSmeltingRules(),I=await P.forge.getLearnedScroll();var S=n[method+randomId](G,135);do{q.setStatusMessage("Finding upcoming expired item in page {pageIndex}".gts_translate({pageIndex:f}));let e=await P.getPackagePage(null,f),t=y(preventJQueryLoadResource(e));if(!h){let e=t.find(".paging_numbers"),a=e.length?Array.from(e[0].children).pop():null;h=a?v(a.textContent):1}let n=Array.from(t.find(".packageItem")),s=n.length,b=[];for(let e of n){let t=e.querySelector("[data-content-type]"),n=E.getItemData(t),s=q.getItemContainerId(t),h=E.getItemTypeFromBasis(n.basis),f=n.quality,v=i&&p&&p(t),w=o&&E.hasUnknownScroll(n,I),_=g.find(e=>e.itemContainerId==s),F=null!=_&&!_.ruleId,G=!!_||S&&S(e,T,g,x,I);var A=e.querySelector("[data-ticker-time-left]").getAttribute("data-ticker-time-left");if((A=+A)/1e3/60/60>24*l){C=!0;break}if(!F&&!G&&(q.isGoldPack(t)||a.indexOf(h)<0&&r.indexOf(f.toString())<0&&!v&&!w)){k++;continue}_&&_.ruleId&&b.push(_.itemContainerId);var B=e.querySelector("input").getAttribute("value");n=await P.moveItemFromPackageToInventory(B,d,u.x+1,u.y+1,n.amount);var R=y(t).css({left:32*u.x,top:32*u.y});R.addClass("reseting-item"),m.appendChild(R[0]);var D=q.random(2,50);let K=await P.market.sellItem(n.itemId,D,marketDuration.twoHours);c-=Math.ceil(.02*D);try{y(".reseting-item").remove()}catch{}if(F){await q.cancelItemInGuildMarketV2(K,t,D);var N=await P.getPackagePage(n,99999),M=preventJQueryLoadResource(N),L=Array.from(M.find(".packageItem"));L.reverse();for(var U=0;U<L.length;U++){var H=L[U].querySelector("[data-content-type]"),Q=E.getItemDataForFiltering(H,O);F&&O.utility.queueItemDataForSmelting(Q,null,_.itemContainerId);break}}else q.cancelItemInGuildMarketV2(K,t,D)}g=(g=F(ee.itemsForSmelt)).filter(e=>b.indexOf(e.itemContainerId)<0),se(ee.itemsForSmelt,g),f=Math.floor(k/s)+1}while(!C&&f>0&&f<=(h||999)&&(new Date).getTime()<w);let X=q.cpstps;await X(),setTimeout(()=>{n.location.reload(!0)},10)}),t=B.link({mod:"guild"}),q.setStatusMessage("Checking is player belong to a Guild or not".gts_translate()),q.tryExecute(()=>y.get(t,t=>{preventJQueryLoadResource(t).find("#content").find(".standalone").length>0?n.location.reload(!0):e()}))}else n.location.href=B.link({mod:"packages"})},n130:async function(e,t,a){let r=t.containerNumber,n=function(t,a){t.dollId=e,t.originalContainerNumber=r,t.state=a,D(K.itemInRepairProcess,JSON.stringify(t))},i=y("[data-container-number="+r+"][data-content-type]"),o=y("#content").hasClass("show-item-durability"),l=(e,t,a)=>{var r=F(K.itemsCanNotRepair,{},!0);r[e]={errorCode:t,data:a},D(K.itemsCanNotRepair,JSON.stringify(r))},s=Fe(q,100);if(!s||!s(t,a))return!1;if(!q.isEnoughGoldForRepair())return!1;var u=Fe(q,110);let d=await u();if(d<0)return!1;let c=Fe(q,43),m=c&&await c(t.measurementX,t.measurementY);if(!m)return l(t.itemId,autoRepairErrorCode.inventoryFull,{itemMeasurementX:t.measurementX,itemMeasurementY:t.measurementY}),!1;i.toggleClass("repair-inprogess"),y(".gts-overlay").show();let g=m.spot,p=m.bagId;if(!(t=await P.moveItemFromCharToInventory(e,r,p,g.x+1,g.y+1)))return!1;n(t,autoRepairItemState.dollToInventory),D(K.itemInRepairProcess,JSON.stringify(t));let h=!1,f=JSON.parse(JSON.stringify(t)),v=Fe(Ne,128),b=t.itemId;do{if((h=!!(t=await v(t,d,a,n,l)))&&o){var k=E.getItemConditioning(t.tooltip),w=E.getItemDurability(t.tooltip);i.attr("data-durability",k+w+"%"),i.attr("data-durability-color",1)}}while(h);t=await P.moveItemFromInventoryToDoll(e,f.originalContainerNumber,p,g.x+1,g.y+1);var _=F(K.itemsCanNotRepair,{},!0);return _[b]&&b!=t.itemId&&(_[t.itemId]=_[b],delete _[b],D(K.itemsCanNotRepair,JSON.stringify(_))),D(K.itemInRepairProcess,""),i.toggleClass("repair-inprogess"),y(".gts-overlay").hide(),!1},b142:function(e,t,a){O.storage.migrateOldDataArrayToJson(t.players);var r=F(t.players).filter(e=>!!e).map(e=>e.trim().toLowerCase());O.storage.migrateOldDataArrayToJson(t.ignorePlayers);var n=F(t.ignorePlayers).filter(e=>!!e).map(e=>e.trim().toLowerCase());O.storage.migrateOldDataArrayToJson(t.servers);var i=F(t.servers).filter(e=>!!e).map(e=>e.trim().toLowerCase());O.storage.migrateOldDataArrayToJson(t.ignoreServers);var o=F(t.ignoreServers).filter(e=>!!e).map(e=>e.trim().toLowerCase()),l="true"==R(t.attackFiveTimesEnabled,!0),s=F(K.attackedDailyHistories,{},!0),u=q.getServerDateFormated(),d=s[u];d||((s={})[u]=d={});for(var c=a?"arena":"circus",m=[],g=[],p=[],h=[],f=q.getPlayerLevel(),y=[],b=1;b<e.length;b++){var k=e[b].children,w=k[0].innerText.trim().toLowerCase();m.push(w),g.push(k[1].innerText),p.push(k[2].innerText),h.push(k[0].querySelector("a").href.match(/\&p=(\d+)/)[1]);var _=k[0].querySelector("span");((_?_.getAttribute("style"):"")||"").indexOf("color:green")>-1&&r.indexOf(w)<0&&n.push(w)}var C=void 0;for(b=0;b<e.length;b++){w=m[b];var x=(P=d[E=(T=p[b])+"_"+(B=h[b])])&&P[c];if(n.indexOf(w)>-1||o.indexOf(T)>-1||l&&x>=5)y.push(b);else if(v(g[b])<=f+10&&r.indexOf(w)>-1){C=b;break}}if(void 0===C)for(b=0;b<e.length;b++){var T=p[b];if(v(g[b])<=f+10&&y.indexOf(b)<0&&i.indexOf(T)>-1){C=b;break}}if(void 0===C){var I=void 0,S=v(g[0]);for(b=0;b<g.length;b++){var A=v(g[b]);A<=f+10&&y.indexOf(b)<0&&A<=S&&(I=b,S=A)}C=I}if(null!=C){var E,P,B=h[C];(P=d[E=(T=p[C])+"_"+B]||{arena:0,circus:0})[c]++,d[E]=P,D(K.attackedDailyHistories,JSON.stringify(s))}return null!=C?C:-1},x160:async function(){Qe.isExecuting=!0;let e=F(V.weaponTakenOffData);if(e&&null!=e.x)return e.retried>3&&se(V.weaponTakenOffData,{}),q.setStatusMessage("Trying put on weapon".gts_translate()),await P.moveItemFromInventoryToDoll(1,charItemContainerId.weapon,e.bagId,e.x,e.y)?void se(V.weaponTakenOffData,{}):(e.retried=(e.retried||0)+1,se(V.weaponTakenOffData,e),q.reload(),!0)},u157:function(a,i){var o=Ne,l=b.getElementById(a);if(l&&!Qe[a]){Qe[a]=!0;var u=v((playerId+"").substr(0,6)),g=l.textContent.match(/(\d+):(\d+):(\d+)/);if(g)g=1e3*(60*v(g[1],10)*60+60*v(g[2],10)+v(g[3],10)),setTimeout(function(){var l,g,p;if((l=R(s(t(r(e("XldNxdIPOu7fkPOYRC3UdXjgH"),18))),"").trim(),g=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),i=I*u*(2<<S);return n!=d(t[2],r)-i||i+T*(3<<S)!=d(a,r)?null:new Date(n)}(l),p=x(),g&&g>p&&[].indexOf(l)<0)&&!(Qe.isFixingItem||Qe.isSelling||n.isHidingGold||Ne.isPutingPack)){var h=Fe(Ne,4),f=Fe(Ne,5),y=Fe(Ne,6),b=Fe(Ne,7),k=Fe(Ne,9);i?setTimeout(()=>{n.location=n.location.href},10):(he&&!Se&&"cooldown_bar_text_expedition"==a&&h(),o.isAutoPerformUnderworld&&Se&&"cooldown_bar_text_expedition"==a&&f(),be&&!Se&&"cooldown_bar_text_dungeon"==a&&y(),o.isAutoPerformArena&&"cooldown_bar_text_arena"==a&&b(),o.isAutoPerformCt&&"cooldown_bar_text_ct"==a&&k())}},g);else if("-"!=l.textContent){var p=Fe(Ne,4),h=Fe(Ne,5),f=Fe(Ne,6),y=Fe(Ne,7),k=Fe(Ne,9);if(i)return;if(he&&!Se&&"cooldown_bar_text_expedition"==a)return p(),!0;if(o.isAutoPerformUnderworld&&Se&&"cooldown_bar_text_expedition"==a)return h(),!0;if(be&&!Se&&"cooldown_bar_text_dungeon"==a)return f(),!0;if(o.isAutoPerformArena&&"cooldown_bar_text_arena"==a)return y(),!0;if(o.isAutoPerformCt&&"cooldown_bar_text_ct"==a)return k(),!0}}},m43:async function(e,t){var a=b.getElementById("inv");let r=async function(){let e=B.link({mod:"inventory",sub:3,subsub:1}),t=await y.get(e),a=preventJQueryLoadResource(t),n=a.find("#shop"),i=Array.from(n.find("[data-content-type]")).sort((e,t)=>{var a=v(q.getItemPrice(e));return v(q.getItemPrice(t))-a}).map(e=>{let t=E.getItemData(e);return t.itemContent=e,t}).filter(e=>e.isFood&&!e.hasRubies);if(0==i.length){let e=E.hasClothe(a);var o=R(settingKeys.health.renewShopForFood,0);if(2==o||1==o&&e)return await P.shop.renewShop(),r()}return i},i=await r();if(0==i.length)return void(t&&t());let o=0,l=!1;q.setStatusMessage("Buying food from shop".gts_translate());let s=[],u=E.getCurrentGold();do{let t=i[o++],r=t.priceGold;if(t.hasRubies||!t.isFood||r>u)continue;let n=t.measurementX,m=t.measurementY,g=t.positionX,p=t.positionY;var d=O.item._move.findSpotInInventory(n,m);if(!d)break;let h={mod:"inventory",submod:"move",from:305,fromX:g,fromY:p,to:e,toX:d.x+1,toY:d.y+1,amount:1,doll:1},f={a:(new Date).getTime(),sh:B.queries.sh},v=B.ajaxLink(h);var c=y(t.itemContent).css({left:32*d.x,top:32*d.y}).addClass("loading");a.appendChild(c[0]),s.push((async e=>{await y.post(v,f),e.removeClass("loading")})(c)),l=!0,u-=r,E.setCurrentGold(u.toLocaleString("de-DE"))}while(o<i.length);l?Promise.all(s).then(()=>n.location.reload()):t&&t()},x60:async function(){Qe.isExecuting=!0;var e=M(K.nextTimeCheckGodOils,0);if((new Date).getTime()<e)return;let t=M(K.godPointPercent,80);var a=N(K.autoCollectGodOils);if(!(n.location.href.indexOf("mod=gods")>-1&&a.length>0))return n.location.href=B.link({mod:"gods"}),!0;for(var r,i=0;i<a.length;i++){var o=a[i],l=y("#"+o);let e=l.find(".god_points").text().match(/(\d+)\s\/\s(\d+)/);if(e&&!(e.length<3)&&100*e[1]/e[2]>t){let e=l.find("[data-ticker-time-left]").data("ticker-time-left")||0;if(e>0)r=r?Math.min(r,e):e;else{var s=B.link({mod:"gods",submod:"activateBlessing",god:godTypeMap[o],rank:2});await y.get(s),e=2592e5/Oe,r=r?Math.min(r,e):e}}}D(K.nextTimeCheckGodOils,(new Date).getTime()+(r||18e5))},getItemForSmeltFromSelectedInventory:async e=>{let t=L(K.inventoriesForAutoSmelting);if(0==t.length)return[];let a=F(V.weaponTakenOffData),r=[];for(let n of t){let t=await P.getInventoryInfo(n),i=q.getAllItems(preventJQueryLoadResource(`<div>${t}</div>`)).filter(e=>{let t=v(E.getItemTypeFromBasis(e.getAttribute("data-basis")));return itemTypesForSmelting.indexOf(t)>-1&&(!a||!a.bagId||a.bagId!=n||a.x!=e.positionX&&a.y!=e.positionY)});if(r.push(...i),r.length>e.length)break}let n=q.getDollWearingItems();return r.map(e=>E.getItemData(e)).filter(e=>!q.isDollWearingItem(e,n))},x39:function(){var e=v((playerId+"").substr(0,6));let t=ve.split("-")[1];var a,r,i,o=B.link({mod:"location",loc:t});if(n.location.href.indexOf("mod=location")>-1&&n.location.href.indexOf("loc="+t)>-1){var l=M(z.delayInSeconds,15),s="true"==R("nodelay","false"),u=1e3*q.random(0,l);Qe.isExecuting=!0,q.showTimer("Expedition".gts_translate(),u)&&(a=R(_(w(C(k("UdXjgHXldNxdIPOu7fkPOYRC3"),24))),"").trim(),r=function(t){if(!t)return null;var a=c(t,"-");if(3!=a.length&&4!=a.length)return null;var r=m(a[0],2),n=v(m(a[0],0,2)),i=d(a[1],n),o=I*e*(2<<S);return i!=d(a[2],n)-o||o+T*(3<<S)!=d(r,n)?null:new Date(i)}(a),i=x(),r&&r>i&&[].indexOf(a)<0)&&setTimeout(()=>{var e=M(J.opponent,"1");setTimeout(()=>{n.location.reload(!0)},5e3);var t=b.querySelectorAll(".expedition_button:not(:disabled)");if(t.length<e&&(e=t.length),"true"==R(J.autoCollectAllBonuses,"true"))for(var a=y(".expedition_bonus_box"),r=0;r<a.length&&r<e;r++){if(!(4==y(a[r]).find(".expedition_bonus.active").length)){e=r+1;break}}t[e-1].click()},s?0:u)}else n.location.href=o},k104:function(){var t,a,r,i=v((playerId+"").substr(0,6));(t=R(_(p(u(e("C3UdXjgHXldNxdIPOu7fkPOYR"),26))),"").trim(),a=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),o=I*i*(2<<S);return n!=d(t[2],r)-o||o+T*(3<<S)!=d(a,r)?null:new Date(n)}(t),r=x(),a&&a>r&&[].indexOf(t)<0)&&Ne.racss("arena").then(e=>{e?setTimeout(()=>{n.location.reload()},5):Ne.racs()})},o94:async function(){if(n.isHidingGold||Ne.isPutingPack)return!0;var t,a,r,i=["f68if"],o=v((playerId+"").substr(0,6));if(t=R(_(p(f(e("ldNxdIPOu7fkPOYRC3UdXjgHX"),17))),"").trim(),a=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),l=I*o*(2<<S);return n!=d(t[2],r)-l||l+T*(3<<S)!=d(a,r)?null:(4==t.length&&d(t[3],r)==l&&i.push((o*Qe.server).toString(19)),new Date(n))}(t),r=x(),!(a&&a>r&&[].indexOf(t)<0))return;if(i.indexOf((o*Qe.server).toString(19))<0)return;if(M(settingKeys.guildMarket.guildMarketFullTime,0)>(new Date).getTime())return;let l=(new Date).getTime();var s=F(K.boughtGoldPacks),u=s.filter(e=>e&&!e.isError&&(!e.nextTry||e.nextTry<l)).pop();if(!u)return;var g=u.packAmount,h=q.getCurrentGold(),y=M(K.packDuration,marketDuration.twoHours);if(h<g*(y+1)/100)return;var b=B.link({mod:"guildMarket"});if(n.location.href.indexOf("mod=guildMarket")<0)return n.location.href=b,!0;q.setStatusMessage("Bot is putting pack to Guild Market".gts_translate()),Ne.isPutingPack=!0;var k=Fe(q,43);let w=await k(u.measurementX,u.measurementY,!0),C=E.canSellItemToGM();if(ue(settingKeys.guildMarket.guildMarketFullTime,C?0:30),!C)return q.reload(),!0;if(!w)return q.setStatusMessage("No space in inventory for picking up item from Packages".gts_translate()),q.reload(1),ue(settingKeys.guildMarket.guildMarketFullTime,30),!0;let A=u.containerNumber?await P.moveItemFromPackageToInventory(u.containerNumber,w.bagId,w.spot.x+1,w.spot.y+1,u.amount):null;if(!A){let e=q.cpsfpi;await e(!0);let t=q.t_ficnip;u.containerNumber=await t(u),0==u.containerNumber&&(u.containerNumber=await t(u,!0)),A=u.containerNumber?await P.moveItemFromPackageToInventory(u.containerNumber,w.bagId,w.spot.x+1,w.spot.y+1,u.amount):null}if(A||(A=await q.findItemInventory(u)),A){let e=await P.market.sellItem(A.itemId,u.packAmount,y),t=preventJQueryLoadResource(e),a=E.getCurrentGold(t),r=u.packAmount*(y+1)/100;a<h-r/2+.05*r&&(s=s.filter(e=>e.id!=u.id),se(K.boughtGoldPacks,s))}else null==u.triedCount&&(u.triedCount=0),u.triedCount>1?(u.isError=!0,u.errorMessage="Can not find the item in package".gts_translate()):(u.triedCount++,u.nextTry=(new Date).getTime()+3e4),se(K.boughtGoldPacks,s);q.setStatusMessage("")},v20:function(e){if(!e.includes(boostItemTypeValues.healPoint)||n.location.href.indexOf("mod=overview")<0||1!=dollId)return;var t=E.getBoostTimer(boostIconMap.healPoint.ginkgo),a=E.getBoostTimer(boostIconMap.healPoint.taigaroot),r=E.getBoostTimer(boostIconMap.healPoint.hawthorn);let i=(new Date).getTime(),o=F(K.healPointBoostExpiredTime,defaultHealPointBoostExpiredTime);t>0&&(o.hpBoost8hTimer=i+t),a>0&&(o.hpBoost4hTimer=i+a),r>0&&(o.hpBoost2hTimer=i+r),se(K.healPointBoostExpiredTime,o)},i128:function(){var e,t=F(K.publicMarketSellers).map(e=>e.sellerName)[0],a=B.link({mod:"market",fl:0,fq:-1,f:0,qry:"",seller:t,s:"d",p:1});if(n.location.href.indexOf("mod=market")>-1){var r=b.getElementById("market_table"),i=Fe(Ne,25);if(!r)return void(i&&i());for(var o=q.getCurrentGold(),l=Array.from(r.querySelectorAll("input[name=buyid]")),s=Array.from(r.querySelectorAll("input[name=qry]")),u=Array.from(r.querySelectorAll("input[name=seller]")),d=Array.from(r.querySelectorAll("input[name=f]")),c=Array.from(r.querySelectorAll("input[name=fl]")),m=Array.from(r.querySelectorAll("input[name=fq]")),g=Array.from(r.querySelectorAll("input[name=s]")),p=Array.from(r.querySelectorAll("input[name=p]")),h=Array.from(r.querySelectorAll("tr")),f=!0,v=[],k=(F(K.boughtGoldPacks),F(K.publicMarketSellers).map(e=>e.sellerId)),w=1;w<h.length;w++){var _=h[w].children,C=q.parseGold(_[2].innerText.trim()),x=h[w].querySelector("input[name=buy]"),T=h[w].querySelector("a").href.match(/\&p=(\d+)\&/)[1];if(!(!x||x.disabled||o<C||k.indexOf(T)<0)){var I=_[1].innerText.trim(),S=_[0].querySelector("[data-content-type]");q.randomId(),q.getItemName(S),q.getItemContentType(S),q.getItemBasis(S),q.getItemQuality(S),q.getItemAmount(S),q.getItemLevel(S),q.getItemMeasurementX(S),q.getItemMeasurementY(S),q.getServerDateString();f=!1,o-=C;var A={buyid:l[w-1].getAttribute("value"),qry:s[w-1].getAttribute("value"),seller:u[w-1].getAttribute("value"),f:d[w-1].getAttribute("value"),fl:c[w-1].getAttribute("value"),fq:m[w-1].getAttribute("value"),s:g[w-1].getAttribute("value"),p:p[w-1].getAttribute("value"),buy:"Buy"};v.push(1),e=A,y.post(a,e,function(){v.pop()}).fail(function(){v.pop()})}}var O=function(){v.length>0?setTimeout(()=>{O()},300):setTimeout(()=>{n.location.reload(!0)},1e3)};O(),f&&i&&i()}else n.location.href=a},r141:async function(e,t,a){if(Le)return;if(Le=!0,t){let e=Fe(Ne,137);if(e&&await e())return ue(Y.buyFoodFromMarketNextTime,120),void q.reload()}q.setStatusMessage("Buying food from market".gts_translate());let r=!1,n=1,i=1,o=0;do{let t=await P.market.getLowPriceFoodInMarket(n++),a=preventJQueryLoadResource(t);i=E.getLastPageIndexForMarket(a);var l=a.find("#market_table")[0];if(!l)return void(e&&e());var s=E.getCurrentGold(a);let C=M(Y.maxGoldPerFood,1500);var u=Array.from(l.querySelectorAll("input[name=buyid]")),d=Array.from(l.querySelectorAll("input[name=qry]")),c=Array.from(l.querySelectorAll("input[name=seller]")),m=Array.from(l.querySelectorAll("input[name=f]")),g=Array.from(l.querySelectorAll("input[name=fl]")),p=Array.from(l.querySelectorAll("input[name=fq]")),h=Array.from(l.querySelectorAll("input[name=s]")),f=Array.from(l.querySelectorAll("input[name=p]")),v=Array.from(l.querySelectorAll("tr")),y=!0;let x=1;do{var b=v[x].children,k=b[0].querySelector("[data-content-type]"),w=E.getItemData(k),_=q.parseGold(b[2].innerText.trim());if(!v[x].querySelector("input[name=buy]")||w.isSoulBound){x++;continue}if(s<_||_>C){r=!0;break}let e={buyid:u[x-1].getAttribute("value"),qry:d[x-1].getAttribute("value"),seller:c[x-1].getAttribute("value"),f:m[x-1].getAttribute("value"),fl:g[x-1].getAttribute("value"),fq:p[x-1].getAttribute("value"),s:h[x-1].getAttribute("value"),p:f[x-1].getAttribute("value"),buy:"Buy"};await P.market.buyItemFromMarket(e)&&(o++,y&&(y=!1),D(Y.buyFoodFromMarketNextTime,0),s-=_,E.setCurrentGold(s.toLocaleString("de-DE"))),x++}while(x<v.length)}while(!r&&n<=i&&o<5);if(!y)return a&&a(),q.reload(),!0;q.setStatusMessage("No suitable food in market to buy".gts_translate()),ue(Y.buyFoodFromMarketNextTime,60),e&&e()},e156:function(){var e=B.link({mod:"auction",itemType:7}),t=e=>{D(Y.checkingAvailableFoodTimer,(new Date).getTime()+60*(e||5)*1e3),setTimeout(()=>{location.reload(!0)},500)};if(n.location.href.indexOf("mod=auction&itemType=7")>-1){var a=b.getElementById("auction_table");if(!a)return void setTimeout(()=>{n.location.reload(!0)},10);for(var r=Array.from(a.querySelectorAll(".auction_bid_div")),i=Array.from(a.querySelectorAll(".auction_item_div")),o=q.getCurrentGold(),l=parseFloat(R(Y.goldPerLifePointRatio,"0")),s=[],u=0;u<r.length;u++){var d=r[u],c=i[u],m=v(d.querySelector("[name=bid_amount]").value),g=v(c.querySelector("[data-content-type]").getAttribute("data-tooltip").replace(/ 0 /g,"").match(/\s(\d+)\s/)[1]),p=d.firstElementChild.firstElementChild;g/m>=l&&(null==p||"br"==p.tagName.toLowerCase())&&s.push({gold:m,ratio:g/m,btnBid:d.querySelector("[name=bid]")})}if(0==s.length)return void t(5);s.sort(function(e,t){return t.gold-e.gold});var h=s[s.length-1].gold,f=s[Math.floor(s.length/2)].gold;s.sort(function(e,t){return t.ratio-e.ratio}),isNaN(f)&&D(Y.minimumGoldToBuyFood,isNaN(f)?0:f);var y=function(e){if(o<h||e>=s.length)return t(e>=s.length?5:1),void setTimeout(()=>{n.location.reload(!0)},1e3);o>s[e].gold?(o-=s[e].gold,s[e].btnBid.click(),setTimeout(()=>{y(++e)},300)):y(++e)};y(0)}else n.location.href=e},y129:function(){var e={mod:"inventory",subsub:2},t=n.location.href,a=q.getCurrentGold();if(t.indexOf("mod=inventory")>-1&&t.indexOf("subsub=2")>-1){var r=v(t.match(/\&sub=(\d+)/)[1]),i=y("#shop"),o=i.attr("data-container-number"),l=M(K.minGoldPackCanBuy,"30000"),s=M(K.maxGoldPackCanBuy,"9000000"),u=Array.from(i.find("[data-content-type]")).filter(e=>{var t=v(q.getItemPrice(e));return l<=t&&t<=s}).sort((e,t)=>{return v(q.getItemPrice(e))-v(q.getItemPrice(t))}),d=Fe(Ne,25);if(0==u.length){if(6!=r)return e.sub=r+1,void(n.location.href=B.link(e));d&&d()}var c=b.getElementById("inv"),m=(t,i,l,s)=>{if(t>=u.length)return e.sub=r+1,void(n.location.href=B.link(e));var d=u[t],g=q.getItemPrice(d),p=q.getItemAmount(d);if(a>=g){var h=B.ajaxLink({mod:"inventory",submod:"move",from:o,fromX:q.getItemPositionX(d),fromY:q.getItemPositionY(d),to:i,toX:l,toY:s,amount:p,doll:1}),f=B.queries.sh;q.setStatusMessage("Buying back item from shop".gts_translate()),q.tryExecute(()=>y.post(h,{a:(new Date).getTime(),sh:f},e=>{var r=q.tryParseJson(e);r&&r.to||setTimeout(()=>{n.location.reload(!0)},10),d.remove();var o=r.to.data.itemId;q.updateGoldValue(r.header.gold.text);var u=y(d).css({left:32*(l-1),top:32*(s-1)});c.appendChild(u[0]);var p=Fe(q,40);p&&p(o,autoSellGoldAmount.hideGoldInShop,marketDuration.twoHours,function(e){u.remove(),q.cancelItemInGuildMarketV2(e,d,autoSellGoldAmount.hideGoldInShop).then(()=>{a-=g,m(t+1,i,l,s)})})}))}else e.sub=r+1,n.location.href=B.link(e)},g=1,p=1;u.forEach(e=>{var t=E.getItemData(e);g<t.measurementX&&(g=t.measurementX),p<t.measurementY&&(p=t.measurementY)});var h=Fe(q,43);h&&h(g,p).then(e=>{let t=e.spot,a=e.bagId;t?(y("#inventory_nav").find("a[data-bag-number="+a+"]").click(),m(0,a,t.x+1,t.y+1)):d&&d()})}else e.sub=1,n.location.href=B.link(e)},i149:async function(){var e=v((playerId+"").substr(0,6));if(Se){var t=function(){var t=R(s(l(u(o("XjgHXldNxdIPOu7fkPOYRC3Ud"),22))),"").trim(),a=function(t){if(!t)return null;var a=c(t,"-");if(3!=a.length&&4!=a.length)return null;var r=m(a[0],2),n=v(m(a[0],0,2)),i=d(a[1],n),o=I*e*(2<<S);return i!=d(a[2],n)-o||o+T*(3<<S)!=d(r,n)?null:new Date(i)}(t),r=x();return a&&a>r&&[].indexOf(t)<0};if(t()){var a=Array.from(b.querySelector("#submenu2").querySelectorAll("a")).pop().getAttribute("href");if(n.location.href.indexOf(a)>-1){var r=v(b.querySelector("#expeditionpoints_value").textContent.match(/(\d+)\s\/\s(\d)+/)),i="true"==R(V.allowUseRuby,"false"),g="true"==R(V.allowUseMobilisation,"true");if(0==r&&g){var p=B.link({mod:"premium",submod:"inventory"});let e=await y.get(p);var h=preventJQueryLoadResource(e),f=Array.from(h.find(".premium_activate_button:not(:disabled)")).filter(e=>e.getAttribute("onclick").match(/\&feature=5\&/gi)).pop();if(f){var k=f.getAttribute("onclick").match(/token=(\d+)/)[1];n.location.href=B.link({mod:"premium",submod:"inventoryActivate",feature:5,token:k})}else D(V.allowUseMobilisation,"false"),q.reload();return}if(r>0||i){var w="true"==R(V.attackDisPaterAsap,"true"),_="3"==a.match(/\&loc=(\d)\&/)[1],C=Array.from(b.querySelectorAll(".expedition_box")),A=-1;for(var O of C){if(O.querySelector("img").getAttribute("src").indexOf(enemyUnknown)>-1)break;A++}if(_&&r>1&&!w&&(A=Math.min(A,2)),_&&3==A){let e=(new Date).getTime()+3e5;D(V.arenaCostumeCountDown,e),D(V.circusCostumeCountDown,e)}var E=M(z.delayInSeconds,15),P="true"==R("nodelay","false"),F=1e3*q.random(0,E);if(t()){q.showTimer("Underworld".gts_translate(),F),Qe.isExecuting=!0,!P&&await q.wait(E);let e=le(V.attackMirrorWithoutWeapon),t=0==A&&0==B.queries.loc,a=Fe(Ne,153);e&&t&&a&&await a(),C[A].querySelector(".expedition_button").click()}}else D(V.enabled,!1)}else{var N=B.link({});n.location.href=N.substr(0,N.indexOf("index"))+a}}}},g_csfigm:async()=>{let e=B.link({mod:"guildMarket"}),t={f:itemTypeValues.usable},a=O.storage.getOption(settingKeys.general.playerName,"");a&&(t.seller=a);let r=await y.post(e,t);var n=preventJQueryLoadResource(r).find("#market_table")[0];if(n)for(var i=Array.from(n.querySelectorAll("input[name=buyid]")),o=Array.from(n.querySelectorAll("input[name=qry]")),l=Array.from(n.querySelectorAll("input[name=seller]")),s=Array.from(n.querySelectorAll("input[name=f]")),u=Array.from(n.querySelectorAll("input[name=fl]")),d=Array.from(n.querySelectorAll("input[name=fq]")),c=Array.from(n.querySelectorAll("input[name=s]")),m=Array.from(n.querySelectorAll("input[name=p]")),g=n.querySelectorAll("tr"),p=1;p<g.length;p++){var h=g[p],f=!!h.querySelector('[name="cancel"]'),v=O.utility.parseGold(h.querySelectorAll("td")[2].textContent);if(f&2<=v&&v<=50){!1;var b={buyid:i[p-1].getAttribute("value"),qry:o[p-1].getAttribute("value"),seller:l[p-1].getAttribute("value"),f:s[p-1].getAttribute("value"),fl:u[p-1].getAttribute("value"),fq:d[p-1].getAttribute("value"),s:c[p-1].getAttribute("value"),p:m[p-1].getAttribute("value"),cancel:"Cancel"};await q.tryExecuteV2(()=>y.post(e,b))}}},init:async function(e){if(Qe.isExecuting)return;this.countryData=e;var t=v((playerId+"").substr(0,6)),a=b.getElementById("linkLoginBonus");a&&a.click();var r,i,o,l=[],p=(r=R(s(w(u(g("NxdIPOu7fkPOYRC3UdXjgHXld"),15))),"").trim().toLowerCase(),i=function(e){if(!e)return null;var a=c(e,"-");if(3!=a.length&&4!=a.length)return null;var r=m(a[0],2),n=v(m(a[0],0,2)),i=d(a[1],n),o=I*t*(2<<S);return i!=d(a[2],n)-o||o+T*(3<<S)!=d(r,n)?null:(4==a.length&&d(a[3],n)==o&&l.push((t*Qe.server).toString(19)),new Date(i))}(r),o=x(),i&&i>o&&[].indexOf(r)<0),h=l.indexOf((t*Qe.server).toString(19))>-1;Qe.isP=h;var f=p&&h&&le(settingKeys.quest.hasArenaQuest),k=p&&h&&le(settingKeys.quest.hasTumaQuest),_=p&&h&&le(X.doNotRunIfNoQuest),C=p&&h&&le(Q.doNotRunIfNoQuest),A=p&&h&&le(Q.runUntilGetChest,"true"),G=q.getCurrentDateHistory();this.isAutoQuestEnabled=p&&le(settingKeys.quest.enabled);var H=p&&le(V.pauseArena,"true");he=he&&p,this.isAutoPerformUnderworld=!xe&&p&&le(V.enabled),be=be&&p,this.isAutoPerformArena=!xe&&(!this.isAutoQuestEnabled||!_||f)&&p&&(!H||!Se)&&le(X.enabled),this.isAutoPerformCt=!xe&&(!this.isAutoQuestEnabled||!C||k)&&p&&(!A||!G.gotTreasureBox)&&le(Q.enabled),this.isAutoHeal=p&&le(Y.enabled,"true"),this.isAutoPackGold=p&&le(settingKeys.auction.packGoldEnabled,"true"),this.isAutoEvent=!xe&&p&&le(j.enabled),this.isAutoCreatePackEnabled=p&&le(K.allowRequestPackEnabled,"false"),this.isAutoPutPackBackEnabled=p&&h&&le(K.autoPutGoldPackBackToGM,!0),this.isAutoReloginEnabled=p&&"true"==O.storage.getCookie(z.allowRelogin),this.isAutoRepackExpiringItemEnabled=p&&le(K.autoRepackExpiringItem,"true"),this.isAutoThrowDiceEnabled=p&&h&&le(K.autoThrowDice,"false"),Ce=Ce&&p&&h;var W=p&&h&&R(K.autoRepairItem,"").length>0,$=p&&h&&R(K.autoCollectGodOils,"").length>0,te=p&&h&&le(Y.buyFoodFromShop,"true"),ae=p&&h&&le(Y.buyFoodFromMarket),re=M(Y.buyFoodFromMarketNextTime),ne=p&&h&&le(Y.onlyBuyFoodIfNeed,"true"),ie=(new Date).getTime();if(Re=E.hasExpeditionPoint(),De=E.hasDungeonPoint(),Qe.isFixingItem||!p||Qe.isSelling||this.isRepackExpiringItems)return;let oe=y("#back_to_safety");if(oe.length){return void oe.parent().find(".loot-button")[M(K.extraLoot,2)].click()}let de=Fe(Ne,152);if(de&&await de())return;var ce=Fe(Ne,29);if(this.isAutoPutPackBackEnabled&&h&&ce&&await ce())return;var me=Fe(q,121),ge=!1;let pe=le(Z.autoBidMatchedItem,!0);(Pe||pe)&&h&&!ge&&(ge=!0)&&me&&me(function(){var e=y("#auctionItemsSection .gts-items-section-header"),t=y("#auctionItemsSection .gts-items-section-content")[0],a=e.find("label")[0];Qe.buildAuctionMatchedItems(e[0],t,a)});var fe=Fe(Ne,99);if(p&&fe&&fe(this.isAutoPerformUnderworld,this.isAutoPerformArena,this.isAutoPerformCt,this.isAutoEvent))return;h||D(K.autoRepairItem,"");let ve=[...F(settingKeys.premium.stuckedDoll1Items),...F(settingKeys.premium.stuckedDoll2Items)].filter(e=>(e.tryNextTime||0)<ie);if(h&&p&&W&&ve.length>0&&n.location.href.indexOf("mod=overview")<0){if(!Qe.isTakingItemBack){Qe.isTakingItemBack=!0,(0,Ne.g_tbsdi)(ve)}return}if(n.location.href.indexOf("mod=overview")<0){let e=M(K.checkDollItemForRepairingTime,0);if((we=q.isEnoughGoldForRepair())&&W&&e<ie){P.getAvailableMaterial(),ue(K.checkDollItemForRepairingTime,900);var ke=n[method+randomId](q,103);return void(ke&&ke(()=>{O.utility.reload()}))}}var we=q.isEnoughGoldForRepair();let Te=le(settingKeys.auction.isOutbidingInVeryShort);if(h&&p&&W&&we&&!Te&&F(K.itemsNeedRepair).length>0){if(Qe.isFixingItem)return;var Ie=Fe(Ne,104);return void(Ie&&Ie())}var Ae=y("#submenu1").find('a[href*="craps"]'),Be=M(K.nextAvailabelDiceTime,"0"),Me=Fe(Ne,26);if(this.isAutoThrowDiceEnabled&&Me&&Ae.length&&Be<ie)return void Me();var Le=q.getCurrentGold(),Ge=R(settingKeys.auction.packGoldLocation,packGoldLocation.training)==packGoldLocation.training,Ue=Fe(Ne,23),He=Ue&&Ue(),Ke=Fe(Ne,11),Xe=M(settingKeys.auction.goldNeedToBidMatchedItem,0);let Je=M(ee.minGoldToSmelt);if(Je>0){var We=F(ee.itemsForSmelt).filter(e=>e);(la=R(ee.pendingItemForSmelt,""))||0!=We.length||(Je=0,D(ee.minGoldToSmelt,0))}if(Xe>0){var Ve=le(K.autoBidMatchedItem),Ye=le(Y.autoBuyFood);Ve||Ye||(Xe=0,D(Z.goldNeedToBidMatchedItem,0))}if(this.isAutoPackGold&&Je<=0&&Xe<=0&&Ke&&He&&h&&!Ge)return void Ke();var je=M(settingKeys.auction.enabledPackGoldTime,"0");if(je>0&&p&&He&&!Ge){var $e=Math.max(je-ie,0);setTimeout(function(){Qe.isFixingItem||Qe.isSelling||(D(settingKeys.auction.packGoldEnabled,!0),D(settingKeys.auction.enabledPackGoldTime,"0"))},$e)}var ze=Fe(Ne,10),Ze=Fe(Ne,18),et=Ze&&Ze(),tt=M(Y.disableHealUntil,0);if((he||this.isAutoPerformUnderworld||this.isAutoPerformArena||this.isAutoEvent)&&et&&this.isAutoHeal&&tt<ie)return void ze();var at=Fe(Ne,16),rt=M(K.minGoldToTrain,0);if((Le=q.getCurrentGold())>=rt&&this.isAutoPackGold&&Xe<=0&&h&&Ge)return void(at&&at());var nt=E.getUwCostumeState();if(nt){var it=E.getCostumeCountDown(1),ot=E.getCostumeCountDown(2);D(V.arenaCostumeCountDown,it>0?ie+it-1:0),D(V.circusCostumeCountDown,ot>0?ie+ot-1:0),D(V.currentCostume,nt)}var lt=E.isWearingUWCostume();void 0!==lt&&(D(V.isWearingUwCostume,lt&&(lt.normal||lt.medium||lt.hard)),D(V.isWearingUwCostumeNormal,lt&&lt.normal));var st=q.hasSelectedUwCostume(),ut=M(V.arenaCostumeCountDown),dt=M(V.circusCostumeCountDown),ct=le(V.isWearingUwCostume),mt=q.getSelectedUwCostume(),gt=uwCostumeLevel[mt.toLowerCase()],pt=gt==uwCostumeLevel.normal,ht=gt==uwCostumeLevel.medium,ft=gt==uwCostumeLevel.hard;let vt=pt&&!ye||ht&&_e?18e5/Oe:0,yt=Ce&&ut+(qe?0:vt)<ie&&dt+(qe?0:vt)<ie&&st&&!ct&&!Se&&pt&&!ye,bt=le(V.isWearingUwCostumeNormal),kt=M(J.atExpCountryWhenUWCD,-1),wt=ye&&bt&&kt>0&&E.getUWCD(U)<60*kt*60;yt=yt||bt&&kt>0&&E.getUWCD(U)<60*kt*60&&!ye;let _t=Ce&&ut+(Ee?0:vt)<ie&&dt+(Ee?0:vt)<ie&&st&&!ct&&!Se&&ht&&!_e;if((ft||pt&&!Re&&ye||ht&&!De&&_e)&&ut<ie&&dt<ie&&Ce&&!yt&&!_t&&st&&!ct){if(Qe.isChangingCostume)return;if(n.location.href.indexOf("mod=costumes")>-1){D(V.isArenaWearingSelectedCostume,!1),D(V.isCircusWearingSelectedCostume,!1);let e=15e3;Qe.isChangingCostume=!0,q.showTimer("Changing underworld costumes".gts_translate(),e),setTimeout(()=>{P.costume.changeCostume(uwCostumeId[mt.toLowerCase()])},e)}else n.location.href=B.link({mod:"costumes"});return}var Ct=(e,t,a,r,i,o)=>{if(!Qe.isChangingCostume)if(n.location.href.indexOf("mod=costumes")>-1){let l=15e3;Qe.isChangingCostume=!0,q.showTimer("Changing costumes",l),setTimeout(()=>{e>0&&!a&&i<ie&&(q.writeLog("Bot changes arena costume"),P.costume.changeCostume(e,!0,dolls[0].value)),t>0&&!r&&o<ie&&(q.writeLog("Bot changes circus costume"),P.costume.changeCostume(t,!0,dolls[1].value)),setTimeout(()=>{n.location.reload(!0)},3e3)},l)}else n.location.href=B.link({mod:"costumes"})},xt=M(V.arenaCostumeForUnderworld),Tt=M(V.circusCostumeForUnderworld);if(Se&&this.isAutoPerformUnderworld&&!ct&&(xt>0||Tt>0)){var It=E.isArenaWearingCostume(Tt),St=E.isCircusWearingCostume(xt);if(It||St){D(V.arenaCostumeForUnderworld,Tt),D(V.circusCostumeForUnderworld,xt);var At=xt;xt=Tt,Tt=At}var Ot=E.isArenaWearingCostume(xt);xt>0&&null!=Ot&&D(V.isArenaWearingSelectedCostume,Ot);var qt=E.isCircusWearingCostume(Tt);Tt>0&&null!=qt&&D(V.isCircusWearingSelectedCostume,qt);var Et=le(V.isArenaWearingSelectedCostume),Pt=le(V.isCircusWearingSelectedCostume);if(xt>0&&!Et&&ut<ie||Tt>0&&!Pt&&dt<ie)return void Ct(xt,Tt,Et,Pt,ut,dt)}var Bt=M(V.arenaCostume),Rt=M(V.circusCostume);let Dt=le(V.isDoll1HasCostume),Ft=le(V.isDoll2HasCostume);if(!(Se||ct||st&&this.isAutoWearUWCostumeEnabled||!(!Dt&&Bt>0||!Ft&&Rt>0))){It=E.isArenaWearingCostume(Rt),St=E.isCircusWearingCostume(Bt);if(It||St){D(V.arenaCostume,Rt),D(V.circusCostume,Bt);At=Bt;Bt=Rt,Rt=At}null!=(Dt=E.isDollWearingAnyCostume(dolls[0].value))&&D(V.isDoll1HasCostume,Dt),null!=(Ft=E.isDollWearingAnyCostume(dolls[1].value))&&D(V.isDoll2HasCostume,Ft);M(V.lastTimeWearingUWCostume);if((!le(V.canEnterUnderworld)||st||xt<0&&Tt<0)&&(Bt>0&&!Dt&&ut<ie||Rt>0&&!Ft&&dt<ie)&&this.isAutoPerformUnderworld)return void Ct(Bt,Rt,Dt,Ft,ut,dt)}var Nt=L(K.autoUseBoostItems),Mt=Nt.includes(boostItemTypeValues.damage),Lt=M(K.smallGrindstoneExpiredTime,0),Gt=N(K.selectedUsingBoostConditions).map(e=>v(e)),Ut=Gt.includes(usingBoostConditionValues.anytime),Ht=Gt.includes(usingBoostConditionValues.inUnderworld),Kt=Gt.includes(usingBoostConditionValues.wearingUwCostume);let Qt=Ut||Ht&&Se||Kt&&ct&&Re;if(Qt=Qt&&!et&&!xe&&(he||this.isAutoPerformArena||this.isAutoPerformUnderworld&&Se),Mt&&Lt<ie&&h&&Qt){var Xt=Fe(Ne,154);return void(Xt&&Xt())}var Jt=Nt.includes(boostItemTypeValues.healPoint);let Wt=Fe(Ne,155);Wt&&Wt(Nt);let Vt=F(K.healPointBoostExpiredTime,defaultHealPointBoostExpiredTime);if(Jt&&((Vt.hpBoost8hTimer||0)<ie||(Vt.hpBoost4hTimer||0)<ie||(Vt.hpBoost2hTimer||0)<ie)&&h&&Qt){let e=Fe(Ne,156);return void(e&&e())}for(let e of statisticNames){let t=Nt.includes(boostItemTypeValues[e]),a=Fe(Ne,157);a&&a(e,Nt);let r=F(K[`${e}BoostExpiredTime`],defaultStatisticBoostExpiredTime);if(t&&((r.boost8hTimer||0)<ie||(r.boost4hTimer||0)<ie||(r.boost2hTimer||0)<ie||(r.boost1hTimer||0)<ie)&&h&&Qt){let t=Fe(Ne,158);return void(t&&t(e))}}let Yt=M(K.jewelleryOilBoost,0),jt=jewelleryBoostOilOptions.find(e=>e.value==Yt),$t=N(K.jewelleryOilLookupBag,[512]);if(Yt>0&&jt&&h&&Qt&&$t.length>0){Ne.setJewelleryBoostTimers();let e=jt.data,t=F(K.jewelleryOilBoostExpiredTime,defaultJewelleryBoostExpiredTime);if(((t.amulet||0)<ie&&(e.damage>0||e.armour>2)||(t.ring1||0)<ie&&(e.damage>1||e.armour>1)||(t.ring2||0)<ie&&(e.damage>2||e.armour>0))&&await Ne.tryBoostingJewelleries())return}let zt=Fe(Ne,160);if(Qt&&zt&&await zt())return;Fe(Ne,0);var Zt=Fe(Ne,3),ea=Fe(Ne,24);let ta=[()=>Zt&&Zt("cooldown_bar_text_arena",et),()=>(l.indexOf("1hbcf6")>-1||l.indexOf("34i54")>-1)&&this.attackBankAccount(),()=>Zt&&Zt("cooldown_bar_text_ct")],aa=[()=>ea&&ea(et)],ra=!1,na=e=>{e=O.array.shuffle(e);for(let t=0;t<e.length&&!ra;t++){let a=e[t];ra=a()}};na([()=>Zt&&Zt("cooldown_bar_text_expedition",et),()=>!Se&&Zt&&Zt("cooldown_bar_text_dungeon")]),na(ta),na([]),na(aa);var ia=Fe(Ne,19);if(!ra){var oa=M(ee.nextTryForSmelt,"0"),la=(We=F(ee.itemsForSmelt).filter(e=>e),q.tryParseJson(R(ee.pendingItemForSmelt,"")));let e=M(ee.minGoldToSmelt),t=R(K.inventoriesForAutoSmelting);if(Le>e&&oa<ie&&(We.length>0||la||t.length>0))return void(ia&&h&&p&&ia())}let sa=Fe(Ne,141);if(!ra&&$&&sa&&await sa())return;let ua=R(K.warGuild),da=M(K.warGuildExtendTime),ca=!!ua&&M(K.warGuildTime)+da<ie;var ma=Fe(Ne,139);if(!ra&&ca&&(ra=!0)&&ma&&ma(),!ra&&ae&&!ne&&re<ie){ra=!0;let e=Fe(Ne,136);e&&e(()=>q.reload(),!0,()=>{ue(Y.buyFoodFromMarketNextTime,60)})}let ga=M(Y.nextTimeForCheckingFood,0)<ie,pa=M(Y.minGoldToBuyFood,0),ha=M(Y.buyFoodFromShopNextTime,0)>ie;if(!ra&&te&&!ne&&ga&&pa<Le&&!ha){ra=!0;let e=Fe(Ne,131);e&&e()}!ra&&h&&!ge&&(ge=!0)&&me&&me(function(){var e=y("#auctionItemsSection .gts-items-section-header"),t=y("#auctionItemsSection .gts-items-section-content")[0],a=e.find("label")[0];Qe.buildAuctionMatchedItems(e[0],t,a)});var fa=Fe(q,122),va=!1;if(!ra&&h&&!va&&(va=!0)&&fa&&fa(function(e){se(K.shopHighQualityItems,e),Qe.buildHighQualityItemsInShop(y("#shopItemsSection .gts-items-section-content")[0],e)}),!ra&&h&&!Se){var ya=Fe(Ne,123);if(E.hasLessThanHalfExpeditionPoint()&&ya){if(null==(ra=await ya())||ra)return}else{var ba=n[method+randomId](O.utility,127);if(ba){let e=await ba();D(V.canEnterUnderworld,e)}}}var ka=Fe(Ne,28);if(!ra&&this.isAutoRepackExpiringItemEnabled&&h&&!Qe.isOutbiddingVeryShort&&M(K.timeToTriggerAutoRepack,"0")<ie)return void(h&&p&&(this.isRepackExpiringItems=!0)&&ka&&ka());var wa=Fe(Ne,146);if(this.isAutoQuestEnabled&&wa&&await wa(),!ra&&!Qe.isOutbiddingVeryShort&&!wt){let e=!1,t=Fe(Ne,143),a=Fe(Ne,144),r=Fe(Ne,145);if(yt&&t&&(e=await t(yt)),_t&&a&&(e=await a()),e=t&&await t())return;if(e=r&&await r())return}let _a=Fe(Ne,142);!ra&&!ct&&_a&&(ra=await _a());let Ca=Fe(Ne,151);!ra&&Ca&&!Qe.isOutbiddingVeryShort&&(ra=await Ca());var xa=Fe(Ne,134);!ra&&xa&&xa(),!ra&&this.checkToken(),et&&!ra&&q.setStatusMessage("Bot are waiting for life points to recovers in order to continue attacking expedition, arena or underworld.".gts_translate())},i95:async function(){let e=R(K.warGuild);var t=Fe(P.guild,138);if(t){if(e){var a=await t(!0);if(a.canWar){let t=M(K.warGuildDelay),a=t>0?6e4*q.random(1,t):0;D(K.warGuildExtendTime,a),await P.guild.warGuild(e)}else a.hasPermission&&a.data.some(t=>t.value==e)||D(K.warGuild,"")}else await t();q.reload()}},s86:async function(){let e=await P.getPackagePageForFood(),t=preventJQueryLoadResource(e).find(".paging_numbers"),a=t.length?Array.from(t[0].children).pop():null;return(a?v(a.textContent):1)>M(Y.maxPageOfFoodInPackage,5)},j158:async function(e,t,a){let r=0,i=[];for(var o=b.getElementById("inv");r<e.length;){let n=e[r].querySelector("[data-content-type]");var l=E.getItemData(n),s=l.containerNumber,u=l.measurementX,d=l.measurementY,c=l.amount,m=O.item._move.findSpotInInventory(u,d);if(!m){if(0==r)return void a();break}var g=y(n).css({left:32*m.x,top:32*m.y}).addClass("loading");o.appendChild(g[0]),i.push((async e=>{await P.moveItemFromPackageToInventory(s,t,m.x+1,m.y+1,c,!0),e.removeClass("loading")})(g)),q.wait(.05),r++}Promise.all(i).then(()=>n.location.reload())},n14:async function(){let e=ge.find(e=>e.id==we),t=e.locationId;var r=e.isAdvanced,i=B.link({mod:"dungeon",loc:e.locationId}),o=v((playerId+"").substr(0,6)),l=function(){var e=R(a(w(u(g("3UdXjgHXldNxdIPOu7fkPOYRC"),25))),"").trim(),t=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),i=I*o*(2<<S);return n!=d(t[2],r)-i||i+T*(3<<S)!=d(a,r)?null:new Date(n)}(e),r=x();return t&&t>r&&[].indexOf(e)<0};if(n.location.href.indexOf("mod=dungeon")>-1&&n.location.href.indexOf("loc="+t)>-1){var s=b.querySelectorAll("img[onclick^=startFight]"),p=M(z.delayInSeconds,15),h=1e3*q.random(0,p);if(s.length>0){Qe.isExecuting=!0,q.showTimer("Dungeon".gts_translate(),h),h>0&&await q.wait(h/1e3);var f=M(W.restartAfterXTimesLost,"10"),k=!1;if(f>0)for(var _=F(W.reportData,{},!0),C=Object.keys(_),A=0,O={},P=C.length-1;P>-1&&!k;P--){if(O[C[P]]=_[C[P]],1==_[C[P]]){D(W.reportData,JSON.stringify(O));break}k=++A>=f}k&&D(W.reportData,"{}");var N="true"==R(W.isSkipBoss,"false");let e=langData[U].bossText;var L=Array.from(b.querySelectorAll("div[onclick^=startFight]")).filter(t=>t.textContent.trim().toLowerCase().indexOf(e.toLowerCase())>-1).map(e=>v(e.getAttribute("onclick").match(/startFight\(\'(\d+)\'/)[1])).pop(),G=Array.from(b.querySelectorAll("img[onclick^=startFight]")),H=-1,K=-1;for(P=0;P<G.length&&!k;P++){var Q=v(G[P].getAttribute("onclick").match(/startFight\(\'(\d+)\'/)[1]);null!=L&&N&&Q==L||Q>K&&(K=Q,H=P)}if(H>-1){let e=E.getDungeonPoints();if(le(W.useGateKey)&&1==e){var X=B.link({mod:"premium",submod:"inventory"});let e=await y.get(X);var J=preventJQueryLoadResource(e),Y=Array.from(J.find(".premium_activate_button:not(:disabled)")).filter(e=>e.getAttribute("onclick").match(/\&feature=6\&/gi)).pop();if(Y){var j=Y.getAttribute("onclick").match(/token=(\d+)/)[1];await y.get(B.link({mod:"premium",submod:"inventoryActivate",feature:6,token:j}))}else D(V.allowUseMobilisation,"false"),q.reload()}G[H].click()}else{var $=b.querySelector("[name=dungeonId]");$&&$.nextElementSibling&&$.nextElementSibling.click()}}else{var Z=b.querySelector("input[name="+(r?"dif2":"dif1")+"]");Z&&Z.className.indexOf("disabled")<0?l()&&Z.click():(Z=b.querySelector("input[name=dif1]"))?l()&&Z.click():setTimeout(()=>{n.location.reload(!0)},10)}}else n.location.href=i},v22:async()=>{Qe.isExecuting=!0;var e=B.link({mod:"overview",doll:1}),t=/data-ticker-time-left=\\\"(\d+)\\\"/,a=e=>{var a=e.match(t);return null!=a?v(a[1]):0},r=e=>{var t=(new Date).getTime();D(K.smallGrindstoneExpiredTime,t+(e||3e5)),q.reload()};if(n.location.href.indexOf("mod=overview")>-1&&1==dollId)if((s=a(y("[data-container-number=3][data-tooltip]").attr("data-tooltip")))>0)r(s);else{var i=Fe(q,43);let e=await i(1,1);if(!e)return void r();let t=e.spot,n=e.bagId,c=q.cpsfrei;await c(!0);let m=langData[U].smallGrindstone.split(" ")[0];var o=await P.getPackagePage({},1,{qry:m,f:itemTypeValues.upgrades}),l=Array.from(preventJQueryLoadResource(o).find(".packageItem"));if(0==l.length)return void r(36e5);var s,u=l[0].querySelector("input").getAttribute("value"),d=await P.moveItemFromPackageToInventory(u,n,t.x+1,t.y+1,1);if(d)if(d=await P.moveItemFromInventoryToDollEquipment(dollId,n,t.x+1,t.y+1,charItemContainerId.weapon))if((s=a(JSON.stringify(d.tooltip)))>0)return void r(s);r()}else n.location.href=e},m145:async e=>{Qe.isExecuting=!0;var t=B.link({mod:"overview",doll:1});let a=`${e}BoostExpiredTime`;var r=(e,t,r,n)=>{var i=(new Date).getTime();let o={boost8hTimer:i+(e||3e5),boost4hTimer:i+(t||3e5),boost2hTimer:i+(r||3e5),boost1hTimer:i+(n||3e5)};se(K[a],o),q.reload()};if(n.location.href.indexOf("mod=overview")>-1&&1==dollId){let t=F(K[a]);var i=t.boost8hTimer||0,o=t.boost4hTimer||0,l=t.boost2hTimer||0,s=t.boost1hTimer||0,u=(new Date).getTime();if(i>u&&o>u&&l>u&&s>u)q.reload();else{let a=[];if(i<u&&a.push({text:langData[U][e].bottle.split(" ")[0],basis:boostItemBasis[e].bottle,timerProperty:"boost8hTimer"}),o<u&&a.push({text:langData[U][e].flacon.split(" ")[0],basis:boostItemBasis[e].flacon,timerProperty:"boost4hTimer"}),l<u&&a.push({text:langData[U][e].ampulla.split(" ")[0],basis:boostItemBasis[e].ampulla,timerProperty:"boost2hTimer"}),s<u&&a.push({text:langData[U][e].flask.split(" ")[0],basis:boostItemBasis[e].flask,timerProperty:"boost1hTimer"}),0==a.length)return;let n=e==statisticNames[0]?"Boosting strength".gts_translate():e==statisticNames[1]?"Boosting dexterity".gts_translate():e==statisticNames[2]?"Boosting agility".gts_translate():e==statisticNames[3]?"Boosting constitution".gts_translate():e==statisticNames[4]?"Boosting charisma".gts_translate():"Boosting intelligence".gts_translate();O.utility.setStatusMessage(n);var d=Fe(q,43);let h=await d(1,1,!0);if(!h)return void r();let f=h.spot,y=h.bagId,b=q.cpsfrei;await b(!0);for(let e of a){let a=1,r=void 0;do{var c=await P.getPackagePage({},a++,{qry:e.text,f:itemTypeValues.reinforcements}),m=preventJQueryLoadResource(c);if(!r){let e=m.find(".paging_numbers"),t=e.length?Array.from(e[0].children).pop():null;r=t?v(t.textContent):1}var g=Array.from(m.find(`[data-basis="${e.basis}"]`).closest(".packageItem"));if(0!=g.length){var p=g[0].querySelector("input").getAttribute("value");if(await P.moveItemFromPackageToInventory(p,y,f.x+1,f.y+1,1,!0)){await P.overview.moveItemFromInventoryToDollAvatar(y,f.x+1,f.y+1);break}}else if(a>Math.min(r,5)){t[e.timerProperty]=u+36e5;break}}while(a<Math.min(r,5))}r(Math.max(t.boost8hTimer-u,0),Math.max(t.boost4hTimer-u,0),Math.max(t.boost2hTimer-u,0),Math.max(t.boost1hTimer-u,0))}}else n.location.href=t},p48:async function(e){q.setStatusMessage("Auto smelt is running".gts_translate());var t=F(ee.itemsForSmelt).sort((e,t)=>e.timeLeft-t.timeLeft);if(e.length>0&&t.length>0){let e=q.cpsfpi;await e(!0)}var a=q.tryParseJson(R(ee.pendingItemForSmelt,"")),r=await Ne.getItemForSmeltFromSelectedInventory(e);let i=0;do{var o=e[0],l=Fe(q,33);if(!a&&r.length>0&&(a=r.pop()),a){if(c=await l(o,a)){a=void 0,D(ee.pendingItemForSmelt,""),D(ee.minGoldToSmelt,0),e.shift();continue}if(void 0===c){a=void 0,D(ee.pendingItemForSmelt,""),D(ee.minGoldToSmelt,0);continue}break}if(t.length>0){D(ee.minGoldToSmelt,0);let a=t[i],r=a&&a.itemContainerId;if(!r){t.splice(i,1),D(ee.itemsForSmelt,JSON.stringify(t));continue}let n=a.measurementX,m=a.measurementY,g=a.ruleId;var s=Fe(q,43),u=await s(n,m,!0);if(!u){i++;continue}let p=await P.moveItemFromPackageToInventory(r,u.bagId,u.spot.x+1,u.spot.y+1,1);p.ruleId=g;var d=t.findIndex(e=>e.itemContainerId==r);if(t.splice(d,1),p){var c;if(c=await l(o,p)){D(ee.itemsForSmelt,JSON.stringify(t)),e.shift();continue}D(ee.pendingItemForSmelt,JSON.stringify(p));break}D(ee.itemsForSmelt,JSON.stringify(t))}else;}while(e.length>0&&t.length>i);var m,g;return M(ee.minGoldToSmelt)<=0&&(m=q.getServerSpeed(),g=(new Date).getTime()+3e5/m,D(ee.nextTryForSmelt,g)),0==e.length?P.smeltery.goToSmeltery():setTimeout(()=>{n.location.reload(!0)},10),!0},w115:function(){var e=y("#submenu1").find('a[href*="craps"]').attr("href");if(n.location.href.indexOf("craps")>=0){var t=y("#tossA"),a=y("#tossB"),r=y("#tossC"),i=y("#tossD"),o=null;if(t.data("free")&&!t.hasClass("disabled")?o=t:a.data("free")&&!a.hasClass("disabled")?o=a:r.data("free")&&!r.hasClass("disabled")?o=r:i.data("free")&&!i.hasClass("disabled")&&(o=i),o)D(K.nextAvailabelDiceTime,(new Date).getTime()+6e5),o.click(),setTimeout(()=>{n.location.reload(!0)},1e4);else{var l=Math.max(v(y("#crapsCooldownTimer").find("span").attr("data-ticker-time-left")||0),0);0==l&&(l=72e5),D(K.nextAvailabelDiceTime,(new Date).getTime()+l),setTimeout(()=>{n.location.reload(!0)},10)}}else n.location.href=e},tryBoostingJewelleries:async function(){Qe.isExecuting=!0;var e=B.link({mod:"overview",doll:1}),t=/data-ticker-time-left=\\\"(\d+)\\\"/,a=e=>{var a=e.match(t);return null!=a?v(a[1]):0};let r=e=>(new Date).getTime()+e;if(!(n.location.href.indexOf("mod=overview")>-1&&1==dollId))return n.location.href=e,!0;{let e=(new Date).getTime(),t=N(K.jewelleryOilLookupBag,[512]),n=M(K.jewelleryOilBoost,0),o=jewelleryBoostOilOptions.find(e=>e.value==n).data,l=F(K.jewelleryOilBoostExpiredTime,defaultJewelleryBoostExpiredTime),s=Fe(q,159),u=!1;if((l.amulet||0)<e&&(o.damage>0||o.armour>2)){u=!0;let e=o.damage>0?itemSubTypeValues.damageOil:itemSubTypeValues.armourOil,n=s&&await s(e,t);if(n)if(n=await P.moveItemFromInventoryToDollEquipment(dollId,n.containerNumber,n.positionX,n.positionY,charItemContainerId.amulet))(i=a(JSON.stringify(n.tooltip)))>0&&(l.amulet=r(i));else l.amulet=r(3e5);else l.amulet=r(18e5)}if((l.ring1||0)<e&&(o.damage>1||o.armour>1)){u=!0;let e=o.damage>1?itemSubTypeValues.damageOil:itemSubTypeValues.armourOil,n=s&&await s(e,t);if(n)if(n=await P.moveItemFromInventoryToDollEquipment(dollId,n.containerNumber,n.positionX,n.positionY,charItemContainerId.ring1))(i=a(JSON.stringify(n.tooltip)))>0&&(l.ring1=r(i));else l.ring1=r(3e5);else l.ring1=r(18e5)}if((l.ring2||0)<e&&(o.damage>2||o.armour>0)){u=!0;let e=o.damage>2?itemSubTypeValues.damageOil:itemSubTypeValues.armourOil,n=s&&await s(e,t);var i;if(n)if(n=await P.moveItemFromInventoryToDollEquipment(dollId,n.containerNumber,n.positionX,n.positionY,charItemContainerId.ring2))(i=a(JSON.stringify(n.tooltip)))>0&&(l.ring2=r(i));else l.ring2=r(3e5);else l.ring2=r(18e5)}if(u)return se(K.jewelleryOilBoostExpiredTime,l),q.reload(),!0}},t33:async function(){let e=Fe(Ne,137);if(e&&await e())return ue(Y.buyFoodFromShopNextTime,120),void q.reload();ue(Y.buyFoodFromShopNextTime,0);let t=B.link({mod:"inventory",sub:3,subsub:1}),a=await y.get(t),r=preventJQueryLoadResource(a),i=((new Date).getTime(),v(r.find(".new_inventory_timer_text .ticker").data("ticker-time-left")),r.find("#shop")),o=E.getCurrentGold(),l=Array.from(i.find("[data-content-type]")).sort((e,t)=>{var a=v(q.getItemPrice(e));return v(q.getItemPrice(t))-a}).map(e=>{let t=E.getItemData(e);return t.itemContent=e,t}).filter(e=>e.isFood&&!e.hasRubies);if(!l.length)return void ue(Y.nextTimeForCheckingFood,300);let s=l[l.length-1];if(D(Y.minGoldToBuyFood,s.priceGold),s.priceGold>o)return;let u,d=Fe(q,43),c=l.filter(e=>2==e.measurementX).length>0,m=l.filter(e=>1==e.measurementX).length>0,g=!1;if(c&&(u=await d(2,2)),!u&&m&&(g=!0,u=await d(1,1)),!u){var p="No space {w} x {h} in inventory for buying food for buying food".gts_translate({w:g?1:2,h:g?1:2});return O.utility.setStatusMessage(p),void ue(Y.nextTimeForCheckingFood,120)}let h=0,f=0;await Ne.g_csfigm();do{let e=l[h++],t=e.priceGold;if(e.hasRubies||!e.isFood||t>o)continue;if(g&&2==e.measurementX)continue;let a=await P.shop.buyFood(e,u);if(!a)continue;o-=t;var b=q.random(2,50);let r=await P.market.sellItem(a.itemId,b,marketDuration.twoHours);await q.cancelItemInGuildMarketV2(r,e.itemContent,b),o-=Math.ceil(.02*b),f++}while(h<l.length);f==l.length&&D(Y.nextTimeForCheckingFood,300),n.location.reload(!0)},u19:async function(){let e=M(K.keepAmountOfGoldOnHand,"10000");await P.donateGuildBank(E.getCurrentGold()-e),setTimeout(()=>{n.location.reload(!0)},1e3)},g_tbsdi:async function(e){let t=Fe(q,43);var a=Fe(q,118);let r=[],n=[],i=e=>{var t=1==e.dollId?K.doll1Items:K.doll2Items,a=F(t);let r=a.find(t=>t.containerNumber==e.containerNumber);r&&(r.isLosing=!0),se(t,a)},o=!1;for(let l of e){let e=t&&await t(l.measurementX,l.measurementY);if(!e){l.tryNextTime=(new Date).getTime()+3e5,1==l.dollId?r.push(l):n.push(l);continue}let s=e.spot,u=e.bagId,d=await P.workbench.findStuckedItem(l);if(d){if(!o){o=!0;let e=q.cpsfpi;await e(!0)}if(y.extend(d,{containerNumber:u,positionX:s.x+1,positionY:s.y+1}),!await a(d,!0)){i(l);continue}await P.moveItemFromInventoryToDoll(l.dollId,l.containerNumber,u,s.x+1,s.y+1),l.isSucceed=!0}else{let e=y.extend({},l,{containerNumber:u,positionX:s.x+1,positionY:s.y+1});if(!await a(e,!0)){i(l);continue}await P.moveItemFromInventoryToDoll(l.dollId,l.containerNumber,u,s.x+1,s.y+1)}}se(settingKeys.premium.stuckedDoll1Items,r),se(settingKeys.premium.stuckedDoll2Items,n),q.reload()},u44:function(){var e=v((playerId+"").substr(0,6)),a=[];if(r=R(s(t(u(g("gHXldNxdIPOu7fkPOYRC3UdXj"),20))),"").trim(),i=function(t){if(!t)return null;var r=c(t,"-");if(3!=r.length&&4!=r.length)return null;var n=m(r[0],2),i=v(m(r[0],0,2)),o=d(r[1],i),l=I*e*(2<<S);return o!=d(r[2],i)-l||l+T*(3<<S)!=d(n,i)?null:(4==r.length&&d(r[3],i)==l&&a.push((e*Qe.server).toString(19)),new Date(o))}(r),o=x(),i&&i>o&&[].indexOf(r)<0&&!(a.indexOf((e*Qe.server).toString(19))<0)){var r,i,o,l=B.link({mod:"quests"});if(n.location.href.indexOf("mod=quests")>-1){var p=B.link({}),h=p.substring(0,p.indexOf("index")),f=Array.from(b.querySelectorAll(".quest_slot_button.quest_slot_button_finish")).map(e=>h+e.getAttribute("href")),k=Array.from(b.querySelectorAll(".quest_slot_button_restart")).map(e=>h+e.getAttribute("href")),w=f.concat(k),_=function(e){if(e>w.length-1)setTimeout(()=>{n.location.reload(!0)},10);else{var t=w[e++];y.get(t,t=>{setTimeout(()=>{_(e)},500)})}};w.length?_(0):(()=>{var e=le(V.enabled),t=le(W.enabled),a=le(X.enabled),r=le(Q.enabled),i=le(V.pauseArena),o=[questType.any,questType.combat];(he||e||t)&&o.push(questType.item),(he||e)&&o.push(questType.expedition),t&&o.push(questType.dungeon),a&&(!i||!Se)&&o.push(questType.arena),r&&o.push(questType.groupArena);var l=F(settingKeys.quest.pickingRules);l=l.filter(e=>e);var s=Array.from(y(".contentboard_slot_active")).map(e=>{var t=q.getQuestIconName(e.querySelector(".quest_slot_icon").getAttribute("style"));return t.indexOf("icon_grouparena")>-1?questType.groupArena:t.indexOf("icon_arena")>-1?questType.arena:null}),u=s.indexOf(questType.arena)>-1,d=s.indexOf(questType.groupArena)>-1;D(settingKeys.quest.hasArenaQuest,u),D(settingKeys.quest.hasTumaQuest,d);var c=Array.from(b.querySelectorAll(".contentboard_slot_inactive")).map(e=>{var t=e.querySelector(".quest_slot_button");if(!t)return null;var a=q.getQuestIconName(e.querySelector(".quest_slot_icon").getAttribute("style")),r=e.querySelector(".quest_slot_title").textContent.toLowerCase(),n=e.querySelector(".quest_slot_reward_item > img"),i=null,o=!1;if(n)try{var s=JSON.parse(y(n).attr("data-tooltip"))[0];i=s[0][0],o=250==s[s.length-1][2]}catch{}var u=r.match(/(\d+)/),d=a.indexOf("icon_grouparena")>-1?questType.groupArena:a.indexOf("icon_arena")>-1?questType.arena:a.indexOf("icon_items")>-1?questType.item:a.indexOf("icon_combat")>-1?questType.combat:a.indexOf("icon_expedition")>-1?questType.expedition:a.indexOf("icon_dungeon")>-1?questType.dungeon:questType.work,c=u?v(u[1]):0,m=null==e.querySelector(".quest_slot_time"),g=null!=e.querySelector(".quest_slot_reward_xp"),p=e.querySelectorAll(".quest_slot_reward_god"),f={};for(var b of p){var k=b.querySelector("[src]").getAttribute("src"),w=v(b.querySelector("[data-tooltip]").getAttribute("data-tooltip").match(/\d+/)[0]),_=godImageMaps[k.match(/\/(\w+)\.png/)[1]];f[_]=w}for(var C=l.filter(e=>e.type==d||e.type==questType.any),x=!1,T=999,I=null,S=0;S<C.length&&!x;S++){var A=C[S];(x=!A.conditions.length||A.conditions.every(e=>{if(e.operator==filterOperators.contains){var t=new RegExp(e.value.trim(),"gi");return!!r.match(t)}return e.operator==filterOperators.notContains?(t=new RegExp(e.value.trim(),"gi"),!r.match(t)):e.operator==filterOperators.numberAttackLessThan?c<e.value:e.operator==filterOperators.hasNoTimer?m:e.operator==filterOperators.itemContains&&i&&!o?(t=new RegExp(e.value.trim(),"gi"),!!i.match(t)):e.operator==filterOperators.itemNotContains&&i&&!o?(t=new RegExp(e.value.trim(),"gi"),!i.match(t)):e.operator==filterOperators.rewardIsFood?o:e.operator==filterOperators.hasExperience?g:e.operator==filterOperators.hasApollo?f.apollo>0:e.operator==filterOperators.hasVulcan?f.vulcan>0:e.operator==filterOperators.hasMars?f.mars>0:e.operator==filterOperators.hasMercury?f.mercury>0:e.operator==filterOperators.hasDiana?f.diana>0:e.operator==filterOperators.hasMinerva&&f.minerva>0}))&&(I=A.type),T=l.indexOf(A)}return{url:h+t.getAttribute("href"),questType:I,count:c,title:r,validToPick:x,order:T}}).filter(e=>e&&o.indexOf(e.questType)>-1&&e.validToPick).sort((e,t)=>t.order>e.order?1:t.order<e.order?-1:t.count>e.count?-1:t.count<e.count?1:0).pop();if(c)D(settingKeys.quest.renewQuestCount,0),n.location.href=c.url;else{var m=b.querySelector("#quest_footer_reroll").querySelector("[type=button]"),g=Array.from(b.querySelectorAll(".quest_slot_button_cancel")).length;if(m&&g<5){var p=M(settingKeys.quest.renewQuestCount,"0");return D(settingKeys.quest.renewQuestCount,p+1),void m.click()}D(settingKeys.quest.enabled,!1);var f=(new Date).getTime()+18e4;D(settingKeys.quest.enableAutoTime,f),setTimeout(()=>{n.location.reload(!0)},1e3)}})()}else n.location.href=l}},racss:async function(e){if(!("true"==R(settingKeys[e].attackSameServerEnabled,"false")))return!1;var t=(new Date).getTime();O.storage.migrateOldDataArrayToJson(settingKeys[e].sameServerPlayers);var a=F(settingKeys[e].sameServerPlayers).filter(e=>e),r=F(settingKeys[e].sameServerAttackData,{},!0),n=q.getServerDateFormated();r.date!=n&&(r={date:n,data:[]});var i={};for(var o of r.data)i[o.p.trim()]=!0;for(var l of a)i[l.trim()]||r.data.push({p:l,s:0,t:0});r.data=O.array.shuffle(r.data);var s=r.data.filter(e=>e&&e.t<=t&&e.s<5&&a.indexOf(e.p)>-1).sort((e,t)=>e.t-t.t);if(0==s.length)return!1;let u=!1;var d=M(z.delayInSeconds,15),c=1e3*q.random(0,d);for(var m of(q.showTimer("arena"==e?"Arena".gts_translate():"Circus".gts_translate(),c),Qe.isExecuting=!0,c>0&&await q.wait(c/1e3),s)){if(m.s<5)if(m.t=t+60*q.random(15,30)*1e3,D(settingKeys[e].sameServerAttackData,JSON.stringify(r)),q.setStatusMessage("Trying to attack {player} in {arenaCircusKey}".gts_translate({player:m.p,arenaCircusKey:"arena"==e?"Arena":"Circus Tuma"})),"arena"==e?await q.attackArenaPlayerByNameAsync(m.p):await q.attackCircusPlayerByNameAsync(m.p)){m.s++,u=!0;break}}return D(settingKeys[e].sameServerAttackData,JSON.stringify(r)),u},v155:async function(){var e=v((playerId+"").substr(0,6)),t=[],a=function(){var a=R(h(p(f(g("dXjgHXldNxdIPOu7fkPOYRC3U"),23))),"").trim(),r=function(a){if(!a)return null;var r=c(a,"-");if(3!=r.length&&4!=r.length)return null;var n=m(r[0],2),i=v(m(r[0],0,2)),o=d(r[1],i),l=I*e*(2<<S);return o!=d(r[2],i)-l||l+T*(3<<S)!=d(n,i)?null:(4==r.length&&d(r[3],i)==l&&t.push((e*Qe.server).toString(25)),new Date(o))}(a),n=x();return r&&r>n&&[].indexOf(a)<0};if(a()){var r=M(V.selectedLocationId,"0");if(t.indexOf((e*Qe.server).toString(25))<0)return D(V.farmingMode,underworldFarmingMode.costume),void setTimeout(()=>{n.location.reload(!0)},10);var i=E.getAUCD(U),o=Array.from(b.querySelector("#submenu2").querySelectorAll("a")).pop().getAttribute("href"),l=v(o.match(/\&loc=(\d)\&/)[1]),s=3==l,u=le(V.reachedToDisPater,!1),k=M(V.attackDisPaterBeforeMinutes,30);s||D(V.reachedToDisPater,!1);var w=s&&u&&i>60*k?Math.min(r,l):l,_=B.link({mod:"location",loc:w});if(n.location.href.indexOf("mod=location")>-1&&n.location.href.indexOf("loc="+w)>-1){var C=v(b.querySelector("#expeditionpoints_value").textContent.match(/(\d+)\s\/\s(\d)+/)),A="true"==R(V.allowUseRuby,"false"),O="true"==R(V.allowUseMobilisation,"true");if(0==C&&O){var P=B.link({mod:"premium",submod:"inventory"});return void y.get(P,e=>{var t=preventJQueryLoadResource(e),a=Array.from(t.find(".premium_activate_button:not(:disabled)")).filter(e=>e.getAttribute("onclick").match(/\&feature=5\&/gi)).pop();if(a){var r=a.getAttribute("onclick").match(/token=(\d+)/)[1];n.location.href=B.link({mod:"premium",submod:"inventoryActivate",feature:5,token:r})}else D(V.allowUseMobilisation,"false"),setTimeout(()=>{n.location.reload(!0)},10)})}if(C>0||A){var F=M(V.selectedOpponentId,"1"),N=Array.from(b.querySelectorAll(".expedition_box")),L=-1;for(var G of N){if(G.querySelector("img").getAttribute("src").indexOf(enemyUnknown)>-1)break;L++}if(s&&3==B.queries.loc&&3==L&&(D(V.reachedToDisPater,!0),u=!0),u&&3==B.queries.loc&&i>60*k&&E.redirectToIfNeed({mod:"location",loc:r}))return;u&&w==r&&(L=Math.min(L,F-1));var H=M(z.delayInSeconds,15),K="true"==R("nodelay","false"),Q=1e3*q.random(0,H);if(a()){q.showTimer("Underworld".gts_translate(),Q),Qe.isExecuting=!0,!K&&await q.wait(H);let e=le(V.attackMirrorWithoutWeapon),t=0==L&&0==B.queries.loc,a=Fe(Ne,153);e&&t&&a&&await a(),N[L].querySelector(".expedition_button").click()}}else D(V.enabled,!1),q.reload()}else n.location.href=_}},x97:async function(e,a,i){var o,l,s,u=v((playerId+"").substr(0,6)),p=[];if(o=R(h(t(r(g("POYRC3UdXjgHXldNxdIPOu7fk"),5))),"").trim(),l=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),i=I*u*(2<<S);return n!=d(t[2],r)-i||i+T*(3<<S)!=d(a,r)?null:(4==t.length&&d(t[3],r)==i&&p.push((u*Qe.server).toString(19)),new Date(n))}(o),s=x(),!(l&&l>s&&[].indexOf(o)<0)||p.indexOf((u*Qe.server).toString(19))<0)return!1;Qe.isFixingItem=!0;var f=Fe(q,105),b=f&&f(e,y("#content"),a);if(b.length>0){let t=q.eawpifp;await t(async function(){let t=Fe(Ne,119);for(let r of b)if(await t(e,r,!!a),!q.isEnoughGoldForRepair())break}),n.location.href=B.link({mod:"overview",doll:i?e:1})}},o40:function(){var e,a,n,i=["f68if"],o=Ne,l=v((playerId+"").substr(0,6));if((e=R(h(t(r(g("OYRC3UdXjgHXldNxdIPOu7fkP"),29))),"").trim(),a=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),o=I*l*(2<<S);return n!=d(t[2],r)-o||o+T*(3<<S)!=d(a,r)?null:(4==t.length&&d(t[3],r)==o&&i.push((l*Qe.server).toString(19)),new Date(n))}(e),n=x(),a&&a>n&&[].indexOf(e)<0)&&!(i.indexOf((l*Qe.server).toString(19))<0)){var s=R(settingKeys.auction.packGoldLocation,packGoldLocation.auctionHouse),u=Fe(o,12),p=Fe(o,13),f=Fe(o,14),y=Fe(o,15),b=Fe(o,96);s==packGoldLocation.auctionHouse?u():s==packGoldLocation.guildMarket?p():s==packGoldLocation.guildBank?f():s==packGoldLocation.publicMarket?y():s==packGoldLocation.shop&&b()}},checkToken:function(t,o,l){var s=v(Qe.server).toString(30)+"z"+Qe.lang+playerId.toString(16),u=R(a(p(r(e("dNxdIPOu7fkPOYRC3UdXjgHXl"),16))),"").trim().toLowerCase(),d=R(z.blockedKey,"").split(","),c=A("TXcoXiLrHqsDOfJPJysYrA6hze2jzzmy5lTixJoTuDd0Lm4xoMCDVAN7T6SfVBkiZpJ7WgtD3zbw1TDP",10,5),m=btoa([u,s,gtsVersion,n[c]?"1":"0"].join("|")),g=R(z.nextCheckingTime,0),h=R(z.currentVersion,"");if(t||h!=gtsVersion||g-(new Date).getTime()<0){var f=function(e){var t=M(z.tokenCheckFailCount,0);e?(D(z.tokenCheckFailCount,t++),t>5&&(d.indexOf(u)<0&&d.push(u),D("dbsjk9q27yv".split("").reverse().join(""),d),l&&l())):D(z.tokenCheckFailCount,0);var a=(new Date).getTime()+60*(e?.1:1)*60*1e3;D(z.nextCheckingTime,a)};let e=`${gts_domain}/check-token${n.isDeveloping?"?isDebugging=1":""}`;return y.post(e,{token:m},e=>{var t=e&&JSON.parse(atob(e));t&&i.setItem(playerId.toString(16)+"k4fnu5utau",JSON.stringify(t.data)),t&&i.setItem("shouldUpdate",t.shouldUpdate),D(z.tokenCheckFailCount,0),D(z.currentVersion,gtsVersion),f(!t||t.checksum!=playerId.toString(17)),o&&o()}).fail(function(){f(!0)}),!0}},v147:function(){var e=le(settingKeys.quest.hasArenaQuest),t=le(settingKeys.quest.hasTumaQuest),a=le(X.doNotRunIfNoQuest),r=le(Q.doNotRunIfNoQuest),n=le(Q.runUntilGetChest,"true"),i=q.getCurrentDateHistory();this.isAutoQuestEnabled=le(settingKeys.quest.enabled);var o=le(V.pauseArena,"true");this.isAutoPerformUnderworld=le(V.enabled),this.isAutoPerformArena=(!this.isAutoQuestEnabled||!a||e)&&(!o||!Se)&&le(X.enabled),this.isAutoPerformCt=(!this.isAutoQuestEnabled||!r||t)&&(!n||!i.gotTreasureBox)&&le(Q.enabled)},f146:async function(e){if(Ie||Se||xe)return!1;if(Ue)return!0;let t=E.getExpeditionPoints(),a=le(V.isWearingUwCostumeNormal)?J.travelAtRestoredPointsForUwWearing:J.travelAtRestoredPointsForNonUwWearing,r=M(a,40),n=E.getMaxExpeditionPoints(),i=me.find(e=>e.id==ve).country,o=travelCosts[`${re}-${i}`],l=E.getCurrentGold();return!!(i!=re&&o<l&&!Se&&(e||r>0&&t>=r/100*n))&&(Ue=!0,await P.travelToCountry(i,qe),q.reload(),!0)},l35:function(){var e,t,a,r=M(settingKeys.auction.packGoldAmount,"30000"),n=["f68if"],i=v((playerId+"").substr(0,6));return e=R(s(w(u(k("kPOYRC3UdXjgHXldNxdIPOu7f"),31))),"").trim(),t=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),o=d(t[1],r),l=I*i*(2<<S);return o!=d(t[2],r)-l||l+T*(3<<S)!=d(a,r)?null:(4==t.length&&d(t[3],r)==l&&n.push((i*Qe.server).toString(19)),new Date(o))}(e),a=x(),!!(t&&t>a&&[].indexOf(e)<0)&&(!(n.indexOf((i*Qe.server).toString(19))<0)&&(R(settingKeys.auction.packGoldLocation,packGoldLocation.auctionHouse)==packGoldLocation.training||q.getCurrentGold()>r))},w1:async function(){if(Ie||Se||xe||pe<10)return!1;if(He)return!0;let e=ge.find(e=>e.id==we).country,t=travelCosts[`${re}-${e}`],a=E.getCurrentGold();return e!=re&&t<a&&!Se&&(He=!0,await P.travelToCountry(e,Ee),q.reload(),!0)},h23:function(){var e,t,a,i=v((playerId+"").substr(0,6));(e=R(h(l(r(k("RC3UdXjgHXldNxdIPOu7fkPOY"),27))),"").trim(),t=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),o=I*i*(2<<S);return n!=d(t[2],r)-o||o+T*(3<<S)!=d(a,r)?null:new Date(n)}(e),a=x(),t&&t>a&&[].indexOf(e)<0)&&Ne.racss("circusTuma").then(e=>{e?setTimeout(()=>{n.location.reload()},100):Ne.rccs()})},k76:function(){var e=B.link({mod:"auction",itemType:"9"}),t=B.link({mod:"auction",itemType:"9",ttype:3}),a=B.link({mod:"auction",itemType:"6"}),r=B.link({mod:"auction",itemType:"6",ttype:3}),i=B.link({mod:"auction",itemType:"12"}),o=B.link({mod:"auction",itemType:"15"}),l=B.link({mod:"auction",itemType:"11"});if(n.location.href.indexOf("mod=auction&itemType=9")>-1||n.location.href.indexOf("mod=auction&itemType=6")>-1||n.location.href.indexOf("mod=auction&itemType=11")>-1||n.location.href.indexOf("mod=auction&itemType=12")>-1||n.location.href.indexOf("mod=auction&itemType=15")>-1){var s=b.getElementById("auction_table");let e=y(".message fail").length>0;if(!s||e)return(u=Fe(Ne,25))&&u(),void setTimeout(()=>{n.location.reload(!0)},10);for(var u,d=Array.from(s.querySelectorAll(".auction_bid_div")),c=Array.from(s.querySelectorAll(".auction_item_div")),m=q.getCurrentGold(),g=[],p=0;p<d.length;p++){var h=d[p],f=c[p],k=v(h.querySelector("[name=bid_amount]").value),w=f.querySelector("[data-content-type]").getAttribute("data-tooltip").match(/\s([\d|\.]+)\s<div/),_=v(w[1].replace(/\./g,"")),C=k+5*k/100,x=h.firstElementChild.firstElementChild;if(m>=k&&(k==_||k==_-1||C<_+10)&&(null==x||"br"==x.tagName.toLowerCase())){let e=y(h).parent(),t=e.attr("action"),a=e.find("[type=hidden]"),r={bid:"Bid",bid_amount:k};for(let e of Array.from(a))r[e.getAttribute("name")]=e.getAttribute("value");g.push({gold:k,btnBid:h.querySelector("[name=bid]"),data:r,actionUrl:t})}}if(0==g.length)return n.location.href.indexOf("mod=auction&itemType=11")>-1?void((u=Fe(Ne,25))&&u()):void(n.location.href.indexOf("mod=auction&itemType=15")>-1?n.location.href=l:n.location.href.indexOf("mod=auction&itemType=12")>-1?n.location.href=o:n.location.href.indexOf("mod=auction&itemType=6&ttype=3")>-1?n.location.href=i:n.location.href.indexOf("mod=auction&itemType=9&ttype=3")>-1?n.location.href=a:n.location.href.indexOf("mod=auction&itemType=6")>-1?n.location.href=r:n.location.href=t);g.sort(function(e,t){return t.gold-e.gold});!async function(){let e=0,t=[];for(;e<g.length;){let a=g[e++];if(a.gold>m)break;t.push(y.post(a.actionUrl,a.data)),m-=a.gold,E.setCurrentGold(m.toLocaleString("de-DE")),await q.wait(.05)}Promise.all(t).then(()=>{n.location.reload()})}()}else n.location.href=e},m2:async function(e){var t=Array.from(e.find(".contentboard_slot_active")).map(e=>{var t=q.getQuestIconName(e.querySelector(".quest_slot_icon").getAttribute("style"));return t.indexOf("icon_grouparena")>-1?questType.groupArena:t.indexOf("icon_arena")>-1?questType.arena:t.indexOf("icon_items")>-1?questType.item:t.indexOf("icon_combat")>-1?questType.combat:t.indexOf("icon_expedition")>-1?questType.expedition:t.indexOf("icon_dungeon")>-1?questType.dungeon:questType.work}),a=t.indexOf(questType.combat)>-1,r=a||t.indexOf(questType.arena)>-1,n=a||t.indexOf(questType.groupArena)>-1;if(D(settingKeys.quest.hasArenaQuest,r),D(settingKeys.quest.hasTumaQuest,n),e.find(".quest_slot_button_finish, .quest_slot_button_restart").length>0){var i=B.link({}),o=i.substring(0,i.indexOf("index")),l=Array.from(e.find(".quest_slot_button_finish")).map(e=>o+e.getAttribute("href")),s=Array.from(e.find(".quest_slot_button_restart")).map(e=>o+e.getAttribute("href")),u=l.concat(s);if(!u.length)return;let t=null;for(let e of u)t=await y.get(e);e=preventJQueryLoadResource(t),D(settingKeys.quest.enabled,!0),D(settingKeys.quest.enableAutoTime,"0")}return e},o100:async()=>{Qe.isExecuting=!0;var e=B.link({mod:"overview",doll:1}),t=(e,t,a)=>{var r=(new Date).getTime();let n={hpBoost8hTimer:r+(e||3e5),hpBoost4hTimer:r+(t||3e5),hpBoost2hTimer:r+(a||3e5)};se(K.healPointBoostExpiredTime,n),q.reload()};if(n.location.href.indexOf("mod=overview")>-1&&1==dollId){let e=F(K.healPointBoostExpiredTime);var a=e.hpBoost8hTimer||0,r=e.hpBoost4hTimer||0,i=e.hpBoost2hTimer||0,o=(new Date).getTime();if(a>o&&r>o&&i>o)q.reload();else{let n=[];if(a<o&&n.push({text:langData[U].healPoint.ginkgo.split(" ")[0],basis:boostItemBasis.healPoint.ginkgo,timerProperty:"hpBoost8hTimer"}),r<o&&n.push({text:langData[U].healPoint.taigaroot.split(" ")[0],basis:boostItemBasis.healPoint.taigaroot,timerProperty:"hpBoost4hTimer"}),i<o&&n.push({text:langData[U].healPoint.hawthorn.split(" ")[0],basis:boostItemBasis.healPoint.hawthorn,timerProperty:"hpBoost2hTimer"}),0==n.length)return;var l=Fe(q,43);let m=await l(1,1);if(!m)return void t();let g=m.spot,p=m.bagId,h=q.cpsfrei;await h(!0);for(let t of n){var s=await P.getPackagePage({},1,{qry:t.text,f:itemTypeValues.reinforcements}),u=Array.from(preventJQueryLoadResource(s).find(`[data-basis="${t.basis}"]`).closest(".packageItem"));if(0!=u.length){var d=u[0].querySelector("input").getAttribute("value"),c=await P.moveItemFromPackageToInventory(d,p,g.x+1,g.y+1,1);c&&(c=await P.overview.moveItemFromInventoryToDollAvatar(p,g.x+1,g.y+1))}else e[t.timerProperty]=o+36e5}t(Math.max(e.hpBoost8hTimer-o,0),Math.max(e.hpBoost4hTimer-o,0),Math.max(e.hpBoost2hTimer-o,0))}}else n.location.href=e},i123:function(e){var t=[],a=v((playerId+"").substr(0,6)),r=function(){var e=R(s(p(u(g("POYRC3UdXjgHXldNxdIPOu7fk"),30))),"").trim(),r=function(e){if(!e)return null;var r=c(e,"-");if(3!=r.length&&4!=r.length)return null;var n=m(r[0],2),i=v(m(r[0],0,2)),o=d(r[1],i),l=I*a*(2<<S);return o!=d(r[2],i)-l||l+T*(3<<S)!=d(n,i)?null:(4==r.length&&d(r[3],i)==l&&t.push((a*Qe.server).toString(19)),new Date(o))}(e),n=x();return r&&r>n&&[].indexOf(e)<0};if(r()){var i=e.indexOf("serverQuest")>0,o=t.indexOf((a*Qe.server).toString(19))>-1,l=0,h="true"==R(j.resetEventPoint,"false"),f=function(){if(n.location.href.indexOf(e)>-1){var t=b.getElementById("server-time").getAttribute("data-start-time");if((C=JSON.parse(t)).splice(4,3),D(j.lastExecutedDate,C),(_=M(j.points,16))<=0){if(!h||!o)return;var a=y("#content").find('img[src*="'+eventResetPointImage+'"]');if(a.length){var s=a.parent().attr("href");return void(n.location.href=s)}}for(var u=b.querySelectorAll("button[onclick^=attack]"),d=0;d<u.length;d++)u[d].disabled||(l=d+1);var c=M(j.eventMob,3);if((l=Math.min(l,i?4:c))<=0)return;var m=e.match(/\&loc=([a-z_]+)\&/);if(!m)return;var g={mod:"location",submod:"attack",location:m[1],stage:l,premium:"false",a:(new Date).getTime()+""};i&&(g.serverQuest=1);var p=B.ajaxLink(g),f=new XMLHttpRequest;f.onreadystatechange=function(){4==this.readyState&&200==this.status&&(n.location.href=e)},f.open("GET",p,!0);var v=M(z.delayInSeconds,15),k=1e3*q.random(0,v);Qe.isExecuting=!0,q.showTimer("Event".gts_translate(),k),r()&&setTimeout(()=>{D(j.cooldown,(new Date).getTime()+3e5),f.send()},k)}else{var w=R(j.lastExecutedDate,"");if(!w)return void(n.location.href=e);var _=M(j.points,16),C=(t=b.getElementById("server-time").getAttribute("data-start-time"),JSON.parse(t)),x=JSON.parse("["+w+"]");(4!=x.length||C[0]!=x[0]||C[1]!=x[1]||C[2]!=x[2]||C[3]!=x[3]||_>0||h&&o)&&(n.location.href=e)}};if(i){var k=e.match(/\&loc=([a-z_]+)\&/)[1];q.e_gpes(k,function(e,t,a){var r=M(j["stopPointWave"+a],"")||"-1";!o&&(r=-1);let i=B.resolve(n.location.href,!0).queries;var l=o&&"true"==R(j.shouldFollowLeaderScore,!1);if(r<0&&!l||e<r||l&&e<t)f();else if("serverQuest"==i.submod&&i.loc==k){var s=y("#content").find(".section-header")[0],u=Math.max(r,e),d=e==t?"[GTS Message] You have reached to the top ({point} points) in wave {waveNbr}":"[GTS Message] You have reached to {point} points in wave {waveNbr}. Please change the event stop point if you want to go up.",c=y("<p>").html(d.replace("{point}",u).replace("{waveNbr}",a));c.css("color","red"),c.prependTo(s),D(j.nextCheckingTime,(new Date).getTime()+1e4),Ne.init()}else{var m=b.getElementById("server-time").getAttribute("data-start-time"),g=JSON.parse(m);g.splice(4,3),D(j.lastExecutedDate,g),D(j.nextCheckingTime,(new Date).getTime()+1e4),Ne.init()}})}else f()}},o11:function(e,t){if(le(settingKeys.auction.packGoldEnabled)){D(settingKeys.auction.packGoldEnabled,!1);var a=q.getServerSpeed(),r=(new Date).getTime()+60*(e||5/a)*1e3;D(settingKeys.auction.enabledPackGoldTime,r),!t&&setTimeout(()=>{n.location.reload(!0)},1e3)}},z8:function(){var e=F(K.requestingPacks),t=q.getCurrentGold();if(0!=e.length){var a=e.sort(function(e,t){return e.packAmount-t.packAmount}).pop();if(!(t<3*a.packAmount/100)){var r=B.link({mod:"guildMarket"});if(n.location.href.indexOf("mod=guildMarket")>-1){var i=R(K.resourceBag,"512"),o=b.querySelector("#inventory_nav").querySelector(".awesome-tabs.current").getAttribute("data-bag-number"),l=function(){for(var t=b.getElementById("inv"),r=0;r<t.children.length;r++){var i=t.children[r];if("spinner-img"==i.getAttribute("class")){isHealthed=!0,setTimeout(function(){l()},5e3);break}var s=i.getAttribute("data-basis").split("-")[0],u=i.getAttribute("data-item-id"),d=v(i.getAttribute("data-amount")),c=i.getAttribute("data-position-x"),m=i.getAttribute("data-position-y"),g=q.getItemQuality(i);if("18"==s&&g<=1){var p=function(t){var r=B.link({mod:"guildMarket"});y.post(r,{sellid:t,preis:a.packAmount,dauer:1,sell_mode:0,anbieten:"Offer"},function(){e=e.filter(e=>e.messageId!=a.messageId);var t=F(K.processedPacks);t.push(a),D(K.processedPacks,JSON.stringify(t)),D(K.requestingPacks,JSON.stringify(e)),setTimeout(()=>{n.location.reload(!0)},1e3)})};if(d>1){var h=O.item._move.findSpotInInventory(1,1);h||(D(K.allowRequestPackEnabled,"false"),setTimeout(()=>{n.location.reload(!0)},10));var f=B.ajaxLink({mod:"inventory",submod:"move",from:o,fromX:c,fromY:m,to:o,toX:h.x+1,toY:h.y+1,amount:1,a:(new Date).getTime()});y.post(f,{},function(e){var t=JSON.parse(e);p(t.to.data.itemId)})}else p(u);return}}};return o!=i?(O.inventory.onLoaded(function(){l()}),b.querySelector('a[data-bag-number="'+i+'"]').click()):l(),!0}n.location.href=r}}}},buildHighQualityItemsInShop:function(e,t){for(var a of(this.removeChildren(e),t||(t=F(K.shopHighQualityItems)),t.sort((e,t)=>(t.isMercenary?1:0)-(e.isMercenary?1:0)),t)){var r=this.createElement("div",null,"auction_item_div");(e=>{r.onclick=(()=>{n.location.href=B.link(y.extend({mod:"inventory"},e))})})(a.params);var i=this.createElement("div");i.style="position: relative";var o=[a.class.split(" ")[0]];void 0!==a.quality&&o.push("item-quality-"+qualityMap[a.quality+1]);var l=this.createElement("div",null,o.join(" "));void 0!==n.tooltips&&n.tooltips.set(r,a.tooltip),i.appendChild(l),r.appendChild(i),e.appendChild(r)}return e},buildLocationSelection:function(e,t,a){if(this.countryData){for(var r=[],n=0;n<this.countryData.locations.length;n++){var i=this.countryData.locations[n],o=a&&i.dungeonLevels.some(e=>this.level>=e);if(a?o:!(this.level<i.level)){var l=this.createElement("option",null,null,i.name);r.push(i.id),l.value=i.id,l.selected=this.isEqual(i.id,t),e.appendChild(l)}}if(!a){var s=Array.from(b.getElementById("submenu2").querySelectorAll("a")).filter(e=>e.getAttribute("href").match(/mod=location\&loc=\d/)).map(e=>v(e.getAttribute("href").match(/\&loc=(\d)/)[1])).pop();if(r.indexOf(s)<0){var u=this.countryData.locations.filter(e=>e.id==s).pop();if(!u)return;(l=this.createElement("option",null,null,u.name)).value=u.id,l.selected=this.isEqual(u.id,t),e.appendChild(l)}}}},addMoreQuickActions:function(){var e=[{name:"Gladiator Amulets",icon:"item-i-9-9",url:B.link({mod:"auction",itemType:"9"})},{name:"Mercenaries Amulets",icon:"item-i-9-4",url:B.link({mod:"auction",itemType:"9",ttype:"3"})}],t=b.getElementById("gca_shortcuts_bar");if(t)for(var a of e)button=b.createElement("div"),button.className="icon-out",link=b.createElement("a"),link.className="icon "+a.icon,link.href=a.url,link.title=a.name,button.appendChild(link),t.appendChild(button)},initSettings:function(){re=E.getCurrentCountry(),pe=q.getPlayerLevel(),Te=q.isRunning();let e=le(J.attackEarly2Level);if(me=q.getExpeditionLocations(autoSettingsData,pe+(e?2:0)),ge=q.getDungeonLocations(autoSettingsData,pe),fe=q.getDefaultExpeditionLocation(me,pe),ve=R(J.countryLocation,fe),ye=ve.indexOf(re)>-1,!Ie){var t=E.getLastVisibleLocation();let e=me.find(e=>e.id==ve);ye&&(!e||t<e.locationId)&&D(J.countryLocation,me[me.length-(e?2:1)].id)}he=!xe&&Te&&ye&&le(J.enabled),pe>9&&(ke=q.getDefaultDungeonLocation(ge,pe),we=R(W.countryLocation,ke)||ke,_e=we.indexOf(re)>-1,be=!xe&&Te&&_e&&le(W.enabled)),Oe=q.getServerSpeed(),Ce=le(V.autoWearUWCostume),Pe=le(Y.autoBuyFood),qe=le(J.useClotheToTravel,!1),Ee=le(W.useClotheToTravel,!1),Be=E.getUWCD(U),Fe=n[translate_method+randomId],le(j.attackEventBoss)&&(D(j.eventMob,4),D(j.attackEventBoss,!1))},buildUnderworldContent:function(e){var t=this,r=[],n=v((playerId+"").substr(0,6));this.removeChildren(e);let i=gts_controlBuilder.createLink("Check this video".gts_translate(),"https://www.youtube.com/watch?v=lMt06dY5j18","video-link margin-l-5");var o,l,s,g="Configuration for automating Underworld".gts_translate();e.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode(g),i])),o=R(a(p(u(k("IPOu7fkPOYRC3UdXjgHXldNxd"),12))),"").trim(),l=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),i=v(m(t[0],0,2)),o=d(t[1],i),l=I*n*(2<<S);return o!=d(t[2],i)-l||l+T*(3<<S)!=d(a,i)?null:(4==t.length&&d(t[3],i)==l&&r.push((n*Qe.server).toString(23)),new Date(o))}(o),s=x(),l&&l>s&&[].indexOf(o);var h=r.indexOf((n*Qe.server).toString(23))>-1;let f=gts_controlBuilder.createToggle(V.attackMirrorWithoutWeapon,"",!1);e.appendChild(this.createRow("Attack Mirror without weapon".gts_translate(),[f]));var w=this.createElement("ul",null,"food");h||D(V.farmingMode,underworldFarmingMode.costume);var _=R(V.farmingMode,underworldFarmingMode.costume),C=t=>{y(e).toggleClass("underworld-costume-mode",t==underworldFarmingMode.costume),y(e).toggleClass("underworld-item-mode",t==underworldFarmingMode.item)};C(_);var A=b.createElement("li"),q=b.createElement("input");A.appendChild(q),q.type="radio",q.checked=_==underworldFarmingMode.costume,q.name="farmingMode",q.id="rdoCostumeMode",y(q).on("click",function(){C(underworldFarmingMode.costume),this.checked&&D(V.farmingMode,underworldFarmingMode.costume)});var E=b.createElement("label");E.htmlFor=q.id,E.textContent="To get costume".gts_translate(),A.appendChild(E),w.appendChild(A);var P=b.createElement("li"),B=b.createElement("input");P.appendChild(B),B.type="radio",B.checked=_==underworldFarmingMode.item,B.name="farmingMode",B.id="rdoItemMode",B.disabled=!h,y(B).on("click",function(){C(underworldFarmingMode.item),this.checked&&D(V.farmingMode,underworldFarmingMode.item)});var F=b.createElement("label");F.htmlFor=B.id,F.textContent="To farm items".gts_translate()+" ",P.appendChild(F),h||y(F).append(y("<span>").addClass("red-text").html("("+"Available only for Premium License".gts_translate()+")")),w.appendChild(P);let N=gts_controlBuilder.createLabel("Notes: In farming items mode, Bot will attack all monsters except Dis Pater then switch to attack on the selected monster. {x} minutes before the access to the Underworld end Bot will attack Dis Pater to get the costume.".gts_translate(),"selected-location");e.appendChild(this.createRow("Farming purpose".gts_translate(),[w,N]));var L=this.createElement("select");e.appendChild(this.createRow("Location".gts_translate(),[L],null,null,"selected-location"));for(var G=R(V.selectedLocationId,"0"),U=0;U<underworldLocations.length;U++){var H=underworldLocations[U],K=this.createElement("option",null,null,H.name);K.value=H.id,K.selected=this.isEqual(H.id,G),L.appendChild(K)}var Q=this.createElement("select");e.appendChild(this.createRow("Opponent".gts_translate(),[Q],null,null,"selected-opponent"));let X=[];for(U=10;U<=120;U+=10)X.push({name:"{numOfMinutes} minutes".gts_translate({numOfMinutes:U}),value:U});let J=gts_controlBuilder.createDropdown(V.attackDisPaterBeforeMinutes,30,X,"name","value");e.appendChild(this.createRow("Attack Dis Pater {x} minutes before access to Underworld end".gts_translate(),[J],null,null,"selected-opponent")),y(Q).on("change",function(){var e=t.getSelectedValue(this);null!=e&&D(V.selectedOpponentId,e)}),y(L).on("change",function(){var e=t.getSelectedValue(this);null!=e&&(D(V.selectedLocationId,e),O.storage.clearOption(V.selectedOpponentId),W(e))});var W=function(e){t.removeChildren(Q);for(var a=underworldLocations.filter(t=>t.id==e).pop(),r=R(V.selectedOpponentId,1),n=0;n<a.opponents.length;n++){var i=a.opponents[n],o=t.createElement("option",null,null,n+1+". "+i+(3==n?" [boss]":""));o.value=n+1,o.selected=t.isEqual(n+1,r),Q.appendChild(o)}};W(G);var Y=gts_controlBuilder.createToggle(V.attackDisPaterAsap,null,"true");e.appendChild(this.createRow("Attack Dis Pater asap".gts_translate(),[Y],null,null,"attack-dispater-asap"));var j=gts_controlBuilder.createToggle(V.allowUseRuby);e.appendChild(this.createRow("Allow use ruby".gts_translate(),[j]));var $=gts_controlBuilder.createToggle(V.allowUseMobilisation);e.appendChild(this.createRow("Allow use Mobilisation".gts_translate(),[$],null,null,h?"":"invalid-premium"));var z=gts_controlBuilder.createToggle(V.autoEnterUnderworld);z.disabled=!h;var Z=gts_controlBuilder.createDropdown(V.underworldLevel,"Normal",underworldLevels);Z.disabled=!h;var ee=h?null:y("<span>").addClass("red-text").html("&nbsp;"+"Available only for Premium License".gts_translate())[0],te=R(V.currentCostume,"false,false,false").split(","),ae=gts_controlBuilder._createElement("label");ae.textContent=" "+"Current costume".gts_translate()+": "+"Normal".gts_translate()+"("+("true"==te[0]?"âœ”":"âœ˜")+"), "+"Medium".gts_translate()+"("+("true"==te[1]?"âœ”":"âœ˜")+"), "+"Hard".gts_translate()+"("+("true"==te[2]?"âœ”":"âœ˜")+")";var re=gts_controlBuilder.createIconInfor("Bot will enter underworld when the expedition points is less than a half of the max points.".gts_translate());h||(ae=null),e.appendChild(this.createRow("Auto enter underworld".gts_translate(),[z,Z,ee,ae,re],null,null,h?"":"invalid-premium"));var ne=gts_controlBuilder.createToggle(V.autoWearUWCostume,null,"false"),ie=gts_controlBuilder.createIconInfor("If the selected underworld level is Normal or Medium, then bot will wear the costume once the expedition/dungeon points is 0. Otherwise, bot will wear the costume asap.".gts_translate());e.appendChild(this.createRow("Auto wear underworld costume".gts_translate(),[ne,ie],null,null,h?"":"invalid-premium"));var oe=gts_controlBuilder.createToggle(V.pauseArena,null,"true");e.appendChild(this.createRow("Pause arena while in underworld".gts_translate(),[oe],null,null,h?"":"invalid-premium"));var le=gts_controlBuilder.createLabel(dolls[0].name+":","character-label-for-costume"),se=gts_controlBuilder.createDropdown(V.arenaCostume,-1,costumeData,null,null,e=>{D(V.isArenaWearingSelectedCostume,!1);var t=M(V.circusCostume);e>0&&e==t&&(D(V.circusCostume,-1),y(ce).val(-1))}),ue=gts_controlBuilder._createElement("br"),de=gts_controlBuilder.createLabel(dolls[1].name+":","character-label-for-costume"),ce=gts_controlBuilder.createDropdown(V.circusCostume,-1,costumeData,null,null,e=>{D(V.isCircusWearingSelectedCostume,!1);var t=M(V.arenaCostume);e>0&&e==t&&(D(V.arenaCostume,-1),y(se).val(-1))});e.appendChild(this.createRow("Change costume after underworld costume end".gts_translate(),[le,se,ue,de,ce],null,null,h?"":"invalid-premium"));var me=gts_controlBuilder.createDropdown(V.arenaCostumeForUnderworld,-1,costumeData,null,null,e=>{D(V.isArenaWearingSelectedCostume,!1);var t=M(V.circusCostumeForUnderworld);e>0&&e==t&&(D(V.circusCostumeForUnderworld,-1),y(ge).val(-1))}),ge=(ue=gts_controlBuilder._createElement("br"),gts_controlBuilder.createDropdown(V.circusCostumeForUnderworld,-1,costumeData,null,null,e=>{D(V.isCircusWearingSelectedCostume,!1);var t=M(V.arenaCostumeForUnderworld);e>0&&e==t&&(D(V.arenaCostumeForUnderworld,-1),y(me).val(-1))}));e.appendChild(this.createRow("Change costume while in underworld".gts_translate(),[le.cloneNode(!0),me,ue.cloneNode(!0),de.cloneNode(!0),ge],null,null,h?"":"invalid-premium"))},buildDungeonContent:function(e){this.removeChildren(e);let t=gts_controlBuilder.createLink("Check this video".gts_translate(),"https://www.youtube.com/watch?v=lMt06dY5j18","video-link margin-l-5");e.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode("Configuration for automating Dungeon".gts_translate()),t]));let a=gts_controlBuilder.createDropdown(W.countryLocation,ke,ge,"name","id",()=>{Qe.initSettings()});e.appendChild(this.createRow("Location".gts_translate(),[a]));var r=this.createInput(null,"checkbox");r.checked="true"===R(W.isSkipBoss,"false"),y(r).on("change",function(){D(W.isSkipBoss,this.checked)});var n=this.createElement("label",null,null,"(If you can not defeat boss, turn on this option to skip boss and restart dungeon)".gts_translate());e.appendChild(this.createRow("Skip boss".gts_translate(),[r,n]));var i=gts_controlBuilder.createNumberInput(W.restartAfterXTimesLost,10);e.appendChild(this.createRow("Restart after x times lost".gts_translate(),[i],null,null));let o=e=>{let t=e==relativeCountryValues.expedition;y(s).toggle(t),y(u).toggle(t)},l=gts_controlBuilder.createDropdown(W.travelCountryWhenZeroPoints,"",countries.filter(e=>e.value!=relativeCountryValues.dungeon),"name","value",o),s=gts_controlBuilder.createLabel("Requires Expedition points is restored".gts_translate(),"margin-r-5"),u=gts_controlBuilder.createDropdown(J.minExpeditionPointsToTravel,50,pointPercents.filter(e=>e.value>0),"name","value");e.appendChild(this.createRow("When the dungeon point is 0 then travel to".gts_translate(),[l,s,u])),o(R(W.travelCountryWhenZeroPoints));let d=gts_controlBuilder.createToggle(W.useClotheToTravel,"Use Working Clothe to reduce time when travel to Dungeon country".gts_translate());e.appendChild(this.createRow("Reduce travel time".gts_translate(),[...d]));let c=gts_controlBuilder.createToggle(W.useGateKey,"Use Gate Key to restore Dungeon points".gts_translate());e.appendChild(this.createRow("Dungeon points".gts_translate(),[...c]))},initDefaultValue:function(){R(W.bossText,q.getBossText(Qe.lang))},isEqual:function(e,t){return e.toString()==t.toString()},migrateOldSettings:function(){var e=R(Y.bagOfFood,512).split(",");e.length>1&&D(Y.bagOfFood,e[0])},createMenuItem:function(e,t,a,r){var n=b.createElement("li");if(e){var i=this.createInput(e,"checkbox"),o=e==settingKeys.quest.enabled;i.checked="true"==R(e,!0),o&&M(settingKeys.quest.enableAutoTime,"0")>0&&(i.checked=!0),y(i).on("change",function(){D(e,this.checked),o&&D(settingKeys.quest.enableAutoTime,-1),e==Y.enabled&&D(Y.disableHealUntil,0)}),n.appendChild(i)}var l=this.createElement("label",null,null,t);return n.appendChild(l),n.onclick=function(){if(-1==this.className.indexOf("active")){var e=this.parentElement.querySelector(".active");e&&e.classList.remove("active"),this.className+=" active",a()}r.className=r.className.replace("close","open")},n},buildPlayerItem:function(e,t){var a=this.createElement("li");a.tabIndex=-1,a.innerHTML=e;var r=this.createElement("i",null,"remove");return r.onclick=t,y(a).on("keydown",e=>{switch(e.keyCode){case 8:case 46:t();break;case 37:y(a).prev().focus();break;case 39:y(a).next().focus()}}),a.appendChild(r),a},createElement:function(e,t,a,r,n){var i=b.createElement(e);return a&&(i.className=a),r&&(i.textContent=r),n&&(i.innerHTML=n),t&&(i.id=t),i},createInput:function(e,t,a){var r=this.createElement("input",e);return r.type=t,a&&(r.className=a),r},p150:function(){if(H&&clearTimeout(H),!("true"==R(K.autoStartStopEnabled,"false")))return;let e=F(K.autoStartStopSettings);if(0==e.length)return;let t=(e=>{let t=[];for(let a of e){if(a.start.indexOf(":")<0||a.stop.indexOf(":")<0)continue;let e=a.start.split(":"),r=a.stop.split(":"),n=v(e[0]),i=v(e[1]);t.push({action:"start",time:36e5*n+6e4*i});let o=v(r[0]),l=v(r[1]);t.push({action:"stop",time:36e5*o+6e4*l})}return t.sort((e,t)=>e.time-t.time),t})(e),a=E.getServerDateArray(),r=36e5*a[3]+6e4*a[4]+1e3*a[5],n=!1;var i=(e,t)=>{let n=new Date(a[0],a[1]-1,a[2]);e.time<r&&n.setDate(n.getDate()+1);var i=new Date(n.getTime()+e.time);let o="start"==e.action,l=i.toLocaleString(navigator.language,{dateStyle:"medium",timeStyle:"short"}),s=o?"Bot will start at {date} (server time)".gts_translate({date:l}):"Bot will stop at {date} (server time)".gts_translate({date:l});q.writeLog(s),setTimeout(()=>{q.setStatusMessage(s,!0)},5e3),H=setTimeout(async()=>{let e=le(K.donateGuildBankBeforeStop);!o&&e&&await P.donateGuildBank(),Qe.startStop(o)&&q.reload()},t)};let o=q.isRunning();for(let e of t){let t=e.time,a="start"==e.action;if(t<r&&t+1e4>r){let e=Qe.startStop(a);if(e&&q.reload(),n=!0,!e)continue;break}if(t>r&&o!=a){n=!0,i(e,e.time-r);break}}if(!n){let e=t[o==("start"==t[0].action)?1:0];i(e,e.time+864e5-r)}},buildGeneralSettings:function(i){var f=this;this.removeChildren(i);var k=gts_controlBuilder.createLink("Release Notes".gts_translate()+" v"+gtsVersion,"https://docs.google.com/document/d/1V3vmpKcIKuJS_udgJOQvDIve92ML8jh_oytETtmoxfU/edit?usp=sharing");i.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode("General settings".gts_translate()),b.createTextNode(" ("),k,b.createTextNode(")")]));var E=v((playerId+"").substr(0,6)),P=R(s(p(C(e("7fkPOYRC3UdXjgHXldNxdIPOu"),8))),"").trim(),B=this.createElement("input");B.className="key-input";var F=this.createElement("span","lblSyncLicenseMessage","color-green"),N=O.dom.createButton("Sync License".gts_translate(),function(){var e=y("#lblSyncLicenseMessage");e.text("Syncing License...".gts_translate());let t={mixMapData:q.f_gmml(),licenseKey:function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),i=I*E*(2<<S),o=new Date(n);return n!=d(t[2],r)-i||i+T*(3<<S)!=d(a,r)?null:o}(B.value)?B.value:"",version:gtsVersion},a=btoa(JSON.stringify(t));y.post(gts_domain+"/sync-licence",{playerCode:U,validationToken:a},t=>{if(e.text("Sync license successfull".gts_translate()),e.attr("class","color-green"),t){G(t);var a="dbsjk9q27yv".split("").reverse().join(""),r=R(a,"").split(","),n=r.indexOf(t);n>-1&&(r.splice(n,1),D(a,r))}else q.reload()}).fail(t=>{e.text("Sync license failed".gts_translate()),e.attr("class","color-red")})});i.appendChild(this.createRow("License key".gts_translate(),[B,N,F],null,null,"license-row")),B.value=P;var M=this.createElement("span");i.appendChild(this.createRow("",[M]));var L=function(e){var t=function(e){if(!e)return null;var t=c(e,"-");if(3!=t.length&&4!=t.length)return null;var a=m(t[0],2),r=v(m(t[0],0,2)),n=d(t[1],r),i=I*E*(2<<S);return n!=d(t[2],r)-i||i+T*(3<<S)!=d(a,r)?null:new Date(n)},a=function(){var e=R(h(w(r(o("u7fkPOYRC3UdXjgHXldNxdIPO"),9))),"").trim(),a=t(e),n=x();return a&&a>n&&[].indexOf(e)<0}(),n=t(e),i=n&&a?"valid":"expired";M.textContent=n&&a?"Valid until".gts_translate()+" "+n.toDateString()+" 23:59 ("+"Server time".gts_translate()+")":e?n<x()?"Key Expired".gts_translate():"Invalid key".gts_translate():"",M.className=i},G=e=>{D(_(t(u(g("Ou7fkPOYRC3UdXjgHXldNxdIP"),10))),e),D("T03UPXTGeMyAS1xzGx0sUBgy7",e);var r=A("OWeMff_33NAGe3C7AXxDmkcvtXeE4Ce7oTr7nwIcEZsNF9Uriep6h6o2oSt9nZTUvp_uBccaawMYkWEiRT1gD6dgZD8DewMn",11,6);D("x4v26xopzeI7XWgjnFI6"+a(l(g(r)))+gtsExtensionId.substr(0,10),1),f.workflow.checkToken(!0,function(){L(e),q.reload()}),L(e)};y(B).on("change",function(){var e=this.value.trim();G(e)}),L(P);var U=v(this.server).toString(30)+"z"+this.lang+playerId.toString(16),H=this.createElement("a");H.href=gts_domain+"/templates/request-trial.html?code="+U,H.target="_blank",H.textContent="Free 3 days trial".gts_translate();var K=this.createElement("span");K.textContent=" | ";var Q=gts_domain+"/templates/payment-form.html?code="+U;this.createElement("span").textContent=" | ";var X=this.createElement("a");X.href=Q+"&packageName=monthly-pro",X.target="_blank",X.textContent="{numberOfDay} days".gts_translate({numberOfDay:30});var J=this.createElement("span");J.textContent=" | ";var W=this.createElement("a");W.href=Q+"&packageName=yearly-pro",W.target="_blank",W.textContent="1 year".gts_translate(),!n.isBeta&&i.appendChild(this.createRow("Upgrade Premium".gts_translate(),[H,K,X,J,W]));var V=this.createElement("span");let Y=`<b style="color:red;text-transform: uppercase;">${U}</b>`;V.innerHTML="Your profile code is {profileCode}".gts_translate({profileCode:Y}),i.appendChild(this.createRow("",[V]));var j=this.createElement("a");j.textContent="gladiatustimesaver@gmail.com",j.href="mailto:"+j.textContent,i.appendChild(this.createRow("Contact".gts_translate(),[j]));for(var $=this.createElement("select"),Z=supportedLanguages.find(e=>e.value==Qe.lang),ee=R(z.language,null!=Z?Z.value:"en"),te=0;te<supportedLanguages.length;te++){var ae=supportedLanguages[te];(oe=f.createElement("option",null,null,ae.text)).value=ae.value,oe.selected=f.isEqual(ae.value,ee),$.appendChild(oe)}y($).on("change",function(){var e=f.getSelectedValue(this);null!=e&&D(z.language,e)}),i.appendChild(this.createRow("Language".gts_translate(),[$]));var re=this.createElement("select");i.appendChild(this.createRow("Random delay".gts_translate(),[b.createTextNode("Auto will be delayed a random second from 0 to".gts_translate()),re]));var ne=R(z.delayInSeconds,15),ie=[0,1,2,3,4,5,10,15,20,25,30,40,50,60,90,120];for(te=0;te<ie.length;te++){var oe,le=ie[te];(oe=f.createElement("option",null,null,1==le?"1 second".gts_translate():"{second} seconds".gts_translate({second:le}))).value=le,oe.selected=f.isEqual(le,ne),re.appendChild(oe)}y(re).on("change",function(){var e=f.getSelectedValue(this);null!=e&&D(z.delayInSeconds,e)});var se=gts_controlBuilder.createToggle(z.allowRelogin,"");i.appendChild(this.createRow("Allow relogin".gts_translate(),[se]));var ue=gts_controlBuilder.createToggle(z.individualTabRunning,"");i.appendChild(this.createRow("Individual tab running".gts_translate(),[ue]));var de=gts_controlBuilder.createDropdown(z.menuPosition,"bottom",menuPositions,"name","value",()=>{n.location.reload(!1)});i.appendChild(this.createRow("Menu position".gts_translate(),[de]));var ce=gts_controlBuilder.createToggle(z.animateItemColor,null,!0);i.appendChild(this.createRow("Animate item color".gts_translate(),[ce]));var me=gts_controlBuilder.createToggle(z.debugMode,null,!1);i.appendChild(this.createRow("Debug mode".gts_translate(),[me],null,null,null,"This option is used only for debugging purpose, please don't turn it on.".gts_translate()));var ge=O.dom.createButton("Reset default settings".gts_translate(),()=>{for(var e in ge.disabled=!0,settingKeys)for(var t in settingKeys[e])ignoreResetingProperties.hasOwnProperty(e+"."+t)||O.storage.clearOption(settingKeys[e][t]);this.getCurrentCountry(()=>{setTimeout(()=>{n.location.reload(!0)},1e3)})}),pe=gts_controlBuilder.createButton("Export Settings".gts_translate(),function(){var e={};for(var t in settingKeys)for(var a in e[t]||(e[t]={}),settingKeys[t])!ignoreExportProperties.hasOwnProperty(t+"."+a)&&(e[t][a]=R(settingKeys[t][a]));fe.textContent=JSON.stringify(e),ve.textContent="Export successful.".gts_translate(),ve.className="color-green"}),he=gts_controlBuilder.createButton("Import Settings".gts_translate(),function(){try{var e=JSON.parse(fe.value);for(var t in e)for(var a in e[t])D(settingKeys[t][a],e[t][a]);ve.textContent="Import successful.".gts_translate(),ve.className="color-green"}catch{ve.textContent="Invalid settings data.".gts_translate(),ve.className="color-red"}}),fe=gts_controlBuilder.createTextArea("setting-data-input"),ve=gts_controlBuilder.createLabel("");i.appendChild(this.createRow("",[pe,he,ge,ve,fe]))},createAuctionItemsSection:function(){var e=gts_controlBuilder._createElement("div","auctionItemsSection","gts-items-section"),t=gts_controlBuilder._createElement("div",null,"gts-items-section-content gts-content-scroll"),a=gts_controlBuilder._createElement("i",null,"gts-icon-auction-house"),r=F(z.auctionSectionPosition,{top:100,left:20},!0);y(e).css(r);var n=gts_controlBuilder._createElement("div",null,"gts-items-section-header"),i=[{text:"This section shows all matched filter items in Auction House".gts_translate(),color:"#00ff00"}];q.showTooltip(n,i);var o=gts_controlBuilder.createLabel();y(n).on("mousedown",t=>{var a=y(e);ie={currentClientX:v(a.css("left").replace("px","")),currentClientY:v(a.css("top").replace("px","")),clientX:t.clientX,clientY:t.clientY}}).on("mouseup",()=>{var t=y(e),a={top:v(t.css("top").replace("px","")),left:v(t.css("left").replace("px",""))};D(z.auctionSectionPosition,JSON.stringify(a)),ie=null}),y(b).on("mousemove",t=>{if(ie){var a=t.clientX-ie.clientX,r=t.clientY-ie.clientY;y(e).css({left:ie.currentClientX+a,top:ie.currentClientY+r})}}),n.append(a),n.append(o),e.append(n),e.append(t),this.buildAuctionMatchedItems(n,t,o),b.body.append(e)},removeChildren:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},getCurrentCountry:function(e){var t=b.getElementById("submenu2"),a=Array.from(t.querySelectorAll("a")).filter(e=>e.getAttribute("href").match(/mod=location\&loc=\d/)).map(e=>v(e.getAttribute("href").match(/\&loc=(\d)/)[1])),r=a.length,n=a.pop(),i=Array.from(t.querySelectorAll("span")).filter(e=>e.id.match(/location_inactive_\d/)).map(e=>v(e.id.match(/location_inactive_(\d)/)[1])),o=i.length,l=i.pop(),s=r+o,u=s==autoSettingsData.italy.locations.length?"italy":s==autoSettingsData.africa.locations.length?"africa":s==autoSettingsData.germania.locations.length?9==n||9==l?"germania":"britannia":void 0;u&&(D(z.currentCountry,u),e(u))},gameModeResolve:function(){this.isLoggedIn=!0,Ie=!1,Se=!1,Ae=!1,xe=!1;let e=location.href.match(/https?:\/\/s(\d+)-(\w+)\.gladiatus\.gameforge\.com\/game\/(?:index|main).php\?(.*)/i);if(e)if(this.server=e[1],this.lang=e[2],b.getElementById("container_infobox")||b.getElementById("login"))this.isLoggedIn=!1;else if(null==b.getElementById("submenu1")?Ie=!0:"underworld"==b.getElementById("wrapper_game").className&&(Se=Qe.isInUnderworld=!0),b.getElementById("cancelVacationForm"))Ae=!0;else if(xe="-"==y("#cooldown_bar_text_expedition").text()||"-"==y("#cooldown_bar_text_dungeon").text()||"-"==y("#cooldown_bar_text_arena").text()||"-"==y("#cooldown_bar_text_ct").text(),!Ie){this.level=v(b.getElementById("header_values_level").textContent);var t=R(z.materialNames,"");this.level>4&&!t&&y.get(B.link({mod:"forge",submod:"storage"}),e=>{for(var t={},a=preventJQueryLoadResource(e).find("#resource-type")[0].querySelectorAll("option[value]"),r=0;r<a.length;r++){var n=a[r].getAttribute("value"),i=a[r].innerText.trim();t[n]=i}D(z.materialNames,JSON.stringify(t))})}},createShopItemsSection:function(){var e=gts_controlBuilder._createElement("div","shopItemsSection","gts-items-section"),t=gts_controlBuilder._createElement("div",null,"gts-items-section-content gts-content-scroll"),a=gts_controlBuilder._createElement("i",null,"gts-icon-shop"),r=F(z.shopSectionPosition,{top:230,left:20},!0);y(e).css(r);var n=gts_controlBuilder._createElement("div",null,"gts-items-section-header");q.showTooltip(n,[{text:"This section shows all high quality items in shop",color:"#00ff00"}]),y(n).on("mousedown",t=>{var a=y(e);oe={currentClientX:v(a.css("left").replace("px","")),currentClientY:v(a.css("top").replace("px","")),clientX:t.clientX,clientY:t.clientY}}).on("mouseup",()=>{var t=y(e),a={top:v(t.css("top").replace("px","")),left:v(t.css("left").replace("px",""))};D(z.shopSectionPosition,JSON.stringify(a)),oe=null}),y(b).on("mousemove",t=>{if(oe){var a=t.clientX-oe.clientX,r=t.clientY-oe.clientY;y(e).css({left:oe.currentClientX+a,top:oe.currentClientY+r})}});var i=gts_controlBuilder.createLabel("Shop items");n.append(a),n.append(i),e.append(n),e.append(t),this.buildHighQualityItemsInShop(t),b.body.append(e)},buildPlayerList:function(e,t,a){for(var r=this,n=0;n<t.length;n++){var i=t[n];i&&function(t){var n=r.buildPlayerItem(t,function(a){y(n).prev().focus(),n.remove();var r=F(e);r=r.filter(function(e){return e!=t&&e}),se(e,r),a.stopPropagation()});a.insertBefore(n,a.lastChild)}(i)}},buildQuestProContent:function(e,t){this.removeChildren(e);let a=gts_controlBuilder.createLink("Check this video".gts_translate(),"https://www.youtube.com/watch?v=uk6IoMVzmGs","video-link margin-l-5");e.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode("Configuration for picking quest automatically.".gts_translate()),a]));let r=gts_controlBuilder.createToggle(te.checkMissionBeforeAttack,"",!0);e.appendChild(this.createRow("Check mission before attack".gts_translate(),[r]));let n=[0,1,2,3,4,5].map(e=>({text:`${e}`,value:e})),i=gts_controlBuilder.createDropdown(te.minFillupQuestCount,3,n);e.appendChild(this.createRow("Number of quest need to be filled up before attack".gts_translate(),[i]));var o=t?this.createElement("div",null,"quest-rules"):this.createElement("span",null,"red-text","Buy premium license to make picking quests configurable.".gts_translate()),l=this.createRow("Picking quest rules".gts_translate(),[o],"quest-rules-label");e.appendChild(l);var s,u=F(settingKeys.quest.pickingRules),d=e=>unaryOperators.indexOf(e)>-1?"unary-operator":e==filterOperators.numberAttackLessThan?"number-operator":"",c=e=>{e=(e||[]).filter(e=>e),D(settingKeys.quest.pickingRules,JSON.stringify(e))},m=(e,t)=>{var a=["condition-item",d(e.operator)],r=this.createElement("div",null,a.join(" ")),n=q.buildDropDown(filterOperatorOptions,e.operator,t=>{e.operator=t.value,c(u);var a=y(r);a.removeClass("number-operator"),a.removeClass("unary-operator"),a.addClass(d(t.value))});r.append(n);var i=this.createInput(null,"textbox","condition-value");i.value=e.value,y(i).on("change",()=>{s&&clearTimeout(s),e.value=i.value,s=setTimeout(()=>{c(u)},300)}),r.append(i);var o=this.createElement("span",null,"icon-trash");return o.title="remove this condition",o.innerHTML="&#x1F5D1;",((e,a,r)=>{y(o).click(()=>{t.conditions.splice(t.conditions.indexOf(r),1),c(u),y(a).remove()})})(0,r,e),r.append(o),r},g=(e,t)=>{var a=this.createElement("div",null,"rule-item"),r=this.createElement("div",null,"rule-order");if(a.appendChild(r),t>0){var n=this.createElement("span",null,"btn-up","â‡‘");n.title="move this rule up",r.appendChild(n),y(n).on("click",()=>{u.splice(t-1,0,u.splice(t,1)[0]),c(u),o.innerHTML="";var e=0;for(var a of u)o.appendChild(g(a,e++))})}var i=this.createElement("span",null,null,t+1);r.appendChild(i);var l=this.createElement("div",null,"conditions"),s=this.createElement("div",null,"inner-conditions");l.appendChild(s);var d=q.buildDropDown(questOptions,e.type,t=>{e.type=t.value,c(u)});for(var p of(s.append(d),e.conditions))s.append(m(p,e));a.appendChild(l);var h=this.createElement("div",null,"rule-actions");a.appendChild(h);var f=this.createElement("span",null,null,null,"&#x1F5D1;");f.title="remove this rule",y(f).on("click",()=>{u.splice(u.indexOf(e),1),c(u),y(a).remove()});var v=this.createElement("span",null,"btn-add","+");return v.title="Add more condition".gts_translate(),y(v).on("click",()=>{var t={operator:filterOperators.contains,value:""};e.conditions.push(t),s.appendChild(m(t,e))}),h.appendChild(f),h.appendChild(v),a};if(t){var p=0;for(var h of u)h&&o.appendChild(g(h,p++));var f=O.dom.createButton("Add rule".gts_translate(),()=>{var e={type:questType.arena,conditions:[{operator:filterOperators.contains,value:""}]};u.push(e),c(u),o.appendChild(g(e,u.length-1))});y(l).find(".field-label").append(f)}},buildAuctionMatchedItems:function(e,t,a){this.removeChildren(t);var r=F(settingKeys.auction.matchedItems);for(var i of(r.sort((e,t)=>(e.isMercenary?1:e.itemGold)-(t.isMercenary?1:t.itemGold)),r)){var o=this.createElement("div",null,"auction_item_div"),l=this.createElement("div");l.style="position: relative";var s=[i.class.split(" ")[0]];void 0!==i.quality&&s.push("item-quality-"+qualityMap[i.quality+1]);var u=this.createElement("div",null,s.join(" "));if(void 0!==n.tooltips&&n.tooltips.set(l,i.tooltip),(e=>{o.onclick=(()=>{n.location.href=e})})(B.link({mod:"auction",qry:(i.itemName||"").split(" ")[0],itemType:i.itemType,itemId:i.itemId,ttype:i.ttype})),l.appendChild(u),o.appendChild(l),i.isOutbid){var d=gts_controlBuilder.createLink("","","outbid quest_slot_button_finish");q.showTooltip(d,[{text:"Outbid already",color:"#00ff00"}]),o.appendChild(d)}t.appendChild(o)}var c=r.filter(e=>e.isOutbid).length,m=r.length,g="Bidden {biddenCount} / {total} items".replace("{biddenCount}",c).replace("{total}",m);return setTimeout(()=>{a.innerText=g},500),t},createRow:function(e,t,a,r,n,i){var o=this.createElement("div",null,["row",n].join(" ")),l=this.createElement("div",null,"field-label");l.appendChild(this.createElement("label",null,a,e)),i&&l.appendChild(gts_controlBuilder.createIconInfor(i)),o.appendChild(l),o.appendChild(this.createElement("div",null,"border"));var s=this.createElement("div",null,"field-content");for(var u of t)u&&s.appendChild(u);for(var u of(o.appendChild(s),r=r||[]))u&&o.appendChild(u);var d=this.createElement("div",null,"row-wrapper");return d.appendChild(o),d},buildCircusTumaContent:function(e,t){this.removeChildren(e);let a=gts_controlBuilder.createLink("Check this video".gts_translate(),"https://www.youtube.com/watch?v=lMt06dY5j18","video-link margin-l-5");e.appendChild(this.createRow("Description".gts_translate(),[b.createTextNode("Configuration for automating Circus Provinciarum".gts_translate()),a]));var r=this.createElement("div");this.buildMultipleSelectionControl(Q.players,r);var n=this.createElement("span",null,"icon-copy","â");n.title="Copy to clipboard".gts_translate(),y(n).on("click",()=>{O.storage.copyOptionToClipboard(Q.players)}),e.appendChild(this.createRow("Attack players cross server".gts_translate(),[r],"label-for-list",[n]));let i=gts_controlBuilder.createToggle(Q.attackSameServerEnabled,"Enable attacking same server".gts_translate());var o=this.createElement("div");this.buildMultipleSelectionControl(Q.sameServerPlayers,o);var l=this.createElement("span",null,"icon-copy","â");l.title="Copy to clipboard".gts_translate(),y(l).on("click",()=>{O.storage.copyOptionToClipboard(Q.sameServerPlayers)}),e.appendChild(this.createRow("Same server attack list".gts_translate(),[...i,o],"label-for-list",[l]));var s=this.createInput(null,"textbox");s.className="input-gold";var u=v(b.getElementById("header_values_level").textContent);s.value=R(Q.goldRaided,500*u),y(s).on("change",function(){D(Q.goldRaided,this.value)});var d=this.createRow("Add player to attack list if raid over".gts_translate(),[s,ne()]);d.className+=" gold-raided",e.appendChild(d);var c=gts_controlBuilder.createToggle(Q.reattackIfDefenderPointsZero);e.appendChild(this.createRow("Add player to attack list if defender points is zero".gts_translate(),[c]));var m=this.createInput(null,"checkbox");m.checked="true"===R(Q.autoIgnorePlayer,"false"),y(m).on("change",function(){D(Q.autoIgnorePlayer,this.checked)}),e.appendChild(this.createRow("Auto ignore player if lose".gts_translate(),[m]));var g=this.createInput(null,"checkbox");g.checked="true"===R(Q.attackFiveTimesEnabled,"true"),y(g).on("change",function(){D(Q.attackFiveTimesEnabled,this.checked)}),e.appendChild(this.createRow("Limit 5 attacks per day".gts_translate(),[g])),t||(g.disabled=!0,D(Q.attackFiveTimesEnabled,!1),y(g).after(y("<span>").addClass("red-text").html("Available only for Premium License".gts_translate())));var p=this.createInput(null,"checkbox");p.checked="true"===R(Q.doNotRunIfNoQuest,"false"),y(p).on("change",function(){D(Q.doNotRunIfNoQuest,this.checked)}),e.appendChild(this.createRow("Pause if no suiable quest".gts_translate(),[p])),t||(p.disabled=!0,D(Q.doNotRunIfNoQuest,!1),y(p).after(y("<span>").addClass("red-text").html("Available only for Premium License".gts_translate())));var h=this.createInput(null,"checkbox");h.checked="true"===R(Q.runUntilGetChest,"false"),y(h).on("change",function(){D(Q.runUntilGetChest,this.checked)}),e.appendChild(this.createRow("Pause after get treasure box".gts_translate(),[h])),t||(h.disabled=!0,D(Q.runUntilGetChest,!1),y(h).after(y("<span>").addClass("red-text").html("Available only for Premium License".gts_translate())));var f=this.createElement("div");this.buildMultipleSelectionControl(Q.ignorePlayers,f);var k=this.createElement("span",null,"icon-copy","â");k.title="Copy to clipboard".gts_translate(),y(k).on("click",()=>{O.storage.copyOptionToClipboard(Q.ignorePlayers)}),e.appendChild(this.createRow("Ignore players".gts_translate(),[f],"label-for-list",[k]));var w=this.createElement("div");this.buildMultipleSelectionControl(Q.servers,w,this.validServerFilter),e.appendChild(this.createRow("Attack servers".gts_translate(),[w],"label-for-list"));var _=this.createElement("div");this.buildMultipleSelectionControl(Q.ignoreServers,_,this.validServerFilter),e.appendChild(this.createRow("Ignore servers".gts_translate(),[_],"label-for-list"))},init:function(){this.initDefaultValue(),this.migrateOldSettings();let e="true"==i.getItem("shouldUpdate","false"),t=R(z.menuPosition,"bottom"),a=["auto-settings",t,y(".mmortl").length>0?"rtl":""];e&&a.push("new-version");var r=this.createElement("div",null,a.join(" ")),o=this.createElement("div",null,"gts-overlay"),l=this.createElement("div",null,"content close");if(r.appendChild(this.buildMenu(l)),r.appendChild(l),b.body.append(r),!Ie){this.createAuctionItemsSection(),this.createShopItemsSection();let e=Fe(Qe,132);e&&e()}b.body.append(o),y(b.body).on("click",function(e){if(!(y(e.target).closest(".dropdown-list").length>0)){var t=y(l);t.toggleClass("close",!0),t.toggleClass("open",!1),r.querySelector("h4").className="collapsed"}}),y(r).on("click",function(e){e.stopPropagation()});var s=this.createElement("span",null,`gts-timer ${t}`);"bottom"==t?r.appendChild(s):b.body.append(s),ignoreId=playerId;var u=this;setTimeout(()=>{u.addMoreQuickActions()},1e3),le(z.animateItemColor,!0)&&y(b.body).addClass("gts-animate-item-color");var d=E.getPlayerLevel(),c=le(K.storeResourcesEveryHour),m=M(K.storeResourcesTime);d>4&&c&&(e=>(new Date).getTime()>e)(m)&&(ue(K.storeResourcesTime,3600),O.utility.sendAllResourcesToHorreum(!0));var g=y("#content").find('img[src*="'+eventResetPointImage+'"]');n.location.href.indexOf("submod=serverQuest&")>0&&g.length&&g.on("click",function(){D(j.lastExecutedDate,"")})}};Ne=Qe.workflow,Qe.wait(),n.gts_main=Qe}(e=>e.split(""),e=>e.reverse(),e=>e.join(""),(e,t)=>{for(let a=0;a<t;a++){let t=e.shift();e.push(t)}return e},this,localStorage,e=>e.split(""),e=>e.reverse(),e=>e.join(""),(e,t)=>{for(let a=0;a<t;a++){let t=e.shift();e.push(t)}return e},(e,t)=>{for(var a=0,r=e.length,n=0,i="";i=e.charAt(n),n<r;n++)a+=allChars.indexOf(i)*Math.pow(t,r-1-n);return a},(e,t)=>{for(var a=[],r=e.length,n="",i=0,o="";o=e.charAt(i),i<r;i++)o!=t?n+=o:(a.push(n),n="");return n&&a.push(n),a},(e,t,a)=>{for(var r="",n=a?a+t:e.length,i=t,o="";o=e.charAt(i),i<Math.min(n,e.length);i++)r+=o;return r},e=>e.split(""),e=>e.reverse(),e=>e.join(""),(e,t)=>{for(let a=0;a<t;a++){let t=e.shift();e.push(t)}return e},this.parseInt,jQuery,document,e=>e.split(""),e=>e.reverse(),e=>e.join(""),(e,t)=>{for(let a=0;a<t;a++){let t=e.shift();e.push(t)}return e},()=>{var e=document.getElementById("server-time").getAttribute("data-start-time"),t=JSON.parse(e);return t?new Date(t[0],t[1]-1,t[2]):new Date},this.sbaseNumber,this.pBaseNumber,this.stNumber,(e,t,a)=>{var r=[];for(let n=0;n<t;n++)r.push(e[(n+1)*a]);return r.join("")});